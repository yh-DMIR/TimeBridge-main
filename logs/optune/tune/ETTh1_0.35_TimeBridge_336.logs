
--- [Trial 0] 参数 ---
learning_rate=0.000632822428909034, batch_size=32, ca_layers=2, ia_layers=3, attn_dropout=0.25, n_heads=4, num_p=6, alpha=0.2380752356812466, d_ff_multiplier=1
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.9284229
	speed: 0.0591s/iter; left time: 1394.2477s
	iters: 200, epoch: 1 | loss: 1.8978679
	speed: 0.0496s/iter; left time: 1166.3445s
Epoch: 1 cost time: 12.826220512390137
Epoch: 1, Steps: 237 | Train Loss: 1.9899631 Vali Loss: 1.2947913 Test Loss: 0.4224772
Validation loss decreased (inf --> 1.294791).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8072696
	speed: 0.5164s/iter; left time: 12064.8222s
	iters: 200, epoch: 2 | loss: 1.8065604
	speed: 0.0488s/iter; left time: 1135.9439s
Epoch: 2 cost time: 11.864432096481323
Epoch: 2, Steps: 237 | Train Loss: 1.8122655 Vali Loss: 1.4488499 Test Loss: 0.4456243
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.7578423
	speed: 0.4539s/iter; left time: 10496.9766s
	iters: 200, epoch: 3 | loss: 1.7537925
	speed: 0.0509s/iter; left time: 1172.4331s
Epoch: 3 cost time: 12.153042316436768
Epoch: 3, Steps: 237 | Train Loss: 1.7310482 Vali Loss: 1.4281586 Test Loss: 0.4583853
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.6987138
	speed: 0.4899s/iter; left time: 11214.6132s
	iters: 200, epoch: 4 | loss: 1.6491147
	speed: 0.0765s/iter; left time: 1742.3591s
Epoch: 4 cost time: 18.758100748062134
Epoch: 4, Steps: 237 | Train Loss: 1.6912859 Vali Loss: 1.3749789 Test Loss: 0.4599808
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.6489278
	speed: 0.5016s/iter; left time: 11363.3913s
	iters: 200, epoch: 5 | loss: 1.7219790
	speed: 0.0490s/iter; left time: 1105.9434s
Epoch: 5 cost time: 12.219084978103638
Epoch: 5, Steps: 237 | Train Loss: 1.6731078 Vali Loss: 1.4054551 Test Loss: 0.4712645
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.6809781
	speed: 0.4735s/iter; left time: 10614.1188s
	iters: 200, epoch: 6 | loss: 1.6964056
	speed: 0.0496s/iter; left time: 1107.4960s
Epoch: 6 cost time: 12.22850227355957
Epoch: 6, Steps: 237 | Train Loss: 1.6641331 Vali Loss: 1.3998654 Test Loss: 0.4775573
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.6479892
	speed: 0.5087s/iter; left time: 11283.5329s
	iters: 200, epoch: 7 | loss: 1.7207271
	speed: 0.0480s/iter; left time: 1059.5024s
Epoch: 7 cost time: 14.19379997253418
Epoch: 7, Steps: 237 | Train Loss: 1.6593295 Vali Loss: 1.4032409 Test Loss: 0.4795958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.6865629
	speed: 0.4471s/iter; left time: 9809.8193s
	iters: 200, epoch: 8 | loss: 1.6690104
	speed: 0.0486s/iter; left time: 1062.3158s
Epoch: 8 cost time: 11.987943649291992
Epoch: 8, Steps: 237 | Train Loss: 1.6569352 Vali Loss: 1.3963938 Test Loss: 0.4848865
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.6655567
	speed: 0.4772s/iter; left time: 10358.4739s
	iters: 200, epoch: 9 | loss: 1.6342815
	speed: 0.0489s/iter; left time: 1055.8853s
Epoch: 9 cost time: 12.381466627120972
Epoch: 9, Steps: 237 | Train Loss: 1.6559132 Vali Loss: 1.3962058 Test Loss: 0.4864784
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.6615957
	speed: 0.5060s/iter; left time: 10861.7394s
	iters: 200, epoch: 10 | loss: 1.6907015
	speed: 0.0475s/iter; left time: 1014.0341s
Epoch: 10 cost time: 11.937119722366333
Epoch: 10, Steps: 237 | Train Loss: 1.6553181 Vali Loss: 1.3946840 Test Loss: 0.4875818
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.6435605
	speed: 0.4611s/iter; left time: 9789.6449s
	iters: 200, epoch: 11 | loss: 1.6181099
	speed: 0.0492s/iter; left time: 1038.8201s
Epoch: 11 cost time: 12.312181949615479
Epoch: 11, Steps: 237 | Train Loss: 1.6549747 Vali Loss: 1.3914161 Test Loss: 0.4846497
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4224812090396881, mae:0.4441622793674469
rmse:0.6499855518341064, mape:0.715676486492157, mspe:42060.33984375

--- [Trial 1] 参数 ---
learning_rate=0.00018983838211295698, batch_size=8, ca_layers=2, ia_layers=2, attn_dropout=0.25, n_heads=16, num_p=12, alpha=0.05331289309790141, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.9404920
	speed: 0.0380s/iter; left time: 3596.7879s
	iters: 200, epoch: 1 | loss: 0.8318279
	speed: 0.0363s/iter; left time: 3430.2773s
	iters: 300, epoch: 1 | loss: 0.8190199
	speed: 0.0366s/iter; left time: 3459.3038s
	iters: 400, epoch: 1 | loss: 0.7845765
	speed: 0.0380s/iter; left time: 3589.5325s
	iters: 500, epoch: 1 | loss: 0.7372919
	speed: 0.0392s/iter; left time: 3693.7178s
	iters: 600, epoch: 1 | loss: 0.7837633
	speed: 0.0412s/iter; left time: 3884.8015s
	iters: 700, epoch: 1 | loss: 0.7430217
	speed: 0.0386s/iter; left time: 3628.5080s
	iters: 800, epoch: 1 | loss: 0.8369380
	speed: 0.0374s/iter; left time: 3518.0186s
	iters: 900, epoch: 1 | loss: 0.7472395
	speed: 0.0338s/iter; left time: 3176.1737s
Epoch: 1 cost time: 35.81829333305359
Epoch: 1, Steps: 948 | Train Loss: 0.8015557 Vali Loss: 1.3282114 Test Loss: 0.4270941
Validation loss decreased (inf --> 1.328211).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8430017
	speed: 0.4222s/iter; left time: 39578.0557s
	iters: 200, epoch: 2 | loss: 0.6971659
	speed: 0.0369s/iter; left time: 3451.2822s
	iters: 300, epoch: 2 | loss: 0.8700007
	speed: 0.0377s/iter; left time: 3522.9426s
	iters: 400, epoch: 2 | loss: 0.7455788
	speed: 0.0352s/iter; left time: 3286.6782s
	iters: 500, epoch: 2 | loss: 0.7449087
	speed: 0.0350s/iter; left time: 3267.5983s
	iters: 600, epoch: 2 | loss: 0.7358505
	speed: 0.0379s/iter; left time: 3529.7391s
	iters: 700, epoch: 2 | loss: 0.7151173
	speed: 0.0407s/iter; left time: 3794.7164s
	iters: 800, epoch: 2 | loss: 0.7101216
	speed: 0.0418s/iter; left time: 3892.3461s
	iters: 900, epoch: 2 | loss: 0.6824898
	speed: 0.0428s/iter; left time: 3980.8545s
Epoch: 2 cost time: 36.91680979728699
Epoch: 2, Steps: 948 | Train Loss: 0.7291801 Vali Loss: 1.3634158 Test Loss: 0.4329101
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7698909
	speed: 0.4765s/iter; left time: 44217.9943s
	iters: 200, epoch: 3 | loss: 0.7205647
	speed: 0.0360s/iter; left time: 3339.0915s
	iters: 300, epoch: 3 | loss: 0.7072655
	speed: 0.0390s/iter; left time: 3607.7642s
	iters: 400, epoch: 3 | loss: 0.7140305
	speed: 0.0425s/iter; left time: 3927.8934s
	iters: 500, epoch: 3 | loss: 0.7504109
	speed: 0.0390s/iter; left time: 3606.0656s
	iters: 600, epoch: 3 | loss: 0.6761701
	speed: 0.0392s/iter; left time: 3615.0986s
	iters: 700, epoch: 3 | loss: 0.6961529
	speed: 0.0379s/iter; left time: 3496.9336s
	iters: 800, epoch: 3 | loss: 0.6460941
	speed: 0.0388s/iter; left time: 3573.6293s
	iters: 900, epoch: 3 | loss: 0.7331421
	speed: 0.0393s/iter; left time: 3618.7568s
Epoch: 3 cost time: 37.19895076751709
Epoch: 3, Steps: 948 | Train Loss: 0.6859995 Vali Loss: 1.3752161 Test Loss: 0.4390514
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6838014
	speed: 0.4587s/iter; left time: 42135.1499s
	iters: 200, epoch: 4 | loss: 0.6018285
	speed: 0.0351s/iter; left time: 3218.1667s
	iters: 300, epoch: 4 | loss: 0.6299797
	speed: 0.0389s/iter; left time: 3565.7563s
	iters: 400, epoch: 4 | loss: 0.6531875
	speed: 0.0432s/iter; left time: 3955.2794s
	iters: 500, epoch: 4 | loss: 0.6711696
	speed: 0.0411s/iter; left time: 3758.5296s
	iters: 600, epoch: 4 | loss: 0.6833217
	speed: 0.0407s/iter; left time: 3716.4133s
	iters: 700, epoch: 4 | loss: 0.6880024
	speed: 0.0425s/iter; left time: 3874.4872s
	iters: 800, epoch: 4 | loss: 0.6479304
	speed: 0.0426s/iter; left time: 3884.8056s
	iters: 900, epoch: 4 | loss: 0.6645200
	speed: 0.0421s/iter; left time: 3833.7481s
Epoch: 4 cost time: 39.535003423690796
Epoch: 4, Steps: 948 | Train Loss: 0.6681040 Vali Loss: 1.3336703 Test Loss: 0.4516444
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6640460
	speed: 0.4469s/iter; left time: 40631.0455s
	iters: 200, epoch: 5 | loss: 0.6901634
	speed: 0.0371s/iter; left time: 3372.5469s
	iters: 300, epoch: 5 | loss: 0.6480350
	speed: 0.0368s/iter; left time: 3342.1417s
	iters: 400, epoch: 5 | loss: 0.6908389
	speed: 0.0342s/iter; left time: 3094.4885s
	iters: 500, epoch: 5 | loss: 0.6600211
	speed: 0.0343s/iter; left time: 3105.6570s
	iters: 600, epoch: 5 | loss: 0.7188091
	speed: 0.0371s/iter; left time: 3350.8501s
	iters: 700, epoch: 5 | loss: 0.7041689
	speed: 0.0364s/iter; left time: 3285.7394s
	iters: 800, epoch: 5 | loss: 0.6175935
	speed: 0.0379s/iter; left time: 3423.0724s
	iters: 900, epoch: 5 | loss: 0.6931045
	speed: 0.0358s/iter; left time: 3222.9039s
Epoch: 5 cost time: 34.98567032814026
Epoch: 5, Steps: 948 | Train Loss: 0.6596130 Vali Loss: 1.3471220 Test Loss: 0.4532273
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7026993
	speed: 0.4403s/iter; left time: 39611.3091s
	iters: 200, epoch: 6 | loss: 0.6948383
	speed: 0.0439s/iter; left time: 3947.6046s
	iters: 300, epoch: 6 | loss: 0.6925653
	speed: 0.0455s/iter; left time: 4088.4486s
	iters: 400, epoch: 6 | loss: 0.6891289
	speed: 0.0432s/iter; left time: 3869.0913s
	iters: 500, epoch: 6 | loss: 0.6417491
	speed: 0.0438s/iter; left time: 3921.7839s
	iters: 600, epoch: 6 | loss: 0.6797662
	speed: 0.0457s/iter; left time: 4089.9579s
	iters: 700, epoch: 6 | loss: 0.6391178
	speed: 0.0527s/iter; left time: 4707.4345s
	iters: 800, epoch: 6 | loss: 0.7104373
	speed: 0.0405s/iter; left time: 3616.9434s
	iters: 900, epoch: 6 | loss: 0.6571487
	speed: 0.0350s/iter; left time: 3121.3665s
Epoch: 6 cost time: 41.49649667739868
Epoch: 6, Steps: 948 | Train Loss: 0.6550728 Vali Loss: 1.3437095 Test Loss: 0.4557386
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6295533
	speed: 0.4232s/iter; left time: 37667.7224s
	iters: 200, epoch: 7 | loss: 0.6765368
	speed: 0.0384s/iter; left time: 3411.0997s
	iters: 300, epoch: 7 | loss: 0.6599218
	speed: 0.0378s/iter; left time: 3357.9413s
	iters: 400, epoch: 7 | loss: 0.5898943
	speed: 0.0345s/iter; left time: 3056.9858s
	iters: 500, epoch: 7 | loss: 0.6981933
	speed: 0.0355s/iter; left time: 3143.0346s
	iters: 600, epoch: 7 | loss: 0.6031291
	speed: 0.0340s/iter; left time: 3009.3760s
	iters: 700, epoch: 7 | loss: 0.6440523
	speed: 0.0357s/iter; left time: 3152.2173s
	iters: 800, epoch: 7 | loss: 0.6538639
	speed: 0.0349s/iter; left time: 3085.0628s
	iters: 900, epoch: 7 | loss: 0.6576200
	speed: 0.0358s/iter; left time: 3158.1387s
Epoch: 7 cost time: 34.53372406959534
Epoch: 7, Steps: 948 | Train Loss: 0.6529972 Vali Loss: 1.3490131 Test Loss: 0.4580007
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6740388
	speed: 0.4641s/iter; left time: 40867.9840s
	iters: 200, epoch: 8 | loss: 0.5828279
	speed: 0.0414s/iter; left time: 3639.1641s
	iters: 300, epoch: 8 | loss: 0.6488689
	speed: 0.0480s/iter; left time: 4216.6753s
	iters: 400, epoch: 8 | loss: 0.6308991
	speed: 0.0446s/iter; left time: 3915.6528s
	iters: 500, epoch: 8 | loss: 0.6937636
	speed: 0.0368s/iter; left time: 3227.6593s
	iters: 600, epoch: 8 | loss: 0.7001481
	speed: 0.0364s/iter; left time: 3188.3935s
	iters: 700, epoch: 8 | loss: 0.6575007
	speed: 0.0370s/iter; left time: 3232.3672s
	iters: 800, epoch: 8 | loss: 0.7300934
	speed: 0.0351s/iter; left time: 3062.2802s
	iters: 900, epoch: 8 | loss: 0.6497685
	speed: 0.0361s/iter; left time: 3150.1580s
Epoch: 8 cost time: 38.290077447891235
Epoch: 8, Steps: 948 | Train Loss: 0.6517156 Vali Loss: 1.3463986 Test Loss: 0.4591366
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7241801
	speed: 0.4312s/iter; left time: 37562.5743s
	iters: 200, epoch: 9 | loss: 0.6456234
	speed: 0.0355s/iter; left time: 3091.2588s
	iters: 300, epoch: 9 | loss: 0.6800207
	speed: 0.0359s/iter; left time: 3116.5964s
	iters: 400, epoch: 9 | loss: 0.6560608
	speed: 0.0373s/iter; left time: 3238.9673s
	iters: 500, epoch: 9 | loss: 0.5933616
	speed: 0.0370s/iter; left time: 3206.8465s
	iters: 600, epoch: 9 | loss: 0.6519848
	speed: 0.0351s/iter; left time: 3043.5739s
	iters: 700, epoch: 9 | loss: 0.6569744
	speed: 0.0364s/iter; left time: 3152.6044s
	iters: 800, epoch: 9 | loss: 0.7140153
	speed: 0.0353s/iter; left time: 3049.8078s
	iters: 900, epoch: 9 | loss: 0.5759555
	speed: 0.0358s/iter; left time: 3092.1845s
Epoch: 9 cost time: 34.70563578605652
Epoch: 9, Steps: 948 | Train Loss: 0.6512826 Vali Loss: 1.3445325 Test Loss: 0.4583602
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6670734
	speed: 0.5049s/iter; left time: 43510.2186s
	iters: 200, epoch: 10 | loss: 0.6508085
	speed: 0.0381s/iter; left time: 3282.5704s
	iters: 300, epoch: 10 | loss: 0.6393347
	speed: 0.0375s/iter; left time: 3219.6986s
	iters: 400, epoch: 10 | loss: 0.6345387
	speed: 0.0367s/iter; left time: 3150.0393s
	iters: 500, epoch: 10 | loss: 0.6489740
	speed: 0.0409s/iter; left time: 3511.0455s
	iters: 600, epoch: 10 | loss: 0.6998928
	speed: 0.0404s/iter; left time: 3458.2845s
	iters: 700, epoch: 10 | loss: 0.6587766
	speed: 0.0390s/iter; left time: 3335.9992s
	iters: 800, epoch: 10 | loss: 0.6697662
	speed: 0.0393s/iter; left time: 3361.8327s
	iters: 900, epoch: 10 | loss: 0.6496568
	speed: 0.0398s/iter; left time: 3401.0733s
Epoch: 10 cost time: 37.262094020843506
Epoch: 10, Steps: 948 | Train Loss: 0.6510873 Vali Loss: 1.3465320 Test Loss: 0.4574980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6049253
	speed: 0.4199s/iter; left time: 35782.5511s
	iters: 200, epoch: 11 | loss: 0.5919369
	speed: 0.0358s/iter; left time: 3051.5047s
	iters: 300, epoch: 11 | loss: 0.6685234
	speed: 0.0357s/iter; left time: 3032.0189s
	iters: 400, epoch: 11 | loss: 0.6442275
	speed: 0.0382s/iter; left time: 3241.3932s
	iters: 500, epoch: 11 | loss: 0.6654334
	speed: 0.0342s/iter; left time: 2905.1182s
	iters: 600, epoch: 11 | loss: 0.6883619
	speed: 0.0366s/iter; left time: 3097.9723s
	iters: 700, epoch: 11 | loss: 0.6477021
	speed: 0.0352s/iter; left time: 2979.2174s
	iters: 800, epoch: 11 | loss: 0.6240227
	speed: 0.0351s/iter; left time: 2964.0190s
	iters: 900, epoch: 11 | loss: 0.6791478
	speed: 0.0360s/iter; left time: 3039.6040s
Epoch: 11 cost time: 34.51662874221802
Epoch: 11, Steps: 948 | Train Loss: 0.6508266 Vali Loss: 1.3452291 Test Loss: 0.4577550
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4270893335342407, mae:0.43808767199516296
rmse:0.6535207033157349, mape:0.7049688696861267, mspe:41275.16796875

--- [Trial 2] 参数 ---
learning_rate=0.0005005039429903583, batch_size=64, ca_layers=1, ia_layers=1, attn_dropout=0.05, n_heads=8, num_p=12, alpha=0.2506113379877363, d_ff_multiplier=4
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.9148079
	speed: 0.0690s/iter; left time: 806.8492s
Epoch: 1 cost time: 8.33716106414795
Epoch: 1, Steps: 118 | Train Loss: 2.0904587 Vali Loss: 1.2472556 Test Loss: 0.4212814
Validation loss decreased (inf --> 1.247256).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8866966
	speed: 0.3374s/iter; left time: 3907.9739s
Epoch: 2 cost time: 8.246785640716553
Epoch: 2, Steps: 118 | Train Loss: 1.8994488 Vali Loss: 1.2813172 Test Loss: 0.4195830
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8054494
	speed: 0.3709s/iter; left time: 4252.1483s
Epoch: 3 cost time: 12.9128577709198
Epoch: 3, Steps: 118 | Train Loss: 1.8559677 Vali Loss: 1.3586417 Test Loss: 0.4282959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.7458253
	speed: 0.3756s/iter; left time: 4261.5669s
Epoch: 4 cost time: 8.306120872497559
Epoch: 4, Steps: 118 | Train Loss: 1.8326837 Vali Loss: 1.3305581 Test Loss: 0.4328932
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.7631962
	speed: 0.3360s/iter; left time: 3773.2428s
Epoch: 5 cost time: 8.282341957092285
Epoch: 5, Steps: 118 | Train Loss: 1.8171175 Vali Loss: 1.3566393 Test Loss: 0.4348895
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.8554375
	speed: 0.3377s/iter; left time: 3752.1047s
Epoch: 6 cost time: 8.497777462005615
Epoch: 6, Steps: 118 | Train Loss: 1.8076068 Vali Loss: 1.3638188 Test Loss: 0.4403591
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.8353041
	speed: 0.3395s/iter; left time: 3732.3941s
Epoch: 7 cost time: 10.793959617614746
Epoch: 7, Steps: 118 | Train Loss: 1.8028268 Vali Loss: 1.3769859 Test Loss: 0.4417745
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.8379316
	speed: 0.3963s/iter; left time: 4309.7515s
Epoch: 8 cost time: 8.49247407913208
Epoch: 8, Steps: 118 | Train Loss: 1.8001697 Vali Loss: 1.3698390 Test Loss: 0.4418005
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.7710445
	speed: 0.3351s/iter; left time: 3604.2231s
Epoch: 9 cost time: 8.241216897964478
Epoch: 9, Steps: 118 | Train Loss: 1.7987037 Vali Loss: 1.3778957 Test Loss: 0.4413785
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.7492343
	speed: 0.3223s/iter; left time: 3429.4764s
Epoch: 10 cost time: 8.702587366104126
Epoch: 10, Steps: 118 | Train Loss: 1.7979364 Vali Loss: 1.3782321 Test Loss: 0.4427787
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.7652766
	speed: 0.3284s/iter; left time: 3454.9913s
Epoch: 11 cost time: 8.494203090667725
Epoch: 11, Steps: 118 | Train Loss: 1.7977225 Vali Loss: 1.3784591 Test Loss: 0.4426186
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4212852716445923, mae:0.43667128682136536
rmse:0.6490648984909058, mape:0.7052940130233765, mspe:34828.1484375

--- [Trial 3] 参数 ---
learning_rate=0.00040530347091620624, batch_size=8, ca_layers=0, ia_layers=2, attn_dropout=0.2, n_heads=32, num_p=8, alpha=0.08583128058740663, d_ff_multiplier=1
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.9746901
	speed: 0.0241s/iter; left time: 2277.8968s
	iters: 200, epoch: 1 | loss: 0.9842818
	speed: 0.0225s/iter; left time: 2130.9525s
	iters: 300, epoch: 1 | loss: 1.1113155
	speed: 0.0193s/iter; left time: 1828.1721s
	iters: 400, epoch: 1 | loss: 1.0056680
	speed: 0.0193s/iter; left time: 1818.2584s
	iters: 500, epoch: 1 | loss: 0.9610518
	speed: 0.0205s/iter; left time: 1935.7367s
	iters: 600, epoch: 1 | loss: 1.0261502
	speed: 0.0205s/iter; left time: 1927.1220s
	iters: 700, epoch: 1 | loss: 0.9591053
	speed: 0.0218s/iter; left time: 2052.5526s
	iters: 800, epoch: 1 | loss: 0.8735681
	speed: 0.0206s/iter; left time: 1932.3374s
	iters: 900, epoch: 1 | loss: 0.9553238
	speed: 0.0205s/iter; left time: 1924.4956s
Epoch: 1 cost time: 20.112414121627808
Epoch: 1, Steps: 948 | Train Loss: 0.9886882 Vali Loss: 1.3187954 Test Loss: 0.4325216
Validation loss decreased (inf --> 1.318795).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9359764
	speed: 0.2849s/iter; left time: 26713.9615s
	iters: 200, epoch: 2 | loss: 0.9134233
	speed: 0.0192s/iter; left time: 1798.3315s
	iters: 300, epoch: 2 | loss: 0.9003448
	speed: 0.0208s/iter; left time: 1941.2980s
	iters: 400, epoch: 2 | loss: 0.8516574
	speed: 0.0199s/iter; left time: 1862.4515s
	iters: 500, epoch: 2 | loss: 0.9149581
	speed: 0.0206s/iter; left time: 1920.4541s
	iters: 600, epoch: 2 | loss: 0.9470134
	speed: 0.0196s/iter; left time: 1830.2663s
	iters: 700, epoch: 2 | loss: 0.9535798
	speed: 0.0197s/iter; left time: 1833.7049s
	iters: 800, epoch: 2 | loss: 0.9047184
	speed: 0.0195s/iter; left time: 1818.8868s
	iters: 900, epoch: 2 | loss: 0.8421602
	speed: 0.0216s/iter; left time: 2006.2562s
Epoch: 2 cost time: 19.61559510231018
Epoch: 2, Steps: 948 | Train Loss: 0.9128246 Vali Loss: 1.4264095 Test Loss: 0.4328033
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8499844
	speed: 0.2845s/iter; left time: 26405.2228s
	iters: 200, epoch: 3 | loss: 0.8864636
	speed: 0.0279s/iter; left time: 2583.3610s
	iters: 300, epoch: 3 | loss: 0.8639745
	speed: 0.0295s/iter; left time: 2730.1603s
	iters: 400, epoch: 3 | loss: 0.8722820
	speed: 0.0285s/iter; left time: 2635.7502s
	iters: 500, epoch: 3 | loss: 0.9040036
	speed: 0.0293s/iter; left time: 2703.7065s
	iters: 600, epoch: 3 | loss: 0.8879306
	speed: 0.0280s/iter; left time: 2583.4160s
	iters: 700, epoch: 3 | loss: 0.9033659
	speed: 0.0281s/iter; left time: 2593.5697s
	iters: 800, epoch: 3 | loss: 0.8578405
	speed: 0.0294s/iter; left time: 2704.6041s
	iters: 900, epoch: 3 | loss: 0.9327934
	speed: 0.0311s/iter; left time: 2857.7862s
Epoch: 3 cost time: 28.119603157043457
Epoch: 3, Steps: 948 | Train Loss: 0.8652550 Vali Loss: 1.4147174 Test Loss: 0.4638299
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8926643
	speed: 0.2857s/iter; left time: 26247.7668s
	iters: 200, epoch: 4 | loss: 0.8500179
	speed: 0.0211s/iter; left time: 1933.3251s
	iters: 300, epoch: 4 | loss: 0.7979103
	speed: 0.0204s/iter; left time: 1868.0108s
	iters: 400, epoch: 4 | loss: 0.8050677
	speed: 0.0224s/iter; left time: 2050.8253s
	iters: 500, epoch: 4 | loss: 0.8481327
	speed: 0.0210s/iter; left time: 1922.9822s
	iters: 600, epoch: 4 | loss: 0.8488257
	speed: 0.0202s/iter; left time: 1841.5082s
	iters: 700, epoch: 4 | loss: 0.8600702
	speed: 0.0201s/iter; left time: 1832.8097s
	iters: 800, epoch: 4 | loss: 0.8332607
	speed: 0.0198s/iter; left time: 1804.1753s
	iters: 900, epoch: 4 | loss: 0.8196871
	speed: 0.0218s/iter; left time: 1987.1830s
Epoch: 4 cost time: 20.210177421569824
Epoch: 4, Steps: 948 | Train Loss: 0.8406318 Vali Loss: 1.4376942 Test Loss: 0.5186568
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8024073
	speed: 0.2825s/iter; left time: 25681.5179s
	iters: 200, epoch: 5 | loss: 0.8565627
	speed: 0.0225s/iter; left time: 2038.8416s
	iters: 300, epoch: 5 | loss: 0.8302306
	speed: 0.0220s/iter; left time: 1997.9841s
	iters: 400, epoch: 5 | loss: 0.8362653
	speed: 0.0223s/iter; left time: 2018.5630s
	iters: 500, epoch: 5 | loss: 0.8332268
	speed: 0.0218s/iter; left time: 1968.5994s
	iters: 600, epoch: 5 | loss: 0.7782578
	speed: 0.0223s/iter; left time: 2020.4647s
	iters: 700, epoch: 5 | loss: 0.7761269
	speed: 0.0221s/iter; left time: 1992.6972s
	iters: 800, epoch: 5 | loss: 0.8068995
	speed: 0.0221s/iter; left time: 1993.6764s
	iters: 900, epoch: 5 | loss: 0.8002855
	speed: 0.0223s/iter; left time: 2006.2533s
Epoch: 5 cost time: 21.427834272384644
Epoch: 5, Steps: 948 | Train Loss: 0.8290792 Vali Loss: 1.4634633 Test Loss: 0.5178850
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.8249850
	speed: 0.2967s/iter; left time: 26689.1724s
	iters: 200, epoch: 6 | loss: 0.9311377
	speed: 0.0290s/iter; left time: 2604.3946s
	iters: 300, epoch: 6 | loss: 0.9180363
	speed: 0.0289s/iter; left time: 2592.9297s
	iters: 400, epoch: 6 | loss: 0.7571818
	speed: 0.0287s/iter; left time: 2577.1471s
	iters: 500, epoch: 6 | loss: 0.8304192
	speed: 0.0284s/iter; left time: 2543.9265s
	iters: 600, epoch: 6 | loss: 0.7759041
	speed: 0.0277s/iter; left time: 2476.7682s
	iters: 700, epoch: 6 | loss: 0.8672750
	speed: 0.0286s/iter; left time: 2553.9672s
	iters: 800, epoch: 6 | loss: 0.9802483
	speed: 0.0289s/iter; left time: 2578.6445s
	iters: 900, epoch: 6 | loss: 0.7619947
	speed: 0.0283s/iter; left time: 2525.2719s
Epoch: 6 cost time: 28.246015310287476
Epoch: 6, Steps: 948 | Train Loss: 0.8230613 Vali Loss: 1.4770520 Test Loss: 0.5370385
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.8587010
	speed: 0.2987s/iter; left time: 26588.0015s
	iters: 200, epoch: 7 | loss: 0.8307759
	speed: 0.0203s/iter; left time: 1807.6922s
	iters: 300, epoch: 7 | loss: 0.8097696
	speed: 0.0226s/iter; left time: 2011.5415s
	iters: 400, epoch: 7 | loss: 0.7482718
	speed: 0.0201s/iter; left time: 1781.8191s
	iters: 500, epoch: 7 | loss: 0.7817749
	speed: 0.0197s/iter; left time: 1749.1538s
	iters: 600, epoch: 7 | loss: 0.8683466
	speed: 0.0202s/iter; left time: 1784.1463s
	iters: 700, epoch: 7 | loss: 0.8053468
	speed: 0.0199s/iter; left time: 1763.4577s
	iters: 800, epoch: 7 | loss: 0.8116252
	speed: 0.0195s/iter; left time: 1725.4425s
	iters: 900, epoch: 7 | loss: 0.8298221
	speed: 0.0196s/iter; left time: 1733.2041s
Epoch: 7 cost time: 19.714425563812256
Epoch: 7, Steps: 948 | Train Loss: 0.8203286 Vali Loss: 1.4760953 Test Loss: 0.5421454
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7895995
	speed: 0.2714s/iter; left time: 23899.8772s
	iters: 200, epoch: 8 | loss: 0.8003558
	speed: 0.0224s/iter; left time: 1974.3590s
	iters: 300, epoch: 8 | loss: 0.7890792
	speed: 0.0201s/iter; left time: 1766.7342s
	iters: 400, epoch: 8 | loss: 0.8824183
	speed: 0.0199s/iter; left time: 1748.6357s
	iters: 500, epoch: 8 | loss: 0.8795965
	speed: 0.0205s/iter; left time: 1796.1909s
	iters: 600, epoch: 8 | loss: 0.7240802
	speed: 0.0205s/iter; left time: 1798.8614s
	iters: 700, epoch: 8 | loss: 0.7862412
	speed: 0.0214s/iter; left time: 1874.4314s
	iters: 800, epoch: 8 | loss: 0.7754267
	speed: 0.0209s/iter; left time: 1828.5488s
	iters: 900, epoch: 8 | loss: 0.8180459
	speed: 0.0202s/iter; left time: 1762.3246s
Epoch: 8 cost time: 20.69461703300476
Epoch: 8, Steps: 948 | Train Loss: 0.8188148 Vali Loss: 1.4676925 Test Loss: 0.5469347
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7989227
	speed: 0.2693s/iter; left time: 23463.0734s
	iters: 200, epoch: 9 | loss: 0.7764917
	speed: 0.0233s/iter; left time: 2024.4907s
	iters: 300, epoch: 9 | loss: 0.8414376
	speed: 0.0313s/iter; left time: 2717.2274s
	iters: 400, epoch: 9 | loss: 0.8551079
	speed: 0.0298s/iter; left time: 2587.6206s
	iters: 500, epoch: 9 | loss: 0.8118379
	speed: 0.0276s/iter; left time: 2389.3685s
	iters: 600, epoch: 9 | loss: 0.8077488
	speed: 0.0284s/iter; left time: 2458.3051s
	iters: 700, epoch: 9 | loss: 0.7315346
	speed: 0.0281s/iter; left time: 2429.5460s
	iters: 800, epoch: 9 | loss: 0.8101418
	speed: 0.0295s/iter; left time: 2549.1081s
	iters: 900, epoch: 9 | loss: 0.7955773
	speed: 0.0300s/iter; left time: 2588.3370s
Epoch: 9 cost time: 26.812784433364868
Epoch: 9, Steps: 948 | Train Loss: 0.8181500 Vali Loss: 1.4722942 Test Loss: 0.5468808
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7830657
	speed: 0.3205s/iter; left time: 27617.8693s
	iters: 200, epoch: 10 | loss: 0.7847258
	speed: 0.0236s/iter; left time: 2031.0746s
	iters: 300, epoch: 10 | loss: 0.7570652
	speed: 0.0237s/iter; left time: 2035.9866s
	iters: 400, epoch: 10 | loss: 0.8054585
	speed: 0.0219s/iter; left time: 1884.3669s
	iters: 500, epoch: 10 | loss: 0.8340020
	speed: 0.0216s/iter; left time: 1852.6448s
	iters: 600, epoch: 10 | loss: 0.7997400
	speed: 0.0223s/iter; left time: 1908.3778s
	iters: 700, epoch: 10 | loss: 0.8274982
	speed: 0.0220s/iter; left time: 1884.2332s
	iters: 800, epoch: 10 | loss: 0.8349442
	speed: 0.0224s/iter; left time: 1912.2123s
	iters: 900, epoch: 10 | loss: 0.8518441
	speed: 0.0218s/iter; left time: 1859.9496s
Epoch: 10 cost time: 21.88954472541809
Epoch: 10, Steps: 948 | Train Loss: 0.8175562 Vali Loss: 1.4724282 Test Loss: 0.5498620
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.8653892
	speed: 0.2865s/iter; left time: 24412.5718s
	iters: 200, epoch: 11 | loss: 0.7913251
	speed: 0.0216s/iter; left time: 1839.6812s
	iters: 300, epoch: 11 | loss: 0.8231568
	speed: 0.0248s/iter; left time: 2107.5535s
	iters: 400, epoch: 11 | loss: 0.8633246
	speed: 0.0233s/iter; left time: 1977.1500s
	iters: 500, epoch: 11 | loss: 0.8400989
	speed: 0.0248s/iter; left time: 2102.6801s
	iters: 600, epoch: 11 | loss: 0.8586434
	speed: 0.0199s/iter; left time: 1682.7451s
	iters: 700, epoch: 11 | loss: 0.9311674
	speed: 0.0199s/iter; left time: 1686.7899s
	iters: 800, epoch: 11 | loss: 0.7731208
	speed: 0.0195s/iter; left time: 1644.1651s
	iters: 900, epoch: 11 | loss: 0.8128019
	speed: 0.0206s/iter; left time: 1739.3539s
Epoch: 11 cost time: 21.274165153503418
Epoch: 11, Steps: 948 | Train Loss: 0.8174823 Vali Loss: 1.4719572 Test Loss: 0.5500458
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4325268864631653, mae:0.4452653229236603
rmse:0.6576677560806274, mape:0.7168941497802734, mspe:34783.15234375

--- [Trial 4] 参数 ---
learning_rate=0.00020194326435437612, batch_size=16, ca_layers=2, ia_layers=3, attn_dropout=0.0, n_heads=32, num_p=12, alpha=0.31443089673114144, d_ff_multiplier=1
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.4194849
	speed: 0.0731s/iter; left time: 3459.3748s
	iters: 200, epoch: 1 | loss: 2.2693992
	speed: 0.0603s/iter; left time: 2847.5543s
	iters: 300, epoch: 1 | loss: 2.3667378
	speed: 0.0607s/iter; left time: 2857.0310s
	iters: 400, epoch: 1 | loss: 2.2868798
	speed: 0.0619s/iter; left time: 2909.0688s
Epoch: 1 cost time: 30.370228052139282
Epoch: 1, Steps: 474 | Train Loss: 2.4446857 Vali Loss: 1.3304077 Test Loss: 0.4190207
Validation loss decreased (inf --> 1.330408).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3561730
	speed: 0.5159s/iter; left time: 24157.7877s
	iters: 200, epoch: 2 | loss: 2.2613416
	speed: 0.0658s/iter; left time: 3074.2230s
	iters: 300, epoch: 2 | loss: 2.2923810
	speed: 0.0600s/iter; left time: 2797.1025s
	iters: 400, epoch: 2 | loss: 2.3089399
	speed: 0.0604s/iter; left time: 2811.1681s
Epoch: 2 cost time: 29.804818630218506
Epoch: 2, Steps: 474 | Train Loss: 2.2614500 Vali Loss: 1.3894646 Test Loss: 0.4381412
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1434941
	speed: 0.5844s/iter; left time: 27090.0732s
	iters: 200, epoch: 3 | loss: 2.2096019
	speed: 0.0914s/iter; left time: 4226.8286s
	iters: 300, epoch: 3 | loss: 2.2547972
	speed: 0.0614s/iter; left time: 2833.3416s
	iters: 400, epoch: 3 | loss: 2.1265762
	speed: 0.0627s/iter; left time: 2889.5813s
Epoch: 3 cost time: 36.87577438354492
Epoch: 3, Steps: 474 | Train Loss: 2.1806921 Vali Loss: 1.3655999 Test Loss: 0.4325826
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.1068890
	speed: 0.5124s/iter; left time: 23506.9123s
	iters: 200, epoch: 4 | loss: 2.1571264
	speed: 0.0621s/iter; left time: 2844.6310s
	iters: 300, epoch: 4 | loss: 2.1768267
	speed: 0.0602s/iter; left time: 2750.5288s
	iters: 400, epoch: 4 | loss: 2.1918778
	speed: 0.0605s/iter; left time: 2757.6597s
Epoch: 4 cost time: 29.659018516540527
Epoch: 4, Steps: 474 | Train Loss: 2.1341911 Vali Loss: 1.4327755 Test Loss: 0.4640914
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.1116271
	speed: 0.5586s/iter; left time: 25363.7168s
	iters: 200, epoch: 5 | loss: 2.1822715
	speed: 0.0967s/iter; left time: 4380.3553s
	iters: 300, epoch: 5 | loss: 2.0860233
	speed: 0.0920s/iter; left time: 4159.1797s
	iters: 400, epoch: 5 | loss: 2.1197898
	speed: 0.0710s/iter; left time: 3201.0302s
Epoch: 5 cost time: 40.92287349700928
Epoch: 5, Steps: 474 | Train Loss: 2.1121817 Vali Loss: 1.4526699 Test Loss: 0.4602568
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.9969115
	speed: 0.5126s/iter; left time: 23032.0577s
	iters: 200, epoch: 6 | loss: 2.1563990
	speed: 0.0604s/iter; left time: 2709.1034s
	iters: 300, epoch: 6 | loss: 2.1805665
	speed: 0.0604s/iter; left time: 2703.8844s
	iters: 400, epoch: 6 | loss: 2.0967939
	speed: 0.0605s/iter; left time: 2700.8031s
Epoch: 6 cost time: 29.422951221466064
Epoch: 6, Steps: 474 | Train Loss: 2.1010069 Vali Loss: 1.4555218 Test Loss: 0.4730381
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.0723002
	speed: 0.5387s/iter; left time: 23951.0790s
	iters: 200, epoch: 7 | loss: 2.0719533
	speed: 0.0973s/iter; left time: 4315.3604s
	iters: 300, epoch: 7 | loss: 2.0858097
	speed: 0.0987s/iter; left time: 4366.5333s
	iters: 400, epoch: 7 | loss: 2.0444980
	speed: 0.0941s/iter; left time: 4155.4800s
Epoch: 7 cost time: 42.762293100357056
Epoch: 7, Steps: 474 | Train Loss: 2.0955826 Vali Loss: 1.4577472 Test Loss: 0.4780090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.9789612
	speed: 0.5249s/iter; left time: 23086.5913s
	iters: 200, epoch: 8 | loss: 2.0944703
	speed: 0.0604s/iter; left time: 2652.2960s
	iters: 300, epoch: 8 | loss: 2.0309508
	speed: 0.0605s/iter; left time: 2648.5337s
	iters: 400, epoch: 8 | loss: 2.1864886
	speed: 0.0616s/iter; left time: 2691.3506s
Epoch: 8 cost time: 29.399778127670288
Epoch: 8, Steps: 474 | Train Loss: 2.0927714 Vali Loss: 1.4542733 Test Loss: 0.4732763
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.1646852
	speed: 0.5108s/iter; left time: 22225.0411s
	iters: 200, epoch: 9 | loss: 2.0579965
	speed: 0.0644s/iter; left time: 2797.3987s
	iters: 300, epoch: 9 | loss: 2.1858215
	speed: 0.0983s/iter; left time: 4255.2732s
	iters: 400, epoch: 9 | loss: 2.1514153
	speed: 0.0996s/iter; left time: 4304.0363s
Epoch: 9 cost time: 40.34862184524536
Epoch: 9, Steps: 474 | Train Loss: 2.0913576 Vali Loss: 1.4624705 Test Loss: 0.4762736
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.9866357
	speed: 0.5904s/iter; left time: 25407.6757s
	iters: 200, epoch: 10 | loss: 2.1271300
	speed: 0.0614s/iter; left time: 2636.3312s
	iters: 300, epoch: 10 | loss: 2.0219522
	speed: 0.0610s/iter; left time: 2611.8360s
	iters: 400, epoch: 10 | loss: 2.1122594
	speed: 0.0625s/iter; left time: 2669.4373s
Epoch: 10 cost time: 29.735596656799316
Epoch: 10, Steps: 474 | Train Loss: 2.0905751 Vali Loss: 1.4582485 Test Loss: 0.4768853
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.0276628
	speed: 0.5190s/iter; left time: 22087.5887s
	iters: 200, epoch: 11 | loss: 2.1252522
	speed: 0.0643s/iter; left time: 2728.7233s
	iters: 300, epoch: 11 | loss: 2.0882323
	speed: 0.0817s/iter; left time: 3460.9225s
	iters: 400, epoch: 11 | loss: 2.0871408
	speed: 0.0988s/iter; left time: 4177.1935s
Epoch: 11 cost time: 38.40215015411377
Epoch: 11, Steps: 474 | Train Loss: 2.0901944 Vali Loss: 1.4569411 Test Loss: 0.4770951
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4190210998058319, mae:0.4399940073490143
rmse:0.6473183631896973, mape:0.7128880023956299, mspe:41022.27734375

--- [Trial 5] 参数 ---
learning_rate=0.00044252880412184276, batch_size=48, ca_layers=0, ia_layers=2, attn_dropout=0.0, n_heads=64, num_p=8, alpha=0.05226439608927742, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.7973588
	speed: 0.1123s/iter; left time: 1763.2920s
Epoch: 1 cost time: 17.868599891662598
Epoch: 1, Steps: 158 | Train Loss: 0.8350597 Vali Loss: 1.3511674 Test Loss: 0.4366418
Validation loss decreased (inf --> 1.351167).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7659374
	speed: 0.4796s/iter; left time: 7454.0864s
Epoch: 2 cost time: 27.055465698242188
Epoch: 2, Steps: 158 | Train Loss: 0.7572095 Vali Loss: 1.3878976 Test Loss: 0.4307371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7091296
	speed: 0.4881s/iter; left time: 7509.9684s
Epoch: 3 cost time: 17.85345196723938
Epoch: 3, Steps: 158 | Train Loss: 0.7291792 Vali Loss: 1.4282870 Test Loss: 0.4350049
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7305071
	speed: 0.4143s/iter; left time: 6308.8136s
Epoch: 4 cost time: 17.778923273086548
Epoch: 4, Steps: 158 | Train Loss: 0.7138623 Vali Loss: 1.4539828 Test Loss: 0.4420724
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6958250
	speed: 0.4221s/iter; left time: 6361.1402s
Epoch: 5 cost time: 17.983575582504272
Epoch: 5, Steps: 158 | Train Loss: 0.7057208 Vali Loss: 1.4926950 Test Loss: 0.4404798
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6840764
	speed: 0.5048s/iter; left time: 7526.5898s
Epoch: 6 cost time: 21.94780683517456
Epoch: 6, Steps: 158 | Train Loss: 0.7014243 Vali Loss: 1.5013254 Test Loss: 0.4400584
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7034063
	speed: 0.4119s/iter; left time: 6076.1745s
Epoch: 7 cost time: 17.95534896850586
Epoch: 7, Steps: 158 | Train Loss: 0.6995746 Vali Loss: 1.5208334 Test Loss: 0.4405553
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6864800
	speed: 0.4199s/iter; left time: 6128.5775s
Epoch: 8 cost time: 17.96154475212097
Epoch: 8, Steps: 158 | Train Loss: 0.6984321 Vali Loss: 1.5083382 Test Loss: 0.4434305
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6853234
	speed: 0.4263s/iter; left time: 6153.9500s
Epoch: 9 cost time: 17.852994680404663
Epoch: 9, Steps: 158 | Train Loss: 0.6979106 Vali Loss: 1.4977193 Test Loss: 0.4441038
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7134337
	speed: 0.5013s/iter; left time: 7158.3095s
Epoch: 10 cost time: 17.879365921020508
Epoch: 10, Steps: 158 | Train Loss: 0.6976272 Vali Loss: 1.5053051 Test Loss: 0.4431473
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.7193037
	speed: 0.4276s/iter; left time: 6038.7824s
Epoch: 11 cost time: 17.817286491394043
Epoch: 11, Steps: 158 | Train Loss: 0.6974628 Vali Loss: 1.5004897 Test Loss: 0.4447982
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4366353452205658, mae:0.44686058163642883
rmse:0.6607838869094849, mape:0.7155135273933411, mspe:37692.04296875

--- [Trial 6] 参数 ---
learning_rate=0.000839888898146072, batch_size=64, ca_layers=0, ia_layers=2, attn_dropout=0.0, n_heads=4, num_p=12, alpha=0.2329748548697536, d_ff_multiplier=1
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.8592699
	speed: 0.0546s/iter; left time: 638.3220s
Epoch: 1 cost time: 6.559364557266235
Epoch: 1, Steps: 118 | Train Loss: 1.9625862 Vali Loss: 1.3297070 Test Loss: 0.4285815
Validation loss decreased (inf --> 1.329707).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7710857
	speed: 0.3765s/iter; left time: 4360.5378s
Epoch: 2 cost time: 10.339793920516968
Epoch: 2, Steps: 118 | Train Loss: 1.7952675 Vali Loss: 1.3641566 Test Loss: 0.4120789
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6935140
	speed: 0.3080s/iter; left time: 3531.0782s
Epoch: 3 cost time: 6.701759338378906
Epoch: 3, Steps: 118 | Train Loss: 1.7426194 Vali Loss: 1.4083406 Test Loss: 0.4204870
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.7524571
	speed: 0.3007s/iter; left time: 3412.2006s
Epoch: 4 cost time: 6.541825294494629
Epoch: 4, Steps: 118 | Train Loss: 1.7125858 Vali Loss: 1.4166213 Test Loss: 0.4251686
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.6876097
	speed: 0.2846s/iter; left time: 3196.2649s
Epoch: 5 cost time: 6.750854730606079
Epoch: 5, Steps: 118 | Train Loss: 1.6967575 Vali Loss: 1.4111694 Test Loss: 0.4335507
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.7552934
	speed: 0.2888s/iter; left time: 3208.9423s
Epoch: 6 cost time: 6.586737871170044
Epoch: 6, Steps: 118 | Train Loss: 1.6883088 Vali Loss: 1.4392687 Test Loss: 0.4314360
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.6744821
	speed: 0.3729s/iter; left time: 4099.2009s
Epoch: 7 cost time: 6.554462194442749
Epoch: 7, Steps: 118 | Train Loss: 1.6841183 Vali Loss: 1.4154383 Test Loss: 0.4351835
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.7150499
	speed: 0.2837s/iter; left time: 3084.8246s
Epoch: 8 cost time: 6.912278175354004
Epoch: 8, Steps: 118 | Train Loss: 1.6823228 Vali Loss: 1.4086006 Test Loss: 0.4407414
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.7081530
	speed: 0.3039s/iter; left time: 3268.8333s
Epoch: 9 cost time: 6.5765321254730225
Epoch: 9, Steps: 118 | Train Loss: 1.6810741 Vali Loss: 1.4146992 Test Loss: 0.4394866
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.6850314
	speed: 0.2988s/iter; left time: 3179.0086s
Epoch: 10 cost time: 6.536401033401489
Epoch: 10, Steps: 118 | Train Loss: 1.6805012 Vali Loss: 1.4184886 Test Loss: 0.4390675
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.6700705
	speed: 0.3222s/iter; left time: 3390.3918s
Epoch: 11 cost time: 10.111462116241455
Epoch: 11, Steps: 118 | Train Loss: 1.6804079 Vali Loss: 1.4137981 Test Loss: 0.4391678
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4285820722579956, mae:0.4456995129585266
rmse:0.6546617746353149, mape:0.7193163633346558, mspe:36736.69140625

--- [Trial 7] 参数 ---
learning_rate=0.0003088580264087427, batch_size=32, ca_layers=2, ia_layers=1, attn_dropout=0.25, n_heads=4, num_p=6, alpha=0.1670742067552872, d_ff_multiplier=1
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.5292261
	speed: 0.0377s/iter; left time: 888.5796s
	iters: 200, epoch: 1 | loss: 1.4067111
	speed: 0.0352s/iter; left time: 826.1963s
Epoch: 1 cost time: 8.710317134857178
Epoch: 1, Steps: 237 | Train Loss: 1.5896362 Vali Loss: 1.3023200 Test Loss: 0.4327659
Validation loss decreased (inf --> 1.302320).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4098957
	speed: 0.3463s/iter; left time: 8090.4128s
	iters: 200, epoch: 2 | loss: 1.4094102
	speed: 0.0341s/iter; left time: 793.3013s
Epoch: 2 cost time: 8.983628511428833
Epoch: 2, Steps: 237 | Train Loss: 1.4256689 Vali Loss: 1.3432503 Test Loss: 0.4251073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3974215
	speed: 0.3803s/iter; left time: 8795.2088s
	iters: 200, epoch: 3 | loss: 1.3804147
	speed: 0.0439s/iter; left time: 1010.1444s
Epoch: 3 cost time: 10.986218214035034
Epoch: 3, Steps: 237 | Train Loss: 1.3880390 Vali Loss: 1.3466343 Test Loss: 0.4157304
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.2991669
	speed: 0.3923s/iter; left time: 8980.7777s
	iters: 200, epoch: 4 | loss: 1.3525646
	speed: 0.0315s/iter; left time: 718.6393s
Epoch: 4 cost time: 8.18592643737793
Epoch: 4, Steps: 237 | Train Loss: 1.3685863 Vali Loss: 1.3511465 Test Loss: 0.4198753
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.3554647
	speed: 0.3427s/iter; left time: 7763.6078s
	iters: 200, epoch: 5 | loss: 1.4228101
	speed: 0.0323s/iter; left time: 727.6942s
Epoch: 5 cost time: 8.19290542602539
Epoch: 5, Steps: 237 | Train Loss: 1.3587002 Vali Loss: 1.3770639 Test Loss: 0.4199312
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.3503705
	speed: 0.3436s/iter; left time: 7703.1385s
	iters: 200, epoch: 6 | loss: 1.3392558
	speed: 0.0323s/iter; left time: 721.4722s
Epoch: 6 cost time: 8.149795532226562
Epoch: 6, Steps: 237 | Train Loss: 1.3537949 Vali Loss: 1.3825198 Test Loss: 0.4203107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.3963990
	speed: 0.4172s/iter; left time: 9252.5241s
	iters: 200, epoch: 7 | loss: 1.3156530
	speed: 0.0312s/iter; left time: 688.2638s
Epoch: 7 cost time: 9.794263362884521
Epoch: 7, Steps: 237 | Train Loss: 1.3510723 Vali Loss: 1.3777436 Test Loss: 0.4215915
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.2807034
	speed: 0.3357s/iter; left time: 7365.1052s
	iters: 200, epoch: 8 | loss: 1.3471045
	speed: 0.0321s/iter; left time: 700.4266s
Epoch: 8 cost time: 8.080063581466675
Epoch: 8, Steps: 237 | Train Loss: 1.3499720 Vali Loss: 1.3749787 Test Loss: 0.4215282
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.3274586
	speed: 0.3452s/iter; left time: 7492.4495s
	iters: 200, epoch: 9 | loss: 1.3173804
	speed: 0.0380s/iter; left time: 821.4107s
Epoch: 9 cost time: 9.452316045761108
Epoch: 9, Steps: 237 | Train Loss: 1.3491450 Vali Loss: 1.3805300 Test Loss: 0.4219618
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.3593054
	speed: 0.3798s/iter; left time: 8154.6094s
	iters: 200, epoch: 10 | loss: 1.2792218
	speed: 0.0450s/iter; left time: 961.3545s
Epoch: 10 cost time: 11.225326776504517
Epoch: 10, Steps: 237 | Train Loss: 1.3485905 Vali Loss: 1.3783551 Test Loss: 0.4222787
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.3670251
	speed: 0.3936s/iter; left time: 8356.9221s
	iters: 200, epoch: 11 | loss: 1.3520135
	speed: 0.0312s/iter; left time: 659.6762s
Epoch: 11 cost time: 7.904193639755249
Epoch: 11, Steps: 237 | Train Loss: 1.3484807 Vali Loss: 1.3794245 Test Loss: 0.4222140
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4327608644962311, mae:0.4468076825141907
rmse:0.6578456163406372, mape:0.7162054777145386, mspe:36146.84375

--- [Trial 8] 参数 ---
learning_rate=0.00014528975514460564, batch_size=48, ca_layers=0, ia_layers=3, attn_dropout=0.05, n_heads=64, num_p=12, alpha=0.14651614211427183, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.3829747
	speed: 0.1752s/iter; left time: 2751.4866s
Epoch: 1 cost time: 27.647953271865845
Epoch: 1, Steps: 158 | Train Loss: 1.5172913 Vali Loss: 1.2699143 Test Loss: 0.4268168
Validation loss decreased (inf --> 1.269914).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3589513
	speed: 0.6400s/iter; left time: 9946.9293s
Epoch: 2 cost time: 27.62552523612976
Epoch: 2, Steps: 158 | Train Loss: 1.3249701 Vali Loss: 1.2772406 Test Loss: 0.4153328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2451141
	speed: 0.5676s/iter; left time: 8732.7230s
Epoch: 3 cost time: 27.775239944458008
Epoch: 3, Steps: 158 | Train Loss: 1.3018643 Vali Loss: 1.2670232 Test Loss: 0.4133476
Validation loss decreased (1.269914 --> 1.267023).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2986248
	speed: 0.5611s/iter; left time: 8543.3833s
Epoch: 4 cost time: 27.925997972488403
Epoch: 4, Steps: 158 | Train Loss: 1.2924136 Vali Loss: 1.2783114 Test Loss: 0.4122741
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2995875
	speed: 0.6359s/iter; left time: 9581.7520s
Epoch: 5 cost time: 27.76367974281311
Epoch: 5, Steps: 158 | Train Loss: 1.2879447 Vali Loss: 1.2777324 Test Loss: 0.4109118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.2631700
	speed: 0.5611s/iter; left time: 8366.4767s
Epoch: 6 cost time: 27.873323440551758
Epoch: 6, Steps: 158 | Train Loss: 1.2856890 Vali Loss: 1.2825767 Test Loss: 0.4112595
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.2597617
	speed: 0.5778s/iter; left time: 8524.7580s
Epoch: 7 cost time: 30.261282920837402
Epoch: 7, Steps: 158 | Train Loss: 1.2845402 Vali Loss: 1.2791388 Test Loss: 0.4127362
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.3301439
	speed: 0.6562s/iter; left time: 9576.9011s
Epoch: 8 cost time: 27.9497287273407
Epoch: 8, Steps: 158 | Train Loss: 1.2839427 Vali Loss: 1.2787311 Test Loss: 0.4120019
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.2878854
	speed: 0.5575s/iter; left time: 8048.6033s
Epoch: 9 cost time: 27.769861459732056
Epoch: 9, Steps: 158 | Train Loss: 1.2836069 Vali Loss: 1.2781901 Test Loss: 0.4115558
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.2873718
	speed: 0.6203s/iter; left time: 8857.1791s
Epoch: 10 cost time: 38.5371675491333
Epoch: 10, Steps: 158 | Train Loss: 1.2834416 Vali Loss: 1.2792203 Test Loss: 0.4115374
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.2329278
	speed: 0.6532s/iter; left time: 9223.7780s
Epoch: 11 cost time: 27.819032669067383
Epoch: 11, Steps: 158 | Train Loss: 1.2833866 Vali Loss: 1.2782447 Test Loss: 0.4115388
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.2723716
	speed: 0.5679s/iter; left time: 7929.4123s
Epoch: 12 cost time: 27.869067430496216
Epoch: 12, Steps: 158 | Train Loss: 1.2832792 Vali Loss: 1.2791090 Test Loss: 0.4115352
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.2876179
	speed: 0.6758s/iter; left time: 9329.1694s
Epoch: 13 cost time: 38.36786723136902
Epoch: 13, Steps: 158 | Train Loss: 1.2833168 Vali Loss: 1.2787012 Test Loss: 0.4115042
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41335898637771606, mae:0.43247362971305847
rmse:0.6429300308227539, mape:0.7014226317405701, mspe:35601.1953125

--- [Trial 9] 参数 ---
learning_rate=0.000556265199398985, batch_size=8, ca_layers=2, ia_layers=3, attn_dropout=0.0, n_heads=32, num_p=8, alpha=0.058418859073837426, d_ff_multiplier=4
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.7999051
	speed: 0.0492s/iter; left time: 4659.9856s
	iters: 200, epoch: 1 | loss: 0.7225916
	speed: 0.0441s/iter; left time: 4173.3560s
	iters: 300, epoch: 1 | loss: 0.8569469
	speed: 0.0437s/iter; left time: 4128.7455s
	iters: 400, epoch: 1 | loss: 0.9018415
	speed: 0.0429s/iter; left time: 4049.4727s
	iters: 500, epoch: 1 | loss: 0.6803087
	speed: 0.0418s/iter; left time: 3938.3028s
	iters: 600, epoch: 1 | loss: 0.8039401
	speed: 0.0427s/iter; left time: 4024.4743s
	iters: 700, epoch: 1 | loss: 0.7629070
	speed: 0.0427s/iter; left time: 4016.8684s
	iters: 800, epoch: 1 | loss: 0.7060393
	speed: 0.0423s/iter; left time: 3971.6329s
	iters: 900, epoch: 1 | loss: 0.7801540
	speed: 0.0411s/iter; left time: 3863.7821s
Epoch: 1 cost time: 41.207520961761475
Epoch: 1, Steps: 948 | Train Loss: 0.8025243 Vali Loss: 1.4557759 Test Loss: 0.4599482
Validation loss decreased (inf --> 1.455776).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7788423
	speed: 0.5416s/iter; left time: 50780.8808s
	iters: 200, epoch: 2 | loss: 0.6992936
	speed: 0.0380s/iter; left time: 3562.5172s
	iters: 300, epoch: 2 | loss: 0.6767834
	speed: 0.0390s/iter; left time: 3649.4869s
	iters: 400, epoch: 2 | loss: 0.7159884
	speed: 0.0400s/iter; left time: 3735.2226s
	iters: 500, epoch: 2 | loss: 0.6781447
	speed: 0.0432s/iter; left time: 4031.1576s
	iters: 600, epoch: 2 | loss: 0.6795936
	speed: 0.0383s/iter; left time: 3568.4449s
	iters: 700, epoch: 2 | loss: 0.7055641
	speed: 0.0383s/iter; left time: 3565.0534s
	iters: 800, epoch: 2 | loss: 0.6493491
	speed: 0.0390s/iter; left time: 3630.1353s
	iters: 900, epoch: 2 | loss: 0.6389097
	speed: 0.0401s/iter; left time: 3730.1372s
Epoch: 2 cost time: 37.939085721969604
Epoch: 2, Steps: 948 | Train Loss: 0.6889167 Vali Loss: 1.3749689 Test Loss: 0.4561799
Validation loss decreased (1.455776 --> 1.374969).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6141589
	speed: 0.4748s/iter; left time: 44067.0438s
	iters: 200, epoch: 3 | loss: 0.6920535
	speed: 0.0385s/iter; left time: 3566.1267s
	iters: 300, epoch: 3 | loss: 0.6304162
	speed: 0.0398s/iter; left time: 3684.4868s
	iters: 400, epoch: 3 | loss: 0.6012015
	speed: 0.0391s/iter; left time: 3617.4998s
	iters: 500, epoch: 3 | loss: 0.5976436
	speed: 0.0418s/iter; left time: 3866.3188s
	iters: 600, epoch: 3 | loss: 0.5930507
	speed: 0.0377s/iter; left time: 3476.2547s
	iters: 700, epoch: 3 | loss: 0.5938625
	speed: 0.0392s/iter; left time: 3610.9537s
	iters: 800, epoch: 3 | loss: 0.6197543
	speed: 0.0405s/iter; left time: 3733.3376s
	iters: 900, epoch: 3 | loss: 0.6030228
	speed: 0.0404s/iter; left time: 3715.8308s
Epoch: 3 cost time: 38.048924684524536
Epoch: 3, Steps: 948 | Train Loss: 0.6219949 Vali Loss: 1.3709795 Test Loss: 0.4624528
Validation loss decreased (1.374969 --> 1.370980).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6037673
	speed: 0.5689s/iter; left time: 52258.3648s
	iters: 200, epoch: 4 | loss: 0.6317057
	speed: 0.0439s/iter; left time: 4025.8128s
	iters: 300, epoch: 4 | loss: 0.5837504
	speed: 0.0427s/iter; left time: 3915.3188s
	iters: 400, epoch: 4 | loss: 0.5259132
	speed: 0.0410s/iter; left time: 3749.4185s
	iters: 500, epoch: 4 | loss: 0.6029507
	speed: 0.0404s/iter; left time: 3693.1537s
	iters: 600, epoch: 4 | loss: 0.5343081
	speed: 0.0393s/iter; left time: 3590.2045s
	iters: 700, epoch: 4 | loss: 0.5935957
	speed: 0.0383s/iter; left time: 3493.4555s
	iters: 800, epoch: 4 | loss: 0.5438493
	speed: 0.0379s/iter; left time: 3450.5903s
	iters: 900, epoch: 4 | loss: 0.5923010
	speed: 0.0374s/iter; left time: 3403.9861s
Epoch: 4 cost time: 38.86162877082825
Epoch: 4, Steps: 948 | Train Loss: 0.5881437 Vali Loss: 1.3472942 Test Loss: 0.4707156
Validation loss decreased (1.370980 --> 1.347294).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5742807
	speed: 0.4852s/iter; left time: 44112.9419s
	iters: 200, epoch: 5 | loss: 0.5880530
	speed: 0.0405s/iter; left time: 3675.3582s
	iters: 300, epoch: 5 | loss: 0.5750117
	speed: 0.0441s/iter; left time: 4002.8881s
	iters: 400, epoch: 5 | loss: 0.5889114
	speed: 0.0461s/iter; left time: 4180.7082s
	iters: 500, epoch: 5 | loss: 0.5777839
	speed: 0.0542s/iter; left time: 4907.5854s
	iters: 600, epoch: 5 | loss: 0.5695193
	speed: 0.0552s/iter; left time: 4995.0898s
	iters: 700, epoch: 5 | loss: 0.5713369
	speed: 0.0529s/iter; left time: 4779.3631s
	iters: 800, epoch: 5 | loss: 0.5836849
	speed: 0.0534s/iter; left time: 4817.9443s
	iters: 900, epoch: 5 | loss: 0.5723622
	speed: 0.0537s/iter; left time: 4842.6216s
Epoch: 5 cost time: 47.40030479431152
Epoch: 5, Steps: 948 | Train Loss: 0.5699415 Vali Loss: 1.3512827 Test Loss: 0.4712980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5888881
	speed: 0.5022s/iter; left time: 45175.4063s
	iters: 200, epoch: 6 | loss: 0.5950177
	speed: 0.0399s/iter; left time: 3582.4555s
	iters: 300, epoch: 6 | loss: 0.5441891
	speed: 0.0386s/iter; left time: 3461.7664s
	iters: 400, epoch: 6 | loss: 0.5748124
	speed: 0.0417s/iter; left time: 3735.4569s
	iters: 500, epoch: 6 | loss: 0.5553703
	speed: 0.0440s/iter; left time: 3939.3474s
	iters: 600, epoch: 6 | loss: 0.5454026
	speed: 0.0458s/iter; left time: 4097.6644s
	iters: 700, epoch: 6 | loss: 0.5571845
	speed: 0.0414s/iter; left time: 3696.5357s
	iters: 800, epoch: 6 | loss: 0.5132746
	speed: 0.0426s/iter; left time: 3806.8621s
	iters: 900, epoch: 6 | loss: 0.5575267
	speed: 0.0434s/iter; left time: 3865.2550s
Epoch: 6 cost time: 40.25658106803894
Epoch: 6, Steps: 948 | Train Loss: 0.5607714 Vali Loss: 1.3513688 Test Loss: 0.4712367
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.5048424
	speed: 0.5337s/iter; left time: 47507.4602s
	iters: 200, epoch: 7 | loss: 0.5366904
	speed: 0.0541s/iter; left time: 4809.2982s
	iters: 300, epoch: 7 | loss: 0.5206467
	speed: 0.0539s/iter; left time: 4789.7883s
	iters: 400, epoch: 7 | loss: 0.5206831
	speed: 0.0554s/iter; left time: 4917.4832s
	iters: 500, epoch: 7 | loss: 0.5893089
	speed: 0.0395s/iter; left time: 3503.2569s
	iters: 600, epoch: 7 | loss: 0.5530727
	speed: 0.0379s/iter; left time: 3352.7622s
	iters: 700, epoch: 7 | loss: 0.5261302
	speed: 0.0396s/iter; left time: 3501.0315s
	iters: 800, epoch: 7 | loss: 0.5548637
	speed: 0.0400s/iter; left time: 3531.7087s
	iters: 900, epoch: 7 | loss: 0.6162632
	speed: 0.0379s/iter; left time: 3340.2635s
Epoch: 7 cost time: 43.87405705451965
Epoch: 7, Steps: 948 | Train Loss: 0.5562741 Vali Loss: 1.3636788 Test Loss: 0.4748152
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5403106
	speed: 0.5012s/iter; left time: 44141.4250s
	iters: 200, epoch: 8 | loss: 0.5096978
	speed: 0.0395s/iter; left time: 3470.2538s
	iters: 300, epoch: 8 | loss: 0.6135458
	speed: 0.0386s/iter; left time: 3388.3025s
	iters: 400, epoch: 8 | loss: 0.5528964
	speed: 0.0424s/iter; left time: 3717.7357s
	iters: 500, epoch: 8 | loss: 0.5253346
	speed: 0.0391s/iter; left time: 3430.4248s
	iters: 600, epoch: 8 | loss: 0.5573918
	speed: 0.0389s/iter; left time: 3408.7020s
	iters: 700, epoch: 8 | loss: 0.5935744
	speed: 0.0384s/iter; left time: 3359.1320s
	iters: 800, epoch: 8 | loss: 0.5374291
	speed: 0.0381s/iter; left time: 3330.1757s
	iters: 900, epoch: 8 | loss: 0.5261129
	speed: 0.0393s/iter; left time: 3430.0276s
Epoch: 8 cost time: 37.692922830581665
Epoch: 8, Steps: 948 | Train Loss: 0.5539776 Vali Loss: 1.3642685 Test Loss: 0.4736372
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5163733
	speed: 0.5415s/iter; left time: 47170.5481s
	iters: 200, epoch: 9 | loss: 0.5259249
	speed: 0.0445s/iter; left time: 3873.3082s
	iters: 300, epoch: 9 | loss: 0.5538428
	speed: 0.0401s/iter; left time: 3485.3870s
	iters: 400, epoch: 9 | loss: 0.5306770
	speed: 0.0418s/iter; left time: 3629.3330s
	iters: 500, epoch: 9 | loss: 0.5635558
	speed: 0.0421s/iter; left time: 3646.5226s
	iters: 600, epoch: 9 | loss: 0.5417557
	speed: 0.0415s/iter; left time: 3593.3882s
	iters: 700, epoch: 9 | loss: 0.5781934
	speed: 0.0432s/iter; left time: 3738.9807s
	iters: 800, epoch: 9 | loss: 0.5457839
	speed: 0.0431s/iter; left time: 3727.5311s
	iters: 900, epoch: 9 | loss: 0.5147053
	speed: 0.0430s/iter; left time: 3709.0904s
Epoch: 9 cost time: 40.91897702217102
Epoch: 9, Steps: 948 | Train Loss: 0.5528074 Vali Loss: 1.3637781 Test Loss: 0.4751569
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.5497679
	speed: 0.4765s/iter; left time: 41062.2811s
	iters: 200, epoch: 10 | loss: 0.5628166
	speed: 0.0392s/iter; left time: 3372.1475s
	iters: 300, epoch: 10 | loss: 0.5836053
	speed: 0.0393s/iter; left time: 3376.5596s
	iters: 400, epoch: 10 | loss: 0.5660717
	speed: 0.0398s/iter; left time: 3419.2167s
	iters: 500, epoch: 10 | loss: 0.5714527
	speed: 0.0418s/iter; left time: 3582.1759s
	iters: 600, epoch: 10 | loss: 0.5933332
	speed: 0.0391s/iter; left time: 3347.7437s
	iters: 700, epoch: 10 | loss: 0.5795859
	speed: 0.0378s/iter; left time: 3234.6691s
	iters: 800, epoch: 10 | loss: 0.5687549
	speed: 0.0394s/iter; left time: 3367.7588s
	iters: 900, epoch: 10 | loss: 0.5217694
	speed: 0.0392s/iter; left time: 3345.7963s
Epoch: 10 cost time: 37.698570013046265
Epoch: 10, Steps: 948 | Train Loss: 0.5522202 Vali Loss: 1.3643059 Test Loss: 0.4748286
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.5667129
	speed: 0.5477s/iter; left time: 46676.0478s
	iters: 200, epoch: 11 | loss: 0.5953590
	speed: 0.0410s/iter; left time: 3490.7386s
	iters: 300, epoch: 11 | loss: 0.6027460
	speed: 0.0416s/iter; left time: 3533.9758s
	iters: 400, epoch: 11 | loss: 0.5288888
	speed: 0.0396s/iter; left time: 3359.4925s
	iters: 500, epoch: 11 | loss: 0.5817415
	speed: 0.0388s/iter; left time: 3287.6488s
	iters: 600, epoch: 11 | loss: 0.4983794
	speed: 0.0392s/iter; left time: 3318.0978s
	iters: 700, epoch: 11 | loss: 0.5547737
	speed: 0.0402s/iter; left time: 3403.7583s
	iters: 800, epoch: 11 | loss: 0.5613434
	speed: 0.0394s/iter; left time: 3332.9918s
	iters: 900, epoch: 11 | loss: 0.5598359
	speed: 0.0398s/iter; left time: 3358.6260s
Epoch: 11 cost time: 38.346903562545776
Epoch: 11, Steps: 948 | Train Loss: 0.5519027 Vali Loss: 1.3646783 Test Loss: 0.4742050
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.5343671
	speed: 0.5140s/iter; left time: 43313.9297s
	iters: 200, epoch: 12 | loss: 0.4963093
	speed: 0.0428s/iter; left time: 3599.5843s
	iters: 300, epoch: 12 | loss: 0.5534163
	speed: 0.0414s/iter; left time: 3479.3735s
	iters: 400, epoch: 12 | loss: 0.5233946
	speed: 0.0476s/iter; left time: 4000.1674s
	iters: 500, epoch: 12 | loss: 0.5440233
	speed: 0.0535s/iter; left time: 4490.3993s
	iters: 600, epoch: 12 | loss: 0.5070910
	speed: 0.0547s/iter; left time: 4586.0236s
	iters: 700, epoch: 12 | loss: 0.5674111
	speed: 0.0532s/iter; left time: 4449.2935s
	iters: 800, epoch: 12 | loss: 0.5875375
	speed: 0.0526s/iter; left time: 4394.9736s
	iters: 900, epoch: 12 | loss: 0.5499123
	speed: 0.0548s/iter; left time: 4573.9785s
Epoch: 12 cost time: 47.57324957847595
Epoch: 12, Steps: 948 | Train Loss: 0.5517564 Vali Loss: 1.3642204 Test Loss: 0.4746844
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.5595706
	speed: 0.4963s/iter; left time: 41355.0999s
	iters: 200, epoch: 13 | loss: 0.5251468
	speed: 0.0397s/iter; left time: 3300.0293s
	iters: 300, epoch: 13 | loss: 0.5212352
	speed: 0.0381s/iter; left time: 3163.9650s
	iters: 400, epoch: 13 | loss: 0.4944906
	speed: 0.0380s/iter; left time: 3152.3305s
	iters: 500, epoch: 13 | loss: 0.5486045
	speed: 0.0388s/iter; left time: 3217.4535s
	iters: 600, epoch: 13 | loss: 0.5492493
	speed: 0.0379s/iter; left time: 3141.8295s
	iters: 700, epoch: 13 | loss: 0.5769694
	speed: 0.0390s/iter; left time: 3226.1808s
	iters: 800, epoch: 13 | loss: 0.5842540
	speed: 0.0428s/iter; left time: 3535.9402s
	iters: 900, epoch: 13 | loss: 0.5390910
	speed: 0.0381s/iter; left time: 3143.8575s
Epoch: 13 cost time: 38.039578676223755
Epoch: 13, Steps: 948 | Train Loss: 0.5516964 Vali Loss: 1.3645581 Test Loss: 0.4745884
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.5683320
	speed: 0.5113s/iter; left time: 42119.9849s
	iters: 200, epoch: 14 | loss: 0.5212770
	speed: 0.0532s/iter; left time: 4379.4795s
	iters: 300, epoch: 14 | loss: 0.5350480
	speed: 0.0530s/iter; left time: 4357.0559s
	iters: 400, epoch: 14 | loss: 0.4980123
	speed: 0.0531s/iter; left time: 4354.6260s
	iters: 500, epoch: 14 | loss: 0.6012148
	speed: 0.0493s/iter; left time: 4039.0838s
	iters: 600, epoch: 14 | loss: 0.5524065
	speed: 0.0384s/iter; left time: 3141.3922s
	iters: 700, epoch: 14 | loss: 0.5421201
	speed: 0.0389s/iter; left time: 3179.1183s
	iters: 800, epoch: 14 | loss: 0.5338385
	speed: 0.0385s/iter; left time: 3147.7427s
	iters: 900, epoch: 14 | loss: 0.5149741
	speed: 0.0394s/iter; left time: 3215.5622s
Epoch: 14 cost time: 44.27659893035889
Epoch: 14, Steps: 948 | Train Loss: 0.5516328 Vali Loss: 1.3646016 Test Loss: 0.4746608
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.47071582078933716, mae:0.4748803973197937
rmse:0.6860873103141785, mape:0.7624065279960632, mspe:47609.21875

--- [Trial 10] 参数 ---
learning_rate=0.00010297549944718892, batch_size=48, ca_layers=3, ia_layers=3, attn_dropout=0.1, n_heads=64, num_p=4, alpha=0.11128279360893069, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.3179270
	speed: 0.2345s/iter; left time: 3682.4800s
Epoch: 1 cost time: 44.88244438171387
Epoch: 1, Steps: 158 | Train Loss: 1.4780249 Vali Loss: 1.3462932 Test Loss: 0.5168942
Validation loss decreased (inf --> 1.346293).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2356970
	speed: 0.9475s/iter; left time: 14726.3063s
Epoch: 2 cost time: 35.162362813949585
Epoch: 2, Steps: 158 | Train Loss: 1.2251809 Vali Loss: 1.2701069 Test Loss: 0.4567459
Validation loss decreased (1.346293 --> 1.270107).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1709431
	speed: 0.9445s/iter; left time: 14530.9131s
Epoch: 3 cost time: 48.12890267372131
Epoch: 3, Steps: 158 | Train Loss: 1.1848137 Vali Loss: 1.2356976 Test Loss: 0.4437050
Validation loss decreased (1.270107 --> 1.235698).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0931511
	speed: 0.8142s/iter; left time: 12398.2563s
Epoch: 4 cost time: 35.209256649017334
Epoch: 4, Steps: 158 | Train Loss: 1.1525563 Vali Loss: 1.2406250 Test Loss: 0.4298709
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1440355
	speed: 0.8727s/iter; left time: 13151.4655s
Epoch: 5 cost time: 38.96928644180298
Epoch: 5, Steps: 158 | Train Loss: 1.1412839 Vali Loss: 1.2507303 Test Loss: 0.4295063
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1564462
	speed: 0.8225s/iter; left time: 12264.7968s
Epoch: 6 cost time: 35.19641947746277
Epoch: 6, Steps: 158 | Train Loss: 1.1363974 Vali Loss: 1.2543008 Test Loss: 0.4298380
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.1637630
	speed: 0.8677s/iter; left time: 12801.6487s
Epoch: 7 cost time: 35.34582304954529
Epoch: 7, Steps: 158 | Train Loss: 1.1340500 Vali Loss: 1.2586412 Test Loss: 0.4309977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.1474983
	speed: 0.8085s/iter; left time: 11800.1210s
Epoch: 8 cost time: 35.263596296310425
Epoch: 8, Steps: 158 | Train Loss: 1.1329936 Vali Loss: 1.2583443 Test Loss: 0.4310349
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.1524775
	speed: 0.8665s/iter; left time: 12509.3661s
Epoch: 9 cost time: 35.26159691810608
Epoch: 9, Steps: 158 | Train Loss: 1.1324815 Vali Loss: 1.2593701 Test Loss: 0.4315101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.1309512
	speed: 0.8025s/iter; left time: 11458.7730s
Epoch: 10 cost time: 35.2165048122406
Epoch: 10, Steps: 158 | Train Loss: 1.1322084 Vali Loss: 1.2597548 Test Loss: 0.4312605
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.1378050
	speed: 0.8539s/iter; left time: 12058.1864s
Epoch: 11 cost time: 35.22467041015625
Epoch: 11, Steps: 158 | Train Loss: 1.1321269 Vali Loss: 1.2599421 Test Loss: 0.4312609
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.1749805
	speed: 0.8194s/iter; left time: 11441.9004s
Epoch: 12 cost time: 35.236823081970215
Epoch: 12, Steps: 158 | Train Loss: 1.1319994 Vali Loss: 1.2598631 Test Loss: 0.4312648
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.1239910
	speed: 0.8635s/iter; left time: 11920.8071s
Epoch: 13 cost time: 35.31504464149475
Epoch: 13, Steps: 158 | Train Loss: 1.1319714 Vali Loss: 1.2599458 Test Loss: 0.4312777
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4437270760536194, mae:0.45700326561927795
rmse:0.666128396987915, mape:0.7294619679450989, mspe:43112.10546875

--- [Trial 11] 参数 ---
learning_rate=0.00010803295448934875, batch_size=64, ca_layers=1, ia_layers=1, attn_dropout=0.1, n_heads=8, num_p=12, alpha=0.1484854886283505, d_ff_multiplier=4
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.3837742
	speed: 0.0690s/iter; left time: 807.7127s
Epoch: 1 cost time: 8.28813910484314
Epoch: 1, Steps: 118 | Train Loss: 1.6524209 Vali Loss: 1.2462066 Test Loss: 0.4460737
Validation loss decreased (inf --> 1.246207).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3558654
	speed: 0.3238s/iter; left time: 3750.7499s
Epoch: 2 cost time: 8.477398157119751
Epoch: 2, Steps: 118 | Train Loss: 1.3625894 Vali Loss: 1.2382243 Test Loss: 0.4247137
Validation loss decreased (1.246207 --> 1.238224).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3008778
	speed: 0.3305s/iter; left time: 3789.0171s
Epoch: 3 cost time: 8.418100118637085
Epoch: 3, Steps: 118 | Train Loss: 1.3372282 Vali Loss: 1.2405934 Test Loss: 0.4187227
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.2608711
	speed: 0.3608s/iter; left time: 4094.1875s
Epoch: 4 cost time: 11.79029655456543
Epoch: 4, Steps: 118 | Train Loss: 1.3272212 Vali Loss: 1.2516904 Test Loss: 0.4178771
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.2792630
	speed: 0.3845s/iter; left time: 4317.8679s
Epoch: 5 cost time: 8.80324411392212
Epoch: 5, Steps: 118 | Train Loss: 1.3230593 Vali Loss: 1.2557840 Test Loss: 0.4167089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.3522830
	speed: 0.3323s/iter; left time: 3692.5660s
Epoch: 6 cost time: 8.471243619918823
Epoch: 6, Steps: 118 | Train Loss: 1.3207927 Vali Loss: 1.2488326 Test Loss: 0.4160279
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.3549229
	speed: 0.3254s/iter; left time: 3577.3370s
Epoch: 7 cost time: 8.350192308425903
Epoch: 7, Steps: 118 | Train Loss: 1.3197450 Vali Loss: 1.2496513 Test Loss: 0.4162035
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.3435626
	speed: 0.3229s/iter; left time: 3512.0278s
Epoch: 8 cost time: 8.72871994972229
Epoch: 8, Steps: 118 | Train Loss: 1.3191479 Vali Loss: 1.2491921 Test Loss: 0.4160446
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.2924105
	speed: 0.3908s/iter; left time: 4203.3197s
Epoch: 9 cost time: 12.375521659851074
Epoch: 9, Steps: 118 | Train Loss: 1.3187716 Vali Loss: 1.2498850 Test Loss: 0.4158726
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.2951624
	speed: 0.3511s/iter; left time: 3735.7352s
Epoch: 10 cost time: 8.429381370544434
Epoch: 10, Steps: 118 | Train Loss: 1.3186263 Vali Loss: 1.2510638 Test Loss: 0.4158606
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.2844330
	speed: 0.3213s/iter; left time: 3380.2505s
Epoch: 11 cost time: 8.424274444580078
Epoch: 11, Steps: 118 | Train Loss: 1.3184790 Vali Loss: 1.2496741 Test Loss: 0.4158461
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 1.3433032
	speed: 0.3263s/iter; left time: 3394.6794s
Epoch: 12 cost time: 8.451066017150879
Epoch: 12, Steps: 118 | Train Loss: 1.3184936 Vali Loss: 1.2528439 Test Loss: 0.4158309
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4246966540813446, mae:0.44062116742134094
rmse:0.6516875624656677, mape:0.7106727957725525, mspe:35171.73046875

--- [Trial 12] 参数 ---
learning_rate=0.00025891679215812077, batch_size=64, ca_layers=1, ia_layers=1, attn_dropout=0.05, n_heads=8, num_p=12, alpha=0.19949765825660953, d_ff_multiplier=4
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.6400250
	speed: 0.1065s/iter; left time: 1245.6297s
Epoch: 1 cost time: 11.981274604797363
Epoch: 1, Steps: 118 | Train Loss: 1.8367944 Vali Loss: 1.2421267 Test Loss: 0.4269805
Validation loss decreased (inf --> 1.242127).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6220911
	speed: 0.3278s/iter; left time: 3796.6406s
Epoch: 2 cost time: 8.441493511199951
Epoch: 2, Steps: 118 | Train Loss: 1.6265203 Vali Loss: 1.2475855 Test Loss: 0.4172985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5481027
	speed: 0.3259s/iter; left time: 3736.4220s
Epoch: 3 cost time: 8.228734254837036
Epoch: 3, Steps: 118 | Train Loss: 1.5946504 Vali Loss: 1.2661097 Test Loss: 0.4167043
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.5000706
	speed: 0.3337s/iter; left time: 3786.0927s
Epoch: 4 cost time: 8.322852611541748
Epoch: 4, Steps: 118 | Train Loss: 1.5803424 Vali Loss: 1.2781895 Test Loss: 0.4184850
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.5271524
	speed: 0.3785s/iter; left time: 4250.5315s
Epoch: 5 cost time: 12.723095417022705
Epoch: 5, Steps: 118 | Train Loss: 1.5738289 Vali Loss: 1.2782778 Test Loss: 0.4160688
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.6068268
	speed: 0.3631s/iter; left time: 4033.9364s
Epoch: 6 cost time: 8.332591533660889
Epoch: 6, Steps: 118 | Train Loss: 1.5701122 Vali Loss: 1.2795736 Test Loss: 0.4181948
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.6066278
	speed: 0.3258s/iter; left time: 3581.9498s
Epoch: 7 cost time: 8.3415207862854
Epoch: 7, Steps: 118 | Train Loss: 1.5683359 Vali Loss: 1.2833232 Test Loss: 0.4193795
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.5998424
	speed: 0.3294s/iter; left time: 3582.2049s
Epoch: 8 cost time: 8.30992865562439
Epoch: 8, Steps: 118 | Train Loss: 1.5673711 Vali Loss: 1.2821620 Test Loss: 0.4189727
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.5348296
	speed: 0.3385s/iter; left time: 3641.6499s
Epoch: 9 cost time: 8.32492446899414
Epoch: 9, Steps: 118 | Train Loss: 1.5667330 Vali Loss: 1.2838768 Test Loss: 0.4188865
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.5304108
	speed: 0.3893s/iter; left time: 4141.7934s
Epoch: 10 cost time: 11.297932863235474
Epoch: 10, Steps: 118 | Train Loss: 1.5664387 Vali Loss: 1.2863691 Test Loss: 0.4189197
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.5317895
	speed: 0.3287s/iter; left time: 3458.3012s
Epoch: 11 cost time: 8.381486177444458
Epoch: 11, Steps: 118 | Train Loss: 1.5662681 Vali Loss: 1.2853981 Test Loss: 0.4189445
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4269871413707733, mae:0.44280189275741577
rmse:0.6534425020217896, mape:0.7141100764274597, mspe:35470.234375

--- [Trial 13] 参数 ---
learning_rate=0.00015505516863889996, batch_size=48, ca_layers=1, ia_layers=1, attn_dropout=0.15000000000000002, n_heads=64, num_p=4, alpha=0.31563321866816035, d_ff_multiplier=4
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.5325127
	speed: 0.0915s/iter; left time: 1437.0054s
Epoch: 1 cost time: 14.64286756515503
Epoch: 1, Steps: 158 | Train Loss: 2.9596093 Vali Loss: 1.3069704 Test Loss: 0.5017315
Validation loss decreased (inf --> 1.306970).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4347613
	speed: 0.4643s/iter; left time: 7216.7874s
Epoch: 2 cost time: 21.757148027420044
Epoch: 2, Steps: 158 | Train Loss: 2.4032353 Vali Loss: 1.2397560 Test Loss: 0.4261918
Validation loss decreased (1.306970 --> 1.239756).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3498683
	speed: 0.4403s/iter; left time: 6774.3528s
Epoch: 3 cost time: 14.685495138168335
Epoch: 3, Steps: 158 | Train Loss: 2.3348792 Vali Loss: 1.2401754 Test Loss: 0.4199198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.2417164
	speed: 0.3895s/iter; left time: 5930.1977s
Epoch: 4 cost time: 14.483839273452759
Epoch: 4, Steps: 158 | Train Loss: 2.3152687 Vali Loss: 1.2446152 Test Loss: 0.4188889
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.2952611
	speed: 0.4004s/iter; left time: 6033.9777s
Epoch: 5 cost time: 14.400757312774658
Epoch: 5, Steps: 158 | Train Loss: 2.3054960 Vali Loss: 1.2485094 Test Loss: 0.4182031
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.2211533
	speed: 0.4544s/iter; left time: 6774.9742s
Epoch: 6 cost time: 22.203201055526733
Epoch: 6, Steps: 158 | Train Loss: 2.3004868 Vali Loss: 1.2502090 Test Loss: 0.4183937
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.3239682
	speed: 0.4485s/iter; left time: 6616.0092s
Epoch: 7 cost time: 14.587938070297241
Epoch: 7, Steps: 158 | Train Loss: 2.2978683 Vali Loss: 1.2486418 Test Loss: 0.4173578
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.2690761
	speed: 0.3832s/iter; left time: 5592.1989s
Epoch: 8 cost time: 14.517521619796753
Epoch: 8, Steps: 158 | Train Loss: 2.2966106 Vali Loss: 1.2496507 Test Loss: 0.4175247
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.2364650
	speed: 0.3883s/iter; left time: 5605.6626s
Epoch: 9 cost time: 14.630051374435425
Epoch: 9, Steps: 158 | Train Loss: 2.2958638 Vali Loss: 1.2501042 Test Loss: 0.4174969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.2131994
	speed: 0.4655s/iter; left time: 6647.4366s
Epoch: 10 cost time: 20.74330449104309
Epoch: 10, Steps: 158 | Train Loss: 2.2955507 Vali Loss: 1.2502761 Test Loss: 0.4175310
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.3222063
	speed: 0.4061s/iter; left time: 5734.5051s
Epoch: 11 cost time: 14.542296648025513
Epoch: 11, Steps: 158 | Train Loss: 2.2953399 Vali Loss: 1.2504412 Test Loss: 0.4174775
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.3243515
	speed: 0.4016s/iter; left time: 5607.4015s
Epoch: 12 cost time: 14.469863176345825
Epoch: 12, Steps: 158 | Train Loss: 2.2952885 Vali Loss: 1.2501283 Test Loss: 0.4174760
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.426187664270401, mae:0.4456002414226532
rmse:0.6528304815292358, mape:0.722472608089447, mspe:35541.44140625

--- [Trial 14] 参数 ---
learning_rate=0.0009151559399389793, batch_size=16, ca_layers=3, ia_layers=3, attn_dropout=0.05, n_heads=8, num_p=12, alpha=0.11079282154577905, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.1288278
	speed: 0.0745s/iter; left time: 3526.0112s
	iters: 200, epoch: 1 | loss: 1.0761875
	speed: 0.0690s/iter; left time: 3255.5941s
	iters: 300, epoch: 1 | loss: 1.0485716
	speed: 0.0699s/iter; left time: 3290.0466s
	iters: 400, epoch: 1 | loss: 1.0512977
	speed: 0.0749s/iter; left time: 3519.8265s
Epoch: 1 cost time: 32.509193420410156
Epoch: 1, Steps: 474 | Train Loss: 1.1088056 Vali Loss: 1.3500835 Test Loss: 0.4550554
Validation loss decreased (inf --> 1.350083).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9269969
	speed: 0.5395s/iter; left time: 25261.3805s
	iters: 200, epoch: 2 | loss: 0.9841992
	speed: 0.0468s/iter; left time: 2184.9653s
	iters: 300, epoch: 2 | loss: 0.9334778
	speed: 0.0481s/iter; left time: 2242.8422s
	iters: 400, epoch: 2 | loss: 1.0214648
	speed: 0.0520s/iter; left time: 2419.8604s
Epoch: 2 cost time: 23.49373722076416
Epoch: 2, Steps: 474 | Train Loss: 0.9768837 Vali Loss: 1.3642035 Test Loss: 0.4466380
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8564606
	speed: 0.5715s/iter; left time: 26489.8487s
	iters: 200, epoch: 3 | loss: 0.8677425
	speed: 0.0683s/iter; left time: 3157.5414s
	iters: 300, epoch: 3 | loss: 0.8864399
	speed: 0.0704s/iter; left time: 3250.7924s
	iters: 400, epoch: 3 | loss: 0.8838314
	speed: 0.0738s/iter; left time: 3399.7836s
Epoch: 3 cost time: 33.6252977848053
Epoch: 3, Steps: 474 | Train Loss: 0.9007327 Vali Loss: 1.3609799 Test Loss: 0.4414248
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8502116
	speed: 0.5718s/iter; left time: 26233.7140s
	iters: 200, epoch: 4 | loss: 0.8825868
	speed: 0.0517s/iter; left time: 2367.2920s
	iters: 300, epoch: 4 | loss: 0.8190880
	speed: 0.0536s/iter; left time: 2448.5180s
	iters: 400, epoch: 4 | loss: 0.8818560
	speed: 0.0498s/iter; left time: 2270.7369s
Epoch: 4 cost time: 25.043700456619263
Epoch: 4, Steps: 474 | Train Loss: 0.8632273 Vali Loss: 1.3525195 Test Loss: 0.4625076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8288569
	speed: 0.5795s/iter; left time: 26312.2092s
	iters: 200, epoch: 5 | loss: 0.8435266
	speed: 0.0700s/iter; left time: 3172.5450s
	iters: 300, epoch: 5 | loss: 0.8208141
	speed: 0.0683s/iter; left time: 3089.0345s
	iters: 400, epoch: 5 | loss: 0.8491829
	speed: 0.0721s/iter; left time: 3250.1040s
Epoch: 5 cost time: 33.28942036628723
Epoch: 5, Steps: 474 | Train Loss: 0.8418476 Vali Loss: 1.3334237 Test Loss: 0.4630184
Validation loss decreased (1.350083 --> 1.333424).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7865173
	speed: 0.5746s/iter; left time: 25816.1382s
	iters: 200, epoch: 6 | loss: 0.8247402
	speed: 0.0465s/iter; left time: 2083.1050s
	iters: 300, epoch: 6 | loss: 0.8345047
	speed: 0.0460s/iter; left time: 2057.2801s
	iters: 400, epoch: 6 | loss: 0.8106250
	speed: 0.0514s/iter; left time: 2295.4859s
Epoch: 6 cost time: 23.60152268409729
Epoch: 6, Steps: 474 | Train Loss: 0.8295957 Vali Loss: 1.3503721 Test Loss: 0.4688917
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8411591
	speed: 0.5724s/iter; left time: 25447.4645s
	iters: 200, epoch: 7 | loss: 0.8443460
	speed: 0.0702s/iter; left time: 3112.0554s
	iters: 300, epoch: 7 | loss: 0.7974525
	speed: 0.0695s/iter; left time: 3075.9682s
	iters: 400, epoch: 7 | loss: 0.8112025
	speed: 0.0697s/iter; left time: 3078.0399s
Epoch: 7 cost time: 34.329428911209106
Epoch: 7, Steps: 474 | Train Loss: 0.8233022 Vali Loss: 1.3531004 Test Loss: 0.4721124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8278623
	speed: 0.5608s/iter; left time: 24664.1602s
	iters: 200, epoch: 8 | loss: 0.8505998
	speed: 0.0481s/iter; left time: 2112.4019s
	iters: 300, epoch: 8 | loss: 0.7989432
	speed: 0.0480s/iter; left time: 2103.3247s
	iters: 400, epoch: 8 | loss: 0.8030993
	speed: 0.0473s/iter; left time: 2064.2309s
Epoch: 8 cost time: 23.56055760383606
Epoch: 8, Steps: 474 | Train Loss: 0.8199873 Vali Loss: 1.3629283 Test Loss: 0.4716947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.8017352
	speed: 0.5682s/iter; left time: 24719.7243s
	iters: 200, epoch: 9 | loss: 0.8227348
	speed: 0.0683s/iter; left time: 2966.5317s
	iters: 300, epoch: 9 | loss: 0.7710663
	speed: 0.0687s/iter; left time: 2977.4661s
	iters: 400, epoch: 9 | loss: 0.8456284
	speed: 0.0707s/iter; left time: 3053.2653s
Epoch: 9 cost time: 33.90340065956116
Epoch: 9, Steps: 474 | Train Loss: 0.8182538 Vali Loss: 1.3614643 Test Loss: 0.4719311
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.8303391
	speed: 0.5669s/iter; left time: 24396.1599s
	iters: 200, epoch: 10 | loss: 0.8425969
	speed: 0.0476s/iter; left time: 2044.2444s
	iters: 300, epoch: 10 | loss: 0.8383470
	speed: 0.0495s/iter; left time: 2119.6594s
	iters: 400, epoch: 10 | loss: 0.8408452
	speed: 0.0548s/iter; left time: 2343.5525s
Epoch: 10 cost time: 24.35442590713501
Epoch: 10, Steps: 474 | Train Loss: 0.8172975 Vali Loss: 1.3616906 Test Loss: 0.4721245
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.7518626
	speed: 0.5626s/iter; left time: 23946.7008s
	iters: 200, epoch: 11 | loss: 0.8690374
	speed: 0.0685s/iter; left time: 2908.8995s
	iters: 300, epoch: 11 | loss: 0.8413162
	speed: 0.0692s/iter; left time: 2933.1377s
	iters: 400, epoch: 11 | loss: 0.8401020
	speed: 0.0711s/iter; left time: 3003.4784s
Epoch: 11 cost time: 34.0762939453125
Epoch: 11, Steps: 474 | Train Loss: 0.8168641 Vali Loss: 1.3607470 Test Loss: 0.4719465
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.8308032
	speed: 0.5700s/iter; left time: 23990.2632s
	iters: 200, epoch: 12 | loss: 0.8027428
	speed: 0.0507s/iter; left time: 2129.1480s
	iters: 300, epoch: 12 | loss: 0.8073123
	speed: 0.0569s/iter; left time: 2381.7955s
	iters: 400, epoch: 12 | loss: 0.8107744
	speed: 0.0518s/iter; left time: 2164.9512s
Epoch: 12 cost time: 25.132532835006714
Epoch: 12, Steps: 474 | Train Loss: 0.8166916 Vali Loss: 1.3609452 Test Loss: 0.4721473
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.8172166
	speed: 0.5851s/iter; left time: 24348.1718s
	iters: 200, epoch: 13 | loss: 0.8299432
	speed: 0.0692s/iter; left time: 2871.9980s
	iters: 300, epoch: 13 | loss: 0.7983571
	speed: 0.0706s/iter; left time: 2924.2356s
	iters: 400, epoch: 13 | loss: 0.8397444
	speed: 0.0720s/iter; left time: 2974.3298s
Epoch: 13 cost time: 33.529125690460205
Epoch: 13, Steps: 474 | Train Loss: 0.8164944 Vali Loss: 1.3610661 Test Loss: 0.4720450
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.8168449
	speed: 0.5533s/iter; left time: 22760.7828s
	iters: 200, epoch: 14 | loss: 0.8015072
	speed: 0.0517s/iter; left time: 2123.5383s
	iters: 300, epoch: 14 | loss: 0.8295407
	speed: 0.0493s/iter; left time: 2018.6701s
	iters: 400, epoch: 14 | loss: 0.7895374
	speed: 0.0497s/iter; left time: 2028.3645s
Epoch: 14 cost time: 24.026655435562134
Epoch: 14, Steps: 474 | Train Loss: 0.8164064 Vali Loss: 1.3617452 Test Loss: 0.4723460
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.8216684
	speed: 0.5891s/iter; left time: 23956.9408s
	iters: 200, epoch: 15 | loss: 0.7994847
	speed: 0.0714s/iter; left time: 2894.4286s
	iters: 300, epoch: 15 | loss: 0.8147302
	speed: 0.0687s/iter; left time: 2779.1639s
	iters: 400, epoch: 15 | loss: 0.8506416
	speed: 0.0694s/iter; left time: 2802.7245s
Epoch: 15 cost time: 33.5914568901062
Epoch: 15, Steps: 474 | Train Loss: 0.8165175 Vali Loss: 1.3616422 Test Loss: 0.4723860
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.46301892399787903, mae:0.4695786237716675
rmse:0.6804549098014832, mape:0.7564927935600281, mspe:53018.9296875

--- [Trial 15] 参数 ---
learning_rate=0.00014537577417912613, batch_size=64, ca_layers=1, ia_layers=1, attn_dropout=0.05, n_heads=16, num_p=12, alpha=0.11615449773016681, d_ff_multiplier=4
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.1709905
	speed: 0.0852s/iter; left time: 996.7802s
Epoch: 1 cost time: 10.200430393218994
Epoch: 1, Steps: 118 | Train Loss: 1.3570975 Vali Loss: 1.2431374 Test Loss: 0.4317468
Validation loss decreased (inf --> 1.243137).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1537428
	speed: 0.4097s/iter; left time: 4745.2939s
Epoch: 2 cost time: 15.331655740737915
Epoch: 2, Steps: 118 | Train Loss: 1.1578296 Vali Loss: 1.2458793 Test Loss: 0.4198952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1007791
	speed: 0.3758s/iter; left time: 4308.5519s
Epoch: 3 cost time: 10.404707193374634
Epoch: 3, Steps: 118 | Train Loss: 1.1361701 Vali Loss: 1.2529057 Test Loss: 0.4186905
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.0664736
	speed: 0.3474s/iter; left time: 3942.2497s
Epoch: 4 cost time: 10.296006441116333
Epoch: 4, Steps: 118 | Train Loss: 1.1271796 Vali Loss: 1.2673538 Test Loss: 0.4186651
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.0857323
	speed: 0.3607s/iter; left time: 4050.7162s
Epoch: 5 cost time: 10.245549440383911
Epoch: 5, Steps: 118 | Train Loss: 1.1230012 Vali Loss: 1.2680161 Test Loss: 0.4166154
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.1484139
	speed: 0.4051s/iter; left time: 4500.7501s
Epoch: 6 cost time: 15.921748638153076
Epoch: 6, Steps: 118 | Train Loss: 1.1207832 Vali Loss: 1.2619159 Test Loss: 0.4175230
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.1495581
	speed: 0.3773s/iter; left time: 4147.7245s
Epoch: 7 cost time: 10.367709875106812
Epoch: 7, Steps: 118 | Train Loss: 1.1196997 Vali Loss: 1.2646999 Test Loss: 0.4180669
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.1400602
	speed: 0.3462s/iter; left time: 3764.7943s
Epoch: 8 cost time: 10.265130758285522
Epoch: 8, Steps: 118 | Train Loss: 1.1190643 Vali Loss: 1.2628936 Test Loss: 0.4175663
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.0917107
	speed: 0.3463s/iter; left time: 3724.6851s
Epoch: 9 cost time: 10.29176664352417
Epoch: 9, Steps: 118 | Train Loss: 1.1187195 Vali Loss: 1.2639315 Test Loss: 0.4174529
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.0966430
	speed: 0.3950s/iter; left time: 4201.9382s
Epoch: 10 cost time: 15.806340217590332
Epoch: 10, Steps: 118 | Train Loss: 1.1186040 Vali Loss: 1.2654595 Test Loss: 0.4174457
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.0861127
	speed: 0.3830s/iter; left time: 4029.8512s
Epoch: 11 cost time: 10.31101107597351
Epoch: 11, Steps: 118 | Train Loss: 1.1184077 Vali Loss: 1.2643312 Test Loss: 0.4174357
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.43175849318504333, mae:0.4466719329357147
rmse:0.6570833325386047, mape:0.719508945941925, mspe:35331.72265625

--- [Trial 16] 参数 ---
learning_rate=0.0003503180568842076, batch_size=48, ca_layers=0, ia_layers=3, attn_dropout=0.15000000000000002, n_heads=8, num_p=12, alpha=0.3871178066105264, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.7829390
	speed: 0.0688s/iter; left time: 1080.5037s
Epoch: 1 cost time: 10.867576122283936
Epoch: 1, Steps: 158 | Train Loss: 2.9534855 Vali Loss: 1.2684447 Test Loss: 0.4213653
Validation loss decreased (inf --> 1.268445).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7425396
	speed: 0.3765s/iter; left time: 5851.6909s
Epoch: 2 cost time: 11.229215860366821
Epoch: 2, Steps: 158 | Train Loss: 2.6923268 Vali Loss: 1.2695674 Test Loss: 0.4128687
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.5349777
	speed: 0.4436s/iter; left time: 6825.0823s
Epoch: 3 cost time: 15.102455139160156
Epoch: 3, Steps: 158 | Train Loss: 2.6440236 Vali Loss: 1.2844065 Test Loss: 0.4108918
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.6427920
	speed: 0.3876s/iter; left time: 5902.7408s
Epoch: 4 cost time: 11.0334792137146
Epoch: 4, Steps: 158 | Train Loss: 2.6210889 Vali Loss: 1.2830747 Test Loss: 0.4086544
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.6325951
	speed: 0.3840s/iter; left time: 5785.9391s
Epoch: 5 cost time: 11.699558734893799
Epoch: 5, Steps: 158 | Train Loss: 2.6085226 Vali Loss: 1.2909582 Test Loss: 0.4083571
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.5697935
	speed: 0.3859s/iter; left time: 5753.9657s
Epoch: 6 cost time: 11.7059485912323
Epoch: 6, Steps: 158 | Train Loss: 2.6017692 Vali Loss: 1.2990204 Test Loss: 0.4110812
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.5719230
	speed: 0.4143s/iter; left time: 6112.0410s
Epoch: 7 cost time: 14.0343177318573
Epoch: 7, Steps: 158 | Train Loss: 2.5979541 Vali Loss: 1.2984945 Test Loss: 0.4129834
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.6727409
	speed: 0.4175s/iter; left time: 6093.0515s
Epoch: 8 cost time: 11.017485857009888
Epoch: 8, Steps: 158 | Train Loss: 2.5962557 Vali Loss: 1.2961265 Test Loss: 0.4122752
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.6138759
	speed: 0.3835s/iter; left time: 5536.8916s
Epoch: 9 cost time: 11.482456684112549
Epoch: 9, Steps: 158 | Train Loss: 2.5951315 Vali Loss: 1.2967947 Test Loss: 0.4107551
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 2.6145697
	speed: 0.3821s/iter; left time: 5455.6030s
Epoch: 10 cost time: 11.673958778381348
Epoch: 10, Steps: 158 | Train Loss: 2.5945572 Vali Loss: 1.2965405 Test Loss: 0.4113419
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.5081763
	speed: 0.3857s/iter; left time: 5445.8491s
Epoch: 11 cost time: 11.363606691360474
Epoch: 11, Steps: 158 | Train Loss: 2.5942677 Vali Loss: 1.2953147 Test Loss: 0.4114717
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4213613271713257, mae:0.4405476152896881
rmse:0.64912348985672, mape:0.7123665809631348, mspe:36008.69140625

--- [Trial 17] 参数 ---
learning_rate=0.00056494477330573, batch_size=64, ca_layers=0, ia_layers=1, attn_dropout=0.1, n_heads=64, num_p=6, alpha=0.07702717690900983, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.9401181
	speed: 0.1092s/iter; left time: 1277.9155s
Epoch: 1 cost time: 12.972852945327759
Epoch: 1, Steps: 118 | Train Loss: 1.0103035 Vali Loss: 1.3404435 Test Loss: 0.4291825
Validation loss decreased (inf --> 1.340443).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9344840
	speed: 0.3104s/iter; left time: 3595.2516s
Epoch: 2 cost time: 10.927658796310425
Epoch: 2, Steps: 118 | Train Loss: 0.9017523 Vali Loss: 1.4121015 Test Loss: 0.4332593
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8769222
	speed: 0.2956s/iter; left time: 3388.8013s
Epoch: 3 cost time: 11.122277975082397
Epoch: 3, Steps: 118 | Train Loss: 0.8774407 Vali Loss: 1.4746081 Test Loss: 0.4278963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8394951
	speed: 0.2956s/iter; left time: 3354.2593s
Epoch: 4 cost time: 11.190818071365356
Epoch: 4, Steps: 118 | Train Loss: 0.8644438 Vali Loss: 1.5080429 Test Loss: 0.4276054
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8853059
	speed: 0.2964s/iter; left time: 3328.8316s
Epoch: 5 cost time: 10.932900190353394
Epoch: 5, Steps: 118 | Train Loss: 0.8574995 Vali Loss: 1.4709991 Test Loss: 0.4355347
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.8637658
	speed: 0.3165s/iter; left time: 3516.7188s
Epoch: 6 cost time: 13.255518436431885
Epoch: 6, Steps: 118 | Train Loss: 0.8537877 Vali Loss: 1.4780393 Test Loss: 0.4448162
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.8381554
	speed: 0.3332s/iter; left time: 3663.2580s
Epoch: 7 cost time: 13.723405122756958
Epoch: 7, Steps: 118 | Train Loss: 0.8517953 Vali Loss: 1.4718059 Test Loss: 0.4432864
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.8431857
	speed: 0.3175s/iter; left time: 3452.6743s
Epoch: 8 cost time: 11.183218002319336
Epoch: 8, Steps: 118 | Train Loss: 0.8506647 Vali Loss: 1.4748522 Test Loss: 0.4418017
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.8408939
	speed: 0.2942s/iter; left time: 3164.9064s
Epoch: 9 cost time: 11.10000467300415
Epoch: 9, Steps: 118 | Train Loss: 0.8502133 Vali Loss: 1.4756000 Test Loss: 0.4439763
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.8413318
	speed: 0.2944s/iter; left time: 3132.5563s
Epoch: 10 cost time: 10.96018934249878
Epoch: 10, Steps: 118 | Train Loss: 0.8499714 Vali Loss: 1.4760000 Test Loss: 0.4440955
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.8548819
	speed: 0.2972s/iter; left time: 3127.1272s
Epoch: 11 cost time: 11.259825468063354
Epoch: 11, Steps: 118 | Train Loss: 0.8497333 Vali Loss: 1.4798390 Test Loss: 0.4434839
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4291665852069855, mae:0.4434768557548523
rmse:0.6551080942153931, mape:0.7153131365776062, mspe:38729.98828125

--- [Trial 18] 参数 ---
learning_rate=0.00024750787674994657, batch_size=48, ca_layers=1, ia_layers=3, attn_dropout=0.05, n_heads=64, num_p=4, alpha=0.18677798592312067, d_ff_multiplier=4
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.6715064
	speed: 0.2426s/iter; left time: 3809.1275s
Epoch: 1 cost time: 38.04175782203674
Epoch: 1, Steps: 158 | Train Loss: 1.8620474 Vali Loss: 1.2789642 Test Loss: 0.4572645
Validation loss decreased (inf --> 1.278964).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6523287
	speed: 0.7005s/iter; left time: 10887.7728s
Epoch: 2 cost time: 30.10027813911438
Epoch: 2, Steps: 158 | Train Loss: 1.6450291 Vali Loss: 1.2689165 Test Loss: 0.4390002
Validation loss decreased (1.278964 --> 1.268916).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6105788
	speed: 0.6473s/iter; left time: 9958.4081s
Epoch: 3 cost time: 30.199374675750732
Epoch: 3, Steps: 158 | Train Loss: 1.6073143 Vali Loss: 1.1964262 Test Loss: 0.4198596
Validation loss decreased (1.268916 --> 1.196426).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5683169
	speed: 0.7109s/iter; left time: 10824.5426s
Epoch: 4 cost time: 37.739683389663696
Epoch: 4, Steps: 158 | Train Loss: 1.5554533 Vali Loss: 1.2548010 Test Loss: 0.4244107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5317068
	speed: 0.7023s/iter; left time: 10582.3902s
Epoch: 5 cost time: 30.332749843597412
Epoch: 5, Steps: 158 | Train Loss: 1.5373978 Vali Loss: 1.3009274 Test Loss: 0.4241804
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.5243725
	speed: 0.6484s/iter; left time: 9668.5520s
Epoch: 6 cost time: 30.210875988006592
Epoch: 6, Steps: 158 | Train Loss: 1.5288626 Vali Loss: 1.3244491 Test Loss: 0.4305796
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.4994868
	speed: 0.7114s/iter; left time: 10495.9792s
Epoch: 7 cost time: 37.49400305747986
Epoch: 7, Steps: 158 | Train Loss: 1.5245244 Vali Loss: 1.3396397 Test Loss: 0.4273272
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.5291138
	speed: 0.6985s/iter; left time: 10194.3238s
Epoch: 8 cost time: 30.338006019592285
Epoch: 8, Steps: 158 | Train Loss: 1.5222435 Vali Loss: 1.3476607 Test Loss: 0.4296814
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.5072507
	speed: 0.6489s/iter; left time: 9367.9178s
Epoch: 9 cost time: 30.236639261245728
Epoch: 9, Steps: 158 | Train Loss: 1.5211423 Vali Loss: 1.3513259 Test Loss: 0.4317685
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.5113577
	speed: 0.7065s/iter; left time: 10087.6581s
Epoch: 10 cost time: 36.58224821090698
Epoch: 10, Steps: 158 | Train Loss: 1.5205558 Vali Loss: 1.3529233 Test Loss: 0.4315364
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.5295854
	speed: 0.6882s/iter; left time: 9718.0722s
Epoch: 11 cost time: 30.181009531021118
Epoch: 11, Steps: 158 | Train Loss: 1.5203100 Vali Loss: 1.3543177 Test Loss: 0.4317653
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.5169941
	speed: 0.6441s/iter; left time: 8993.9712s
Epoch: 12 cost time: 30.186057567596436
Epoch: 12, Steps: 158 | Train Loss: 1.5201233 Vali Loss: 1.3552502 Test Loss: 0.4315932
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.5269711
	speed: 0.7059s/iter; left time: 9745.1775s
Epoch: 13 cost time: 37.88268303871155
Epoch: 13, Steps: 158 | Train Loss: 1.5200867 Vali Loss: 1.3554329 Test Loss: 0.4315390
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41985324025154114, mae:0.44143199920654297
rmse:0.6479608416557312, mape:0.7135222554206848, mspe:39374.59375

--- [Trial 19] 参数 ---
learning_rate=0.0006845632419468084, batch_size=16, ca_layers=3, ia_layers=1, attn_dropout=0.05, n_heads=8, num_p=12, alpha=0.26560797828337857, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.1695251
	speed: 0.0436s/iter; left time: 2060.9763s
	iters: 200, epoch: 1 | loss: 2.0199077
	speed: 0.0403s/iter; left time: 1903.3245s
	iters: 300, epoch: 1 | loss: 1.9317005
	speed: 0.0390s/iter; left time: 1838.8920s
	iters: 400, epoch: 1 | loss: 2.0410383
	speed: 0.0408s/iter; left time: 1917.7804s
Epoch: 1 cost time: 19.420830965042114
Epoch: 1, Steps: 474 | Train Loss: 2.0578834 Vali Loss: 1.4109998 Test Loss: 0.4358961
Validation loss decreased (inf --> 1.411000).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8639489
	speed: 0.4559s/iter; left time: 21347.4894s
	iters: 200, epoch: 2 | loss: 1.8665968
	speed: 0.0473s/iter; left time: 2207.9016s
	iters: 300, epoch: 2 | loss: 1.8814821
	speed: 0.0439s/iter; left time: 2045.1822s
	iters: 400, epoch: 2 | loss: 1.8931807
	speed: 0.0473s/iter; left time: 2202.6640s
Epoch: 2 cost time: 22.440053939819336
Epoch: 2, Steps: 474 | Train Loss: 1.8682099 Vali Loss: 1.4508427 Test Loss: 0.4845187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8311495
	speed: 0.4683s/iter; left time: 21707.8726s
	iters: 200, epoch: 3 | loss: 1.8500928
	speed: 0.0454s/iter; left time: 2098.8039s
	iters: 300, epoch: 3 | loss: 1.7058089
	speed: 0.0393s/iter; left time: 1813.2028s
	iters: 400, epoch: 3 | loss: 1.7977853
	speed: 0.0382s/iter; left time: 1759.5171s
Epoch: 3 cost time: 19.65604329109192
Epoch: 3, Steps: 474 | Train Loss: 1.7686270 Vali Loss: 1.4293046 Test Loss: 0.4873817
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.6810417
	speed: 0.4462s/iter; left time: 20470.3016s
	iters: 200, epoch: 4 | loss: 1.7563183
	speed: 0.0393s/iter; left time: 1798.6919s
	iters: 300, epoch: 4 | loss: 1.7009178
	speed: 0.0391s/iter; left time: 1785.0491s
	iters: 400, epoch: 4 | loss: 1.7390389
	speed: 0.0386s/iter; left time: 1761.5262s
Epoch: 4 cost time: 19.43916368484497
Epoch: 4, Steps: 474 | Train Loss: 1.7199470 Vali Loss: 1.4146987 Test Loss: 0.5016165
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.7197733
	speed: 0.4478s/iter; left time: 20330.7220s
	iters: 200, epoch: 5 | loss: 1.7302456
	speed: 0.0434s/iter; left time: 1964.0103s
	iters: 300, epoch: 5 | loss: 1.7774954
	speed: 0.0456s/iter; left time: 2061.0804s
	iters: 400, epoch: 5 | loss: 1.6626325
	speed: 0.0444s/iter; left time: 2003.9001s
Epoch: 5 cost time: 21.66548776626587
Epoch: 5, Steps: 474 | Train Loss: 1.6942494 Vali Loss: 1.4103758 Test Loss: 0.5224495
Validation loss decreased (1.411000 --> 1.410376).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6663092
	speed: 0.4800s/iter; left time: 21566.3434s
	iters: 200, epoch: 6 | loss: 1.7913749
	speed: 0.0373s/iter; left time: 1674.2723s
	iters: 300, epoch: 6 | loss: 1.7359762
	speed: 0.0378s/iter; left time: 1690.8090s
	iters: 400, epoch: 6 | loss: 1.6880127
	speed: 0.0390s/iter; left time: 1741.4243s
Epoch: 6 cost time: 19.022077560424805
Epoch: 6, Steps: 474 | Train Loss: 1.6809904 Vali Loss: 1.4145255 Test Loss: 0.5316690
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5959352
	speed: 0.4425s/iter; left time: 19670.8575s
	iters: 200, epoch: 7 | loss: 1.6110117
	speed: 0.0389s/iter; left time: 1724.4812s
	iters: 300, epoch: 7 | loss: 1.5692618
	speed: 0.0442s/iter; left time: 1954.5903s
	iters: 400, epoch: 7 | loss: 1.6238945
	speed: 0.0415s/iter; left time: 1830.5685s
Epoch: 7 cost time: 19.617865800857544
Epoch: 7, Steps: 474 | Train Loss: 1.6742227 Vali Loss: 1.3988088 Test Loss: 0.5307391
Validation loss decreased (1.410376 --> 1.398809).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5484509
	speed: 0.4487s/iter; left time: 19736.9257s
	iters: 200, epoch: 8 | loss: 1.6618674
	speed: 0.0473s/iter; left time: 2075.2451s
	iters: 300, epoch: 8 | loss: 1.7625868
	speed: 0.0423s/iter; left time: 1850.8556s
	iters: 400, epoch: 8 | loss: 1.6968613
	speed: 0.0428s/iter; left time: 1871.0527s
Epoch: 8 cost time: 21.870190143585205
Epoch: 8, Steps: 474 | Train Loss: 1.6703073 Vali Loss: 1.4019009 Test Loss: 0.5275280
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5884621
	speed: 0.4787s/iter; left time: 20827.7789s
	iters: 200, epoch: 9 | loss: 1.6535184
	speed: 0.0389s/iter; left time: 1688.2917s
	iters: 300, epoch: 9 | loss: 1.6108520
	speed: 0.0386s/iter; left time: 1670.6733s
	iters: 400, epoch: 9 | loss: 1.6297984
	speed: 0.0418s/iter; left time: 1804.7587s
Epoch: 9 cost time: 19.480262994766235
Epoch: 9, Steps: 474 | Train Loss: 1.6686182 Vali Loss: 1.4038935 Test Loss: 0.5301117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6759279
	speed: 0.4444s/iter; left time: 19123.7823s
	iters: 200, epoch: 10 | loss: 1.6204607
	speed: 0.0399s/iter; left time: 1712.6147s
	iters: 300, epoch: 10 | loss: 1.7022088
	speed: 0.0392s/iter; left time: 1679.2581s
	iters: 400, epoch: 10 | loss: 1.6563669
	speed: 0.0381s/iter; left time: 1628.6067s
Epoch: 10 cost time: 19.07415747642517
Epoch: 10, Steps: 474 | Train Loss: 1.6676948 Vali Loss: 1.4012090 Test Loss: 0.5333603
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6342645
	speed: 0.4574s/iter; left time: 19466.6073s
	iters: 200, epoch: 11 | loss: 1.6205190
	speed: 0.0434s/iter; left time: 1843.4986s
	iters: 300, epoch: 11 | loss: 1.7002728
	speed: 0.0469s/iter; left time: 1985.2154s
	iters: 400, epoch: 11 | loss: 1.7124764
	speed: 0.0497s/iter; left time: 2102.2077s
Epoch: 11 cost time: 22.268601894378662
Epoch: 11, Steps: 474 | Train Loss: 1.6672769 Vali Loss: 1.4038881 Test Loss: 0.5320418
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.7754986
	speed: 0.4929s/iter; left time: 20744.8550s
	iters: 200, epoch: 12 | loss: 1.6922358
	speed: 0.0376s/iter; left time: 1578.5977s
	iters: 300, epoch: 12 | loss: 1.6614170
	speed: 0.0387s/iter; left time: 1622.4199s
	iters: 400, epoch: 12 | loss: 1.6002854
	speed: 0.0391s/iter; left time: 1635.0868s
Epoch: 12 cost time: 20.377089738845825
Epoch: 12, Steps: 474 | Train Loss: 1.6669430 Vali Loss: 1.4045527 Test Loss: 0.5320803
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.6159838
	speed: 0.4479s/iter; left time: 18638.0869s
	iters: 200, epoch: 13 | loss: 1.7274621
	speed: 0.0385s/iter; left time: 1597.8184s
	iters: 300, epoch: 13 | loss: 1.8173546
	speed: 0.0368s/iter; left time: 1524.9586s
	iters: 400, epoch: 13 | loss: 1.6076509
	speed: 0.0433s/iter; left time: 1789.7783s
Epoch: 13 cost time: 19.299472093582153
Epoch: 13, Steps: 474 | Train Loss: 1.6668608 Vali Loss: 1.4046746 Test Loss: 0.5321224
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.6905681
	speed: 0.4573s/iter; left time: 18814.2712s
	iters: 200, epoch: 14 | loss: 1.6185530
	speed: 0.0491s/iter; left time: 2016.1762s
	iters: 300, epoch: 14 | loss: 1.6268415
	speed: 0.0464s/iter; left time: 1899.6454s
	iters: 400, epoch: 14 | loss: 1.6411744
	speed: 0.0460s/iter; left time: 1879.1304s
Epoch: 14 cost time: 23.384623527526855
Epoch: 14, Steps: 474 | Train Loss: 1.6667723 Vali Loss: 1.4046656 Test Loss: 0.5321372
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.6355352
	speed: 0.4920s/iter; left time: 20005.3210s
	iters: 200, epoch: 15 | loss: 1.6632669
	speed: 0.0389s/iter; left time: 1579.0809s
	iters: 300, epoch: 15 | loss: 1.7256368
	speed: 0.0420s/iter; left time: 1699.5851s
	iters: 400, epoch: 15 | loss: 1.6928403
	speed: 0.0402s/iter; left time: 1622.7494s
Epoch: 15 cost time: 20.58059787750244
Epoch: 15, Steps: 474 | Train Loss: 1.6668371 Vali Loss: 1.4041864 Test Loss: 0.5322451
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.6481950
	speed: 0.4423s/iter; left time: 17775.3851s
	iters: 200, epoch: 16 | loss: 1.7445586
	speed: 0.0424s/iter; left time: 1701.5324s
	iters: 300, epoch: 16 | loss: 1.6187055
	speed: 0.0381s/iter; left time: 1524.3407s
	iters: 400, epoch: 16 | loss: 1.7307583
	speed: 0.0403s/iter; left time: 1606.5288s
Epoch: 16 cost time: 19.372277975082397
Epoch: 16, Steps: 474 | Train Loss: 1.6666794 Vali Loss: 1.4045339 Test Loss: 0.5323246
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.5693166
	speed: 0.4508s/iter; left time: 17904.9578s
	iters: 200, epoch: 17 | loss: 1.7375872
	speed: 0.0435s/iter; left time: 1722.0496s
	iters: 300, epoch: 17 | loss: 1.5843112
	speed: 0.0434s/iter; left time: 1715.5851s
	iters: 400, epoch: 17 | loss: 1.6344650
	speed: 0.0480s/iter; left time: 1890.7152s
Epoch: 17 cost time: 22.177202463150024
Epoch: 17, Steps: 474 | Train Loss: 1.6667944 Vali Loss: 1.4042352 Test Loss: 0.5322956
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.5307435989379883, mae:0.49087217450141907
rmse:0.7285215258598328, mape:0.7603335380554199, mspe:43984.6484375

--- [Trial 20] 参数 ---
learning_rate=0.00013536381242626176, batch_size=32, ca_layers=1, ia_layers=3, attn_dropout=0.15000000000000002, n_heads=16, num_p=12, alpha=0.13327924219234474, d_ff_multiplier=4
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.3541377
	speed: 0.0800s/iter; left time: 1889.2175s
	iters: 200, epoch: 1 | loss: 1.2653365
	speed: 0.0785s/iter; left time: 1844.6892s
Epoch: 1 cost time: 18.993228673934937
Epoch: 1, Steps: 237 | Train Loss: 1.3951081 Vali Loss: 1.2959780 Test Loss: 0.4272309
Validation loss decreased (inf --> 1.295978).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2388434
	speed: 0.4493s/iter; left time: 10497.1206s
	iters: 200, epoch: 2 | loss: 1.2235248
	speed: 0.0796s/iter; left time: 1851.0750s
Epoch: 2 cost time: 19.146655082702637
Epoch: 2, Steps: 237 | Train Loss: 1.2469986 Vali Loss: 1.3449967 Test Loss: 0.4225339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2229986
	speed: 0.4713s/iter; left time: 10900.8848s
	iters: 200, epoch: 3 | loss: 1.2451591
	speed: 0.0958s/iter; left time: 2206.1570s
Epoch: 3 cost time: 23.40102791786194
Epoch: 3, Steps: 237 | Train Loss: 1.2194085 Vali Loss: 1.3400640 Test Loss: 0.4189185
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.2460747
	speed: 0.4772s/iter; left time: 10923.8940s
	iters: 200, epoch: 4 | loss: 1.2474184
	speed: 0.0763s/iter; left time: 1738.3200s
Epoch: 4 cost time: 18.73406434059143
Epoch: 4, Steps: 237 | Train Loss: 1.2050655 Vali Loss: 1.3517948 Test Loss: 0.4351202
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.2147073
	speed: 0.4443s/iter; left time: 10064.1030s
	iters: 200, epoch: 5 | loss: 1.2823962
	speed: 0.0779s/iter; left time: 1757.2312s
Epoch: 5 cost time: 18.789485692977905
Epoch: 5, Steps: 237 | Train Loss: 1.1965381 Vali Loss: 1.3793185 Test Loss: 0.4308392
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.2038243
	speed: 0.4489s/iter; left time: 10062.1332s
	iters: 200, epoch: 6 | loss: 1.2358408
	speed: 0.0809s/iter; left time: 1805.2165s
Epoch: 6 cost time: 20.00477433204651
Epoch: 6, Steps: 237 | Train Loss: 1.1922103 Vali Loss: 1.3988684 Test Loss: 0.4276513
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.1857355
	speed: 0.5624s/iter; left time: 12473.0148s
	iters: 200, epoch: 7 | loss: 1.2286881
	speed: 0.1080s/iter; left time: 2384.6390s
Epoch: 7 cost time: 25.231988430023193
Epoch: 7, Steps: 237 | Train Loss: 1.1900078 Vali Loss: 1.3962381 Test Loss: 0.4311696
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.1890877
	speed: 0.5794s/iter; left time: 12714.1152s
	iters: 200, epoch: 8 | loss: 1.1463422
	speed: 0.0779s/iter; left time: 1701.0274s
Epoch: 8 cost time: 19.32307267189026
Epoch: 8, Steps: 237 | Train Loss: 1.1889384 Vali Loss: 1.4005789 Test Loss: 0.4329324
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.1494367
	speed: 0.5304s/iter; left time: 11511.4743s
	iters: 200, epoch: 9 | loss: 1.1815596
	speed: 0.0858s/iter; left time: 1853.6644s
Epoch: 9 cost time: 21.16815948486328
Epoch: 9, Steps: 237 | Train Loss: 1.1884127 Vali Loss: 1.3993335 Test Loss: 0.4317277
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.2143277
	speed: 0.5999s/iter; left time: 12877.6070s
	iters: 200, epoch: 10 | loss: 1.1685205
	speed: 0.1047s/iter; left time: 2237.3166s
Epoch: 10 cost time: 25.937721490859985
Epoch: 10, Steps: 237 | Train Loss: 1.1881458 Vali Loss: 1.3995565 Test Loss: 0.4346072
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.1867248
	speed: 0.7823s/iter; left time: 16608.7868s
	iters: 200, epoch: 11 | loss: 1.1821551
	speed: 0.1299s/iter; left time: 2745.0234s
Epoch: 11 cost time: 33.29150986671448
Epoch: 11, Steps: 237 | Train Loss: 1.1880292 Vali Loss: 1.4022520 Test Loss: 0.4337072
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.42725324630737305, mae:0.4445520043373108
rmse:0.6536461114883423, mape:0.715405285358429, mspe:38713.38671875

--- [Trial 21] 参数 ---
learning_rate=0.00018898216410230515, batch_size=16, ca_layers=2, ia_layers=3, attn_dropout=0.0, n_heads=32, num_p=12, alpha=0.38944276101665176, d_ff_multiplier=1
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.8759439
	speed: 0.0891s/iter; left time: 4215.6367s
	iters: 200, epoch: 1 | loss: 2.7277427
	speed: 0.0776s/iter; left time: 3664.9583s
	iters: 300, epoch: 1 | loss: 2.8253717
	speed: 0.0816s/iter; left time: 3843.9817s
	iters: 400, epoch: 1 | loss: 2.7238483
	speed: 0.0817s/iter; left time: 3841.4824s
Epoch: 1 cost time: 39.241957664489746
Epoch: 1, Steps: 474 | Train Loss: 2.9205721 Vali Loss: 1.3311596 Test Loss: 0.4196481
Validation loss decreased (inf --> 1.331160).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8068783
	speed: 0.8067s/iter; left time: 37774.1654s
	iters: 200, epoch: 2 | loss: 2.6939371
	speed: 0.1084s/iter; left time: 5065.1414s
	iters: 300, epoch: 2 | loss: 2.7374518
	speed: 0.1122s/iter; left time: 5231.2101s
	iters: 400, epoch: 2 | loss: 2.7597644
	speed: 0.1077s/iter; left time: 5010.1760s
Epoch: 2 cost time: 52.81895041465759
Epoch: 2, Steps: 474 | Train Loss: 2.6992585 Vali Loss: 1.3779064 Test Loss: 0.4348636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.5699277
	speed: 1.0229s/iter; left time: 47416.4109s
	iters: 200, epoch: 3 | loss: 2.6536674
	speed: 0.1029s/iter; left time: 4758.8534s
	iters: 300, epoch: 3 | loss: 2.7015688
	speed: 0.0944s/iter; left time: 4355.6342s
	iters: 400, epoch: 3 | loss: 2.5525887
	speed: 0.0806s/iter; left time: 3713.9425s
Epoch: 3 cost time: 45.209681034088135
Epoch: 3, Steps: 474 | Train Loss: 2.6157699 Vali Loss: 1.3561326 Test Loss: 0.4312518
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.5417509
	speed: 0.8023s/iter; left time: 36810.1595s
	iters: 200, epoch: 4 | loss: 2.5876460
	speed: 0.0868s/iter; left time: 3971.9754s
	iters: 300, epoch: 4 | loss: 2.6168358
	speed: 0.0811s/iter; left time: 3702.6655s
	iters: 400, epoch: 4 | loss: 2.6435044
	speed: 0.0881s/iter; left time: 4016.0245s
Epoch: 4 cost time: 41.032676696777344
Epoch: 4, Steps: 474 | Train Loss: 2.5630255 Vali Loss: 1.4220569 Test Loss: 0.4616715
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.5334325
	speed: 0.8268s/iter; left time: 37540.2310s
	iters: 200, epoch: 5 | loss: 2.6157503
	speed: 0.1154s/iter; left time: 5228.9231s
	iters: 300, epoch: 5 | loss: 2.5042589
	speed: 0.1172s/iter; left time: 5297.2886s
	iters: 400, epoch: 5 | loss: 2.5409362
	speed: 0.1038s/iter; left time: 4683.5050s
Epoch: 5 cost time: 53.7654869556427
Epoch: 5, Steps: 474 | Train Loss: 2.5374143 Vali Loss: 1.4374295 Test Loss: 0.4575946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.3925102
	speed: 0.9389s/iter; left time: 42185.8098s
	iters: 200, epoch: 6 | loss: 2.6038241
	speed: 0.0787s/iter; left time: 3528.7537s
	iters: 300, epoch: 6 | loss: 2.6146069
	speed: 0.0785s/iter; left time: 3510.1825s
	iters: 400, epoch: 6 | loss: 2.5323560
	speed: 0.0864s/iter; left time: 3855.6837s
Epoch: 6 cost time: 39.497883796691895
Epoch: 6, Steps: 474 | Train Loss: 2.5246956 Vali Loss: 1.4415660 Test Loss: 0.4742015
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.4961176
	speed: 0.7929s/iter; left time: 35249.6256s
	iters: 200, epoch: 7 | loss: 2.4879098
	speed: 0.0865s/iter; left time: 3835.1752s
	iters: 300, epoch: 7 | loss: 2.5003314
	speed: 0.0850s/iter; left time: 3762.5007s
	iters: 400, epoch: 7 | loss: 2.4651608
	speed: 0.0874s/iter; left time: 3860.3584s
Epoch: 7 cost time: 41.954859495162964
Epoch: 7, Steps: 474 | Train Loss: 2.5185962 Vali Loss: 1.4523963 Test Loss: 0.4800020
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.3777146
	speed: 0.8831s/iter; left time: 38839.9675s
	iters: 200, epoch: 8 | loss: 2.5207880
	speed: 0.1081s/iter; left time: 4745.3797s
	iters: 300, epoch: 8 | loss: 2.4390986
	speed: 0.1096s/iter; left time: 4799.2096s
	iters: 400, epoch: 8 | loss: 2.6265004
	speed: 0.1169s/iter; left time: 5108.4295s
Epoch: 8 cost time: 54.92875289916992
Epoch: 8, Steps: 474 | Train Loss: 2.5154323 Vali Loss: 1.4436042 Test Loss: 0.4744074
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.5972705
	speed: 0.9345s/iter; left time: 40659.6356s
	iters: 200, epoch: 9 | loss: 2.4749291
	speed: 0.0906s/iter; left time: 3933.4842s
	iters: 300, epoch: 9 | loss: 2.6224651
	speed: 0.0905s/iter; left time: 3919.9949s
	iters: 400, epoch: 9 | loss: 2.5798886
	speed: 0.0895s/iter; left time: 3866.9664s
Epoch: 9 cost time: 42.36571168899536
Epoch: 9, Steps: 474 | Train Loss: 2.5138700 Vali Loss: 1.4504343 Test Loss: 0.4786393
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 2.3976004
	speed: 0.7531s/iter; left time: 32410.2890s
	iters: 200, epoch: 10 | loss: 2.5570903
	speed: 0.0943s/iter; left time: 4048.6558s
	iters: 300, epoch: 10 | loss: 2.4390297
	speed: 0.0924s/iter; left time: 3959.6710s
	iters: 400, epoch: 10 | loss: 2.5416274
	speed: 0.0953s/iter; left time: 4073.9344s
Epoch: 10 cost time: 44.84214377403259
Epoch: 10, Steps: 474 | Train Loss: 2.5129983 Vali Loss: 1.4475272 Test Loss: 0.4778584
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.4392130
	speed: 0.9440s/iter; left time: 40176.5224s
	iters: 200, epoch: 11 | loss: 2.5488162
	speed: 0.1055s/iter; left time: 4479.2144s
	iters: 300, epoch: 11 | loss: 2.5099771
	speed: 0.1148s/iter; left time: 4863.5354s
	iters: 400, epoch: 11 | loss: 2.5098751
	speed: 0.1131s/iter; left time: 4778.4627s
Epoch: 11 cost time: 52.56284999847412
Epoch: 11, Steps: 474 | Train Loss: 2.5125668 Vali Loss: 1.4475400 Test Loss: 0.4783146
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4196482300758362, mae:0.44068145751953125
rmse:0.6478025913238525, mape:0.7137125134468079, mspe:40706.1875

--- [Trial 22] 参数 ---
learning_rate=0.00019836913059310181, batch_size=16, ca_layers=0, ia_layers=3, attn_dropout=0.0, n_heads=32, num_p=12, alpha=0.29742538948962366, d_ff_multiplier=1
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.3541811
	speed: 0.0807s/iter; left time: 3817.8655s
	iters: 200, epoch: 1 | loss: 2.2555845
	speed: 0.0729s/iter; left time: 3441.6667s
	iters: 300, epoch: 1 | loss: 2.2533746
	speed: 0.0753s/iter; left time: 3548.3251s
	iters: 400, epoch: 1 | loss: 2.2455707
	speed: 0.0849s/iter; left time: 3989.5097s
Epoch: 1 cost time: 37.47851061820984
Epoch: 1, Steps: 474 | Train Loss: 2.3408873 Vali Loss: 1.3142934 Test Loss: 0.4216826
Validation loss decreased (inf --> 1.314293).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1209674
	speed: 0.7769s/iter; left time: 36381.9549s
	iters: 200, epoch: 2 | loss: 2.2476490
	speed: 0.0789s/iter; left time: 3684.5987s
	iters: 300, epoch: 2 | loss: 2.1133707
	speed: 0.0924s/iter; left time: 4308.7189s
	iters: 400, epoch: 2 | loss: 2.2222049
	speed: 0.0922s/iter; left time: 4290.4578s
Epoch: 2 cost time: 43.69390869140625
Epoch: 2, Steps: 474 | Train Loss: 2.1733079 Vali Loss: 1.3214420 Test Loss: 0.4146657
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1709673
	speed: 0.9176s/iter; left time: 42535.7569s
	iters: 200, epoch: 3 | loss: 2.1956122
	speed: 0.0693s/iter; left time: 3203.0353s
	iters: 300, epoch: 3 | loss: 2.1754122
	speed: 0.0736s/iter; left time: 3395.1179s
	iters: 400, epoch: 3 | loss: 2.1875429
	speed: 0.0740s/iter; left time: 3406.9763s
Epoch: 3 cost time: 37.32098627090454
Epoch: 3, Steps: 474 | Train Loss: 2.1273806 Vali Loss: 1.3354194 Test Loss: 0.4158421
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.0983782
	speed: 0.6456s/iter; left time: 29620.5451s
	iters: 200, epoch: 4 | loss: 2.0853934
	speed: 0.0664s/iter; left time: 3041.4083s
	iters: 300, epoch: 4 | loss: 2.0519619
	speed: 0.0698s/iter; left time: 3189.4583s
	iters: 400, epoch: 4 | loss: 2.0666177
	speed: 0.0810s/iter; left time: 3691.5317s
Epoch: 4 cost time: 34.63560652732849
Epoch: 4, Steps: 474 | Train Loss: 2.1002903 Vali Loss: 1.3443412 Test Loss: 0.4209367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.1689570
	speed: 0.6404s/iter; left time: 29075.7058s
	iters: 200, epoch: 5 | loss: 2.1995091
	speed: 0.0746s/iter; left time: 3378.6489s
	iters: 300, epoch: 5 | loss: 2.0154467
	speed: 0.0755s/iter; left time: 3411.4774s
	iters: 400, epoch: 5 | loss: 2.1204267
	speed: 0.0710s/iter; left time: 3202.4932s
Epoch: 5 cost time: 35.43316984176636
Epoch: 5, Steps: 474 | Train Loss: 2.0829846 Vali Loss: 1.3388952 Test Loss: 0.4211222
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.1226683
	speed: 0.8816s/iter; left time: 39612.4499s
	iters: 200, epoch: 6 | loss: 1.8654785
	speed: 0.0836s/iter; left time: 3748.3159s
	iters: 300, epoch: 6 | loss: 1.9972534
	speed: 0.0869s/iter; left time: 3885.4788s
	iters: 400, epoch: 6 | loss: 2.2376978
	speed: 0.0893s/iter; left time: 3986.4131s
Epoch: 6 cost time: 44.36957573890686
Epoch: 6, Steps: 474 | Train Loss: 2.0738575 Vali Loss: 1.3540303 Test Loss: 0.4149191
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.0202286
	speed: 0.8589s/iter; left time: 38184.2734s
	iters: 200, epoch: 7 | loss: 1.9475187
	speed: 0.0764s/iter; left time: 3387.1491s
	iters: 300, epoch: 7 | loss: 2.0374186
	speed: 0.0708s/iter; left time: 3134.3988s
	iters: 400, epoch: 7 | loss: 2.1747117
	speed: 0.0728s/iter; left time: 3213.6210s
Epoch: 7 cost time: 34.99638056755066
Epoch: 7, Steps: 474 | Train Loss: 2.0690835 Vali Loss: 1.3462766 Test Loss: 0.4196250
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.1224265
	speed: 0.6028s/iter; left time: 26512.8684s
	iters: 200, epoch: 8 | loss: 2.0403974
	speed: 0.0716s/iter; left time: 3142.4132s
	iters: 300, epoch: 8 | loss: 2.0591183
	speed: 0.0729s/iter; left time: 3193.7884s
	iters: 400, epoch: 8 | loss: 2.1861057
	speed: 0.0717s/iter; left time: 3132.6981s
Epoch: 8 cost time: 35.79221320152283
Epoch: 8, Steps: 474 | Train Loss: 2.0666903 Vali Loss: 1.3555443 Test Loss: 0.4189988
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.0366035
	speed: 0.6627s/iter; left time: 28832.9733s
	iters: 200, epoch: 9 | loss: 2.0716536
	speed: 0.0797s/iter; left time: 3458.0801s
	iters: 300, epoch: 9 | loss: 2.1239514
	speed: 0.0756s/iter; left time: 3275.5320s
	iters: 400, epoch: 9 | loss: 2.1016049
	speed: 0.0748s/iter; left time: 3231.2549s
Epoch: 9 cost time: 38.70553946495056
Epoch: 9, Steps: 474 | Train Loss: 2.0654140 Vali Loss: 1.3569403 Test Loss: 0.4186358
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 2.0655398
	speed: 0.7133s/iter; left time: 30696.3340s
	iters: 200, epoch: 10 | loss: 2.0115373
	speed: 0.0765s/iter; left time: 3284.5187s
	iters: 300, epoch: 10 | loss: 2.0433726
	speed: 0.0751s/iter; left time: 3218.4782s
	iters: 400, epoch: 10 | loss: 1.9500431
	speed: 0.0810s/iter; left time: 3461.0320s
Epoch: 10 cost time: 37.93627047538757
Epoch: 10, Steps: 474 | Train Loss: 2.0648603 Vali Loss: 1.3569229 Test Loss: 0.4182003
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.1106777
	speed: 0.7518s/iter; left time: 31998.4306s
	iters: 200, epoch: 11 | loss: 2.1570916
	speed: 0.0776s/iter; left time: 3294.2400s
	iters: 300, epoch: 11 | loss: 2.0446334
	speed: 0.0884s/iter; left time: 3746.6627s
	iters: 400, epoch: 11 | loss: 2.1016138
	speed: 0.0943s/iter; left time: 3984.8635s
Epoch: 11 cost time: 42.23563480377197
Epoch: 11, Steps: 474 | Train Loss: 2.0644925 Vali Loss: 1.3567871 Test Loss: 0.4189146
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4216838479042053, mae:0.44043755531311035
rmse:0.649371862411499, mape:0.7128699421882629, mspe:37760.9765625

--- [Trial 23] 参数 ---
learning_rate=0.00023807090789501245, batch_size=16, ca_layers=2, ia_layers=3, attn_dropout=0.05, n_heads=32, num_p=12, alpha=0.316285720743676, d_ff_multiplier=1
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.4279726
	speed: 0.1074s/iter; left time: 5079.8031s
	iters: 200, epoch: 1 | loss: 2.2729928
	speed: 0.1046s/iter; left time: 4938.5696s
	iters: 300, epoch: 1 | loss: 2.3731151
	speed: 0.1109s/iter; left time: 5221.8748s
	iters: 400, epoch: 1 | loss: 2.2911172
	speed: 0.1051s/iter; left time: 4940.4443s
Epoch: 1 cost time: 51.57548475265503
Epoch: 1, Steps: 474 | Train Loss: 2.4436319 Vali Loss: 1.3212657 Test Loss: 0.4185507
Validation loss decreased (inf --> 1.321266).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3579562
	speed: 1.0520s/iter; left time: 49262.8034s
	iters: 200, epoch: 2 | loss: 2.2625213
	speed: 0.1187s/iter; left time: 5544.2455s
	iters: 300, epoch: 2 | loss: 2.2897158
	speed: 0.1265s/iter; left time: 5899.7837s
	iters: 400, epoch: 2 | loss: 2.3074937
	speed: 0.1231s/iter; left time: 5729.2032s
Epoch: 2 cost time: 59.77908778190613
Epoch: 2, Steps: 474 | Train Loss: 2.2601045 Vali Loss: 1.3743087 Test Loss: 0.4389089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1276174
	speed: 1.0386s/iter; left time: 48140.0666s
	iters: 200, epoch: 3 | loss: 2.1892419
	speed: 0.0930s/iter; left time: 4300.7971s
	iters: 300, epoch: 3 | loss: 2.2570941
	speed: 0.0985s/iter; left time: 4544.1912s
	iters: 400, epoch: 3 | loss: 2.1162374
	speed: 0.0919s/iter; left time: 4232.3233s
Epoch: 3 cost time: 46.161542892456055
Epoch: 3, Steps: 474 | Train Loss: 2.1679548 Vali Loss: 1.3971298 Test Loss: 0.4450851
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.0909078
	speed: 0.9547s/iter; left time: 43798.8291s
	iters: 200, epoch: 4 | loss: 2.1474690
	speed: 0.1440s/iter; left time: 6594.3615s
	iters: 300, epoch: 4 | loss: 2.1607037
	speed: 0.1382s/iter; left time: 6311.7709s
	iters: 400, epoch: 4 | loss: 2.1744704
	speed: 0.1306s/iter; left time: 5954.2049s
Epoch: 4 cost time: 64.24799942970276
Epoch: 4, Steps: 474 | Train Loss: 2.1226755 Vali Loss: 1.4560053 Test Loss: 0.4816591
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.0924945
	speed: 1.0551s/iter; left time: 47906.4776s
	iters: 200, epoch: 5 | loss: 2.1799703
	speed: 0.0938s/iter; left time: 4251.0513s
	iters: 300, epoch: 5 | loss: 2.0825455
	speed: 0.1020s/iter; left time: 4609.0875s
	iters: 400, epoch: 5 | loss: 2.1066890
	speed: 0.1044s/iter; left time: 4709.6568s
Epoch: 5 cost time: 50.35879683494568
Epoch: 5, Steps: 474 | Train Loss: 2.1005255 Vali Loss: 1.4409168 Test Loss: 0.4773695
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.9862151
	speed: 0.8624s/iter; left time: 38748.5262s
	iters: 200, epoch: 6 | loss: 2.1311324
	speed: 0.0992s/iter; left time: 4448.6144s
	iters: 300, epoch: 6 | loss: 2.1619234
	speed: 0.0952s/iter; left time: 4259.1466s
	iters: 400, epoch: 6 | loss: 2.0887663
	speed: 0.1087s/iter; left time: 4849.7204s
Epoch: 6 cost time: 50.82804036140442
Epoch: 6, Steps: 474 | Train Loss: 2.0888814 Vali Loss: 1.4445261 Test Loss: 0.4887573
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.0623529
	speed: 1.0646s/iter; left time: 47330.8586s
	iters: 200, epoch: 7 | loss: 2.0597951
	speed: 0.1054s/iter; left time: 4677.1687s
	iters: 300, epoch: 7 | loss: 2.0763750
	speed: 0.1121s/iter; left time: 4963.1156s
	iters: 400, epoch: 7 | loss: 2.0204329
	speed: 0.1235s/iter; left time: 5452.9711s
Epoch: 7 cost time: 54.82270622253418
Epoch: 7, Steps: 474 | Train Loss: 2.0832266 Vali Loss: 1.4428476 Test Loss: 0.4904182
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.9692998
	speed: 0.9585s/iter; left time: 42158.2656s
	iters: 200, epoch: 8 | loss: 2.0773568
	speed: 0.0996s/iter; left time: 4372.0782s
	iters: 300, epoch: 8 | loss: 2.0150676
	speed: 0.0986s/iter; left time: 4316.2903s
	iters: 400, epoch: 8 | loss: 2.1813128
	speed: 0.1076s/iter; left time: 4698.2803s
Epoch: 8 cost time: 49.44403052330017
Epoch: 8, Steps: 474 | Train Loss: 2.0802731 Vali Loss: 1.4351960 Test Loss: 0.4876103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.1475065
	speed: 0.9468s/iter; left time: 41195.7960s
	iters: 200, epoch: 9 | loss: 2.0496459
	speed: 0.1209s/iter; left time: 5246.1987s
	iters: 300, epoch: 9 | loss: 2.1778734
	speed: 0.0976s/iter; left time: 4228.0369s
	iters: 400, epoch: 9 | loss: 2.1478670
	speed: 0.1003s/iter; left time: 4335.3681s
Epoch: 9 cost time: 52.138768672943115
Epoch: 9, Steps: 474 | Train Loss: 2.0789555 Vali Loss: 1.4462496 Test Loss: 0.4916791
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.9675617
	speed: 0.9571s/iter; left time: 41189.8044s
	iters: 200, epoch: 10 | loss: 2.1182947
	speed: 0.1038s/iter; left time: 4457.7090s
	iters: 300, epoch: 10 | loss: 2.0072789
	speed: 0.1118s/iter; left time: 4787.3105s
	iters: 400, epoch: 10 | loss: 2.0977218
	speed: 0.1133s/iter; left time: 4842.8535s
Epoch: 10 cost time: 52.78121995925903
Epoch: 10, Steps: 474 | Train Loss: 2.0777780 Vali Loss: 1.4408383 Test Loss: 0.4916466
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.0165408
	speed: 1.0215s/iter; left time: 43475.6604s
	iters: 200, epoch: 11 | loss: 2.1138690
	speed: 0.1139s/iter; left time: 4837.6349s
	iters: 300, epoch: 11 | loss: 2.0791693
	speed: 0.1148s/iter; left time: 4862.6630s
	iters: 400, epoch: 11 | loss: 2.0765336
	speed: 0.1265s/iter; left time: 5347.8397s
Epoch: 11 cost time: 56.46904897689819
Epoch: 11, Steps: 474 | Train Loss: 2.0776890 Vali Loss: 1.4364965 Test Loss: 0.4916395
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4185522496700287, mae:0.4401561915874481
rmse:0.6469561457633972, mape:0.7131683230400085, mspe:40729.546875

--- [Trial 24] 参数 ---
learning_rate=0.0002772607105987851, batch_size=16, ca_layers=2, ia_layers=3, attn_dropout=0.1, n_heads=32, num_p=12, alpha=0.21370565203086536, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.7504349
	speed: 0.1125s/iter; left time: 5323.0047s
	iters: 200, epoch: 1 | loss: 1.7906013
	speed: 0.1064s/iter; left time: 5021.8890s
	iters: 300, epoch: 1 | loss: 1.6463177
	speed: 0.1023s/iter; left time: 4820.6761s
	iters: 400, epoch: 1 | loss: 1.6866068
	speed: 0.0919s/iter; left time: 4317.9370s
Epoch: 1 cost time: 48.51396584510803
