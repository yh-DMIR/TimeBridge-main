
--- [Trial 0] 参数 ---
learning_rate=0.0005584191383136332, batch_size=32, attn_dropout=0.05, n_heads=16, num_p=8, alpha=0.0786973031551312, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.9107264
	speed: 0.1168s/iter; left time: 2757.7112s
	iters: 200, epoch: 1 | loss: 0.9016541
	speed: 0.0635s/iter; left time: 1493.4753s
Epoch: 1 cost time: 20.474687337875366
Epoch: 1, Steps: 237 | Train Loss: 0.9704032 Vali Loss: 1.3390069 Test Loss: 0.4292704
Validation loss decreased (inf --> 1.339007).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8749614
	speed: 0.4815s/iter; left time: 11249.9802s
	iters: 200, epoch: 2 | loss: 0.8788155
	speed: 0.0639s/iter; left time: 1487.7251s
Epoch: 2 cost time: 15.95042634010315
Epoch: 2, Steps: 237 | Train Loss: 0.8898968 Vali Loss: 1.3968763 Test Loss: 0.4322741
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8111192
	speed: 0.5801s/iter; left time: 13416.7595s
	iters: 200, epoch: 3 | loss: 0.8508154
	speed: 0.1203s/iter; left time: 2769.0961s
Epoch: 3 cost time: 28.581287384033203
Epoch: 3, Steps: 237 | Train Loss: 0.8529765 Vali Loss: 1.3801328 Test Loss: 0.4507407
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8702002
	speed: 0.5771s/iter; left time: 13210.7983s
	iters: 200, epoch: 4 | loss: 0.8414233
	speed: 0.0614s/iter; left time: 1400.1916s
Epoch: 4 cost time: 17.163841009140015
Epoch: 4, Steps: 237 | Train Loss: 0.8296563 Vali Loss: 1.4057295 Test Loss: 0.4733863
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8585458
	speed: 0.4620s/iter; left time: 10466.3387s
	iters: 200, epoch: 5 | loss: 0.8331556
	speed: 0.0676s/iter; left time: 1524.1872s
Epoch: 5 cost time: 16.10805082321167
Epoch: 5, Steps: 237 | Train Loss: 0.8171474 Vali Loss: 1.4435203 Test Loss: 0.4762043
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.8372198
	speed: 0.5164s/iter; left time: 11576.3078s
	iters: 200, epoch: 6 | loss: 0.7992743
	speed: 0.0632s/iter; left time: 1410.3162s
Epoch: 6 cost time: 18.220277309417725
Epoch: 6, Steps: 237 | Train Loss: 0.8108988 Vali Loss: 1.4517617 Test Loss: 0.4882337
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7691895
	speed: 0.5722s/iter; left time: 12691.5694s
	iters: 200, epoch: 7 | loss: 0.7836223
	speed: 0.0659s/iter; left time: 1455.5283s
Epoch: 7 cost time: 16.458523273468018
Epoch: 7, Steps: 237 | Train Loss: 0.8076788 Vali Loss: 1.4523902 Test Loss: 0.4855850
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.8292501
	speed: 0.5138s/iter; left time: 11273.8937s
	iters: 200, epoch: 8 | loss: 0.8182740
	speed: 0.1038s/iter; left time: 2266.7904s
Epoch: 8 cost time: 22.317047834396362
Epoch: 8, Steps: 237 | Train Loss: 0.8060738 Vali Loss: 1.4559219 Test Loss: 0.4875901
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7709142
	speed: 0.4968s/iter; left time: 10782.1864s
	iters: 200, epoch: 9 | loss: 0.7977316
	speed: 0.0674s/iter; left time: 1456.3387s
Epoch: 9 cost time: 16.426625728607178
Epoch: 9, Steps: 237 | Train Loss: 0.8052419 Vali Loss: 1.4555112 Test Loss: 0.4916731
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7593237
	speed: 0.5637s/iter; left time: 12101.0972s
	iters: 200, epoch: 10 | loss: 0.8180584
	speed: 0.1391s/iter; left time: 2971.6859s
Epoch: 10 cost time: 33.20007920265198
Epoch: 10, Steps: 237 | Train Loss: 0.8047687 Vali Loss: 1.4570743 Test Loss: 0.4915577
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.8151108
	speed: 0.5241s/iter; left time: 11126.1645s
	iters: 200, epoch: 11 | loss: 0.8199680
	speed: 0.0627s/iter; left time: 1324.4607s
Epoch: 11 cost time: 15.233317136764526
Epoch: 11, Steps: 237 | Train Loss: 0.8047758 Vali Loss: 1.4587893 Test Loss: 0.4915828
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4292677342891693, mae:0.4448743164539337
rmse:0.6551852822303772, mape:0.7172968983650208, mspe:37435.96484375

--- [Trial 1] 参数 ---
learning_rate=0.0002963200203977718, batch_size=32, attn_dropout=0.15000000000000002, n_heads=64, num_p=12, alpha=0.0885018627080446, d_ff_multiplier=4
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.0087957
	speed: 0.1413s/iter; left time: 3334.7470s
	iters: 200, epoch: 1 | loss: 1.0075516
	speed: 0.1449s/iter; left time: 3405.1259s
Epoch: 1 cost time: 36.25690698623657
Epoch: 1, Steps: 237 | Train Loss: 1.0504520 Vali Loss: 1.3096107 Test Loss: 0.4239922
Validation loss decreased (inf --> 1.309611).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9939275
	speed: 0.7852s/iter; left time: 18345.2032s
	iters: 200, epoch: 2 | loss: 0.9974860
	speed: 0.1377s/iter; left time: 3202.8731s
Epoch: 2 cost time: 33.481826066970825
Epoch: 2, Steps: 237 | Train Loss: 0.9652943 Vali Loss: 1.3518310 Test Loss: 0.4433733
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9370837
	speed: 0.6564s/iter; left time: 15181.3435s
	iters: 200, epoch: 3 | loss: 0.9164637
	speed: 0.1354s/iter; left time: 3117.1284s
Epoch: 3 cost time: 32.46243929862976
Epoch: 3, Steps: 237 | Train Loss: 0.9344987 Vali Loss: 1.4180108 Test Loss: 0.4359136
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9205730
	speed: 0.6429s/iter; left time: 14715.5909s
	iters: 200, epoch: 4 | loss: 0.9344248
	speed: 0.1406s/iter; left time: 3204.4533s
Epoch: 4 cost time: 34.714613914489746
Epoch: 4, Steps: 237 | Train Loss: 0.9157683 Vali Loss: 1.4148053 Test Loss: 0.4528038
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8822225
	speed: 0.7739s/iter; left time: 17532.2080s
	iters: 200, epoch: 5 | loss: 0.9390913
	speed: 0.1403s/iter; left time: 3164.0055s
Epoch: 5 cost time: 38.90199327468872
Epoch: 5, Steps: 237 | Train Loss: 0.9056890 Vali Loss: 1.4136767 Test Loss: 0.4584289
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.8778043
	speed: 0.6228s/iter; left time: 13959.8055s
	iters: 200, epoch: 6 | loss: 0.8942912
	speed: 0.2239s/iter; left time: 4997.6220s
Epoch: 6 cost time: 47.99080967903137
Epoch: 6, Steps: 237 | Train Loss: 0.9007968 Vali Loss: 1.4347707 Test Loss: 0.4658257
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.8868498
	speed: 0.5708s/iter; left time: 12658.7929s
	iters: 200, epoch: 7 | loss: 0.9354195
	speed: 0.2409s/iter; left time: 5319.3686s
Epoch: 7 cost time: 49.34826469421387
Epoch: 7, Steps: 237 | Train Loss: 0.8981958 Vali Loss: 1.4285070 Test Loss: 0.4716911
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.8990261
	speed: 0.7086s/iter; left time: 15548.3181s
	iters: 200, epoch: 8 | loss: 0.8905896
	speed: 0.1404s/iter; left time: 3065.5348s
Epoch: 8 cost time: 33.62578725814819
Epoch: 8, Steps: 237 | Train Loss: 0.8969702 Vali Loss: 1.4268086 Test Loss: 0.4687792
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.8710375
	speed: 0.6512s/iter; left time: 14133.3790s
	iters: 200, epoch: 9 | loss: 0.8868476
	speed: 0.1407s/iter; left time: 3038.9357s
Epoch: 9 cost time: 33.97158169746399
Epoch: 9, Steps: 237 | Train Loss: 0.8963002 Vali Loss: 1.4311305 Test Loss: 0.4713536
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.8883258
	speed: 0.7678s/iter; left time: 16483.0360s
	iters: 200, epoch: 10 | loss: 0.8568965
	speed: 0.1965s/iter; left time: 4198.7750s
Epoch: 10 cost time: 47.49143958091736
Epoch: 10, Steps: 237 | Train Loss: 0.8959934 Vali Loss: 1.4244579 Test Loss: 0.4718594
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.8640369
	speed: 0.6499s/iter; left time: 13797.0082s
	iters: 200, epoch: 11 | loss: 0.9441611
	speed: 0.1337s/iter; left time: 2825.8500s
Epoch: 11 cost time: 34.17813467979431
Epoch: 11, Steps: 237 | Train Loss: 0.8958394 Vali Loss: 1.4272741 Test Loss: 0.4708990
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.42398956418037415, mae:0.4409375786781311
rmse:0.651144802570343, mape:0.712717592716217, mspe:37095.6484375

--- [Trial 2] 参数 ---
learning_rate=0.0005936526372316793, batch_size=48, attn_dropout=0.25, n_heads=32, num_p=12, alpha=0.08197224989678534, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.9671013
	speed: 0.1350s/iter; left time: 2119.0940s
Epoch: 1 cost time: 22.408318042755127
Epoch: 1, Steps: 158 | Train Loss: 0.9943362 Vali Loss: 1.2822039 Test Loss: 0.4131322
Validation loss decreased (inf --> 1.282204).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9447377
	speed: 0.7516s/iter; left time: 11682.6712s
Epoch: 2 cost time: 22.51343083381653
Epoch: 2, Steps: 158 | Train Loss: 0.9179674 Vali Loss: 1.3554269 Test Loss: 0.4290573
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8521658
	speed: 0.5563s/iter; left time: 8558.0811s
Epoch: 3 cost time: 21.04027032852173
Epoch: 3, Steps: 158 | Train Loss: 0.8879784 Vali Loss: 1.3765218 Test Loss: 0.4367784
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8699652
	speed: 0.5771s/iter; left time: 8787.0489s
Epoch: 4 cost time: 19.834775924682617
Epoch: 4, Steps: 158 | Train Loss: 0.8678761 Vali Loss: 1.4423324 Test Loss: 0.4533219
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8604883
	speed: 0.7645s/iter; left time: 11520.6168s
Epoch: 5 cost time: 21.421250581741333
Epoch: 5, Steps: 158 | Train Loss: 0.8564536 Vali Loss: 1.4070030 Test Loss: 0.4779157
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.8420159
	speed: 0.6999s/iter; left time: 10436.2729s
Epoch: 6 cost time: 27.261537790298462
Epoch: 6, Steps: 158 | Train Loss: 0.8503751 Vali Loss: 1.4130292 Test Loss: 0.5001572
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.8376138
	speed: 0.5575s/iter; left time: 8224.5372s
Epoch: 7 cost time: 26.396767377853394
Epoch: 7, Steps: 158 | Train Loss: 0.8473041 Vali Loss: 1.4146627 Test Loss: 0.4848311
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.8772513
	speed: 0.7848s/iter; left time: 11454.8611s
Epoch: 8 cost time: 31.7479145526886
Epoch: 8, Steps: 158 | Train Loss: 0.8457617 Vali Loss: 1.4162596 Test Loss: 0.4950511
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.8499626
	speed: 0.7538s/iter; left time: 10882.3516s
Epoch: 9 cost time: 20.00438928604126
Epoch: 9, Steps: 158 | Train Loss: 0.8448451 Vali Loss: 1.4263792 Test Loss: 0.4921904
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.8549533
	speed: 0.6581s/iter; left time: 9397.3761s
Epoch: 10 cost time: 34.3903329372406
Epoch: 10, Steps: 158 | Train Loss: 0.8445537 Vali Loss: 1.4256258 Test Loss: 0.4937339
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.8138331
	speed: 0.6430s/iter; left time: 9079.8415s
Epoch: 11 cost time: 22.36370038986206
Epoch: 11, Steps: 158 | Train Loss: 0.8443421 Vali Loss: 1.4204726 Test Loss: 0.4924487
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41312819719314575, mae:0.4318600296974182
rmse:0.6427505016326904, mape:0.703590452671051, mspe:37569.99609375

--- [Trial 3] 参数 ---
learning_rate=0.00014666854681138054, batch_size=64, attn_dropout=0.2, n_heads=8, num_p=8, alpha=0.09608799159129362, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.0873801
	speed: 0.1160s/iter; left time: 1357.8556s
Epoch: 1 cost time: 14.693235397338867
Epoch: 1, Steps: 118 | Train Loss: 1.2652766 Vali Loss: 1.2653525 Test Loss: 0.4438765
Validation loss decreased (inf --> 1.265352).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0477331
	speed: 0.6041s/iter; left time: 6997.0241s
Epoch: 2 cost time: 12.362411260604858
Epoch: 2, Steps: 118 | Train Loss: 1.0527114 Vali Loss: 1.2648029 Test Loss: 0.4190620
Validation loss decreased (1.265352 --> 1.264803).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0117873
	speed: 0.5764s/iter; left time: 6608.7756s
Epoch: 3 cost time: 20.801950216293335
Epoch: 3, Steps: 118 | Train Loss: 1.0283868 Vali Loss: 1.2809319 Test Loss: 0.4190263
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0323156
	speed: 0.5718s/iter; left time: 6488.3903s
Epoch: 4 cost time: 11.738755702972412
Epoch: 4, Steps: 118 | Train Loss: 1.0195829 Vali Loss: 1.2842724 Test Loss: 0.4198147
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.0740855
	speed: 0.5645s/iter; left time: 6339.1276s
Epoch: 5 cost time: 11.507957935333252
Epoch: 5, Steps: 118 | Train Loss: 1.0153332 Vali Loss: 1.2834020 Test Loss: 0.4186090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.9824431
	speed: 0.4877s/iter; left time: 5419.2700s
Epoch: 6 cost time: 16.17418885231018
Epoch: 6, Steps: 118 | Train Loss: 1.0133209 Vali Loss: 1.2829241 Test Loss: 0.4173793
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.0002331
	speed: 0.6301s/iter; left time: 6926.8560s
Epoch: 7 cost time: 19.100935459136963
Epoch: 7, Steps: 118 | Train Loss: 1.0122153 Vali Loss: 1.2890612 Test Loss: 0.4173153
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.0268276
	speed: 0.6407s/iter; left time: 6968.0536s
Epoch: 8 cost time: 14.999509811401367
Epoch: 8, Steps: 118 | Train Loss: 1.0115898 Vali Loss: 1.2911507 Test Loss: 0.4175223
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.0008126
	speed: 0.4836s/iter; left time: 5201.8514s
Epoch: 9 cost time: 12.812738418579102
Epoch: 9, Steps: 118 | Train Loss: 1.0113811 Vali Loss: 1.2884874 Test Loss: 0.4175028
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.0217599
	speed: 0.5948s/iter; left time: 6327.7951s
Epoch: 10 cost time: 12.57305121421814
Epoch: 10, Steps: 118 | Train Loss: 1.0112281 Vali Loss: 1.2879205 Test Loss: 0.4174818
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.0237553
	speed: 0.5651s/iter; left time: 5945.5781s
Epoch: 11 cost time: 17.40978193283081
Epoch: 11, Steps: 118 | Train Loss: 1.0110979 Vali Loss: 1.2863754 Test Loss: 0.4175059
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.9724044
	speed: 0.5267s/iter; left time: 5479.1501s
Epoch: 12 cost time: 19.453441858291626
Epoch: 12, Steps: 118 | Train Loss: 1.0112037 Vali Loss: 1.2902887 Test Loss: 0.4174609
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4190564453601837, mae:0.4393138587474823
rmse:0.6473457217216492, mape:0.7110181450843811, mspe:35436.96875

--- [Trial 4] 参数 ---
learning_rate=0.00010447881487398033, batch_size=48, attn_dropout=0.25, n_heads=8, num_p=4, alpha=0.32264279677927543, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.6860602
	speed: 0.0792s/iter; left time: 1243.2237s
Epoch: 1 cost time: 12.530571222305298
Epoch: 1, Steps: 158 | Train Loss: 3.2039258 Vali Loss: 1.3482974 Test Loss: 0.5268444
Validation loss decreased (inf --> 1.348297).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5134106
	speed: 0.6701s/iter; left time: 10415.4684s
Epoch: 2 cost time: 18.522258281707764
Epoch: 2, Steps: 158 | Train Loss: 2.5271439 Vali Loss: 1.2952445 Test Loss: 0.4780414
Validation loss decreased (1.348297 --> 1.295244).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4319134
	speed: 0.6004s/iter; left time: 9237.3816s
Epoch: 3 cost time: 17.380126953125
Epoch: 3, Steps: 158 | Train Loss: 2.4740547 Vali Loss: 1.2778558 Test Loss: 0.4552996
Validation loss decreased (1.295244 --> 1.277856).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4212034
	speed: 0.5348s/iter; left time: 8143.3292s
Epoch: 4 cost time: 19.407315492630005
Epoch: 4, Steps: 158 | Train Loss: 2.4581167 Vali Loss: 1.2760525 Test Loss: 0.4524560
Validation loss decreased (1.277856 --> 1.276052).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4613538
	speed: 0.5302s/iter; left time: 7989.4290s
Epoch: 5 cost time: 12.714217185974121
Epoch: 5, Steps: 158 | Train Loss: 2.4531927 Vali Loss: 1.2748549 Test Loss: 0.4516480
Validation loss decreased (1.276052 --> 1.274855).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4944568
	speed: 0.6501s/iter; left time: 9694.2767s
Epoch: 6 cost time: 13.226308822631836
Epoch: 6, Steps: 158 | Train Loss: 2.4506867 Vali Loss: 1.2744292 Test Loss: 0.4511825
Validation loss decreased (1.274855 --> 1.274429).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4986999
	speed: 0.5717s/iter; left time: 8434.7655s
Epoch: 7 cost time: 13.275680541992188
Epoch: 7, Steps: 158 | Train Loss: 2.4493590 Vali Loss: 1.2745984 Test Loss: 0.4510940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.5524421
	speed: 0.5667s/iter; left time: 8270.9938s
Epoch: 8 cost time: 12.239681959152222
Epoch: 8, Steps: 158 | Train Loss: 2.4486832 Vali Loss: 1.2742276 Test Loss: 0.4509698
Validation loss decreased (1.274429 --> 1.274228).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.4481120
	speed: 0.5821s/iter; left time: 8404.0532s
Epoch: 9 cost time: 14.369211673736572
Epoch: 9, Steps: 158 | Train Loss: 2.4483564 Vali Loss: 1.2734612 Test Loss: 0.4508938
Validation loss decreased (1.274228 --> 1.273461).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.4687665
	speed: 0.6467s/iter; left time: 9233.6907s
Epoch: 10 cost time: 19.53205943107605
Epoch: 10, Steps: 158 | Train Loss: 2.4480453 Vali Loss: 1.2739322 Test Loss: 0.4508615
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.4263370
	speed: 0.5606s/iter; left time: 7916.2627s
Epoch: 11 cost time: 20.436822175979614
Epoch: 11, Steps: 158 | Train Loss: 2.4480720 Vali Loss: 1.2744207 Test Loss: 0.4508724
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.4472265
	speed: 0.5622s/iter; left time: 7849.3843s
Epoch: 12 cost time: 14.593645334243774
Epoch: 12, Steps: 158 | Train Loss: 2.4479737 Vali Loss: 1.2741964 Test Loss: 0.4508025
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.4568520
	speed: 0.6537s/iter; left time: 9023.9358s
Epoch: 13 cost time: 18.611108541488647
Epoch: 13, Steps: 158 | Train Loss: 2.4479957 Vali Loss: 1.2743820 Test Loss: 0.4507804
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.3605890
	speed: 0.5942s/iter; left time: 8109.5089s
Epoch: 14 cost time: 11.574973344802856
Epoch: 14, Steps: 158 | Train Loss: 2.4479982 Vali Loss: 1.2733415 Test Loss: 0.4508051
Validation loss decreased (1.273461 --> 1.273342).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.4458101
	speed: 0.4823s/iter; left time: 6505.8078s
Epoch: 15 cost time: 12.889244079589844
Epoch: 15, Steps: 158 | Train Loss: 2.4479348 Vali Loss: 1.2740604 Test Loss: 0.4507992
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.5023258
	speed: 0.5421s/iter; left time: 7226.3250s
Epoch: 16 cost time: 14.016867637634277
Epoch: 16, Steps: 158 | Train Loss: 2.4478342 Vali Loss: 1.2734210 Test Loss: 0.4508042
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.4857888
	speed: 0.6062s/iter; left time: 7985.5503s
Epoch: 17 cost time: 19.760825634002686
Epoch: 17, Steps: 158 | Train Loss: 2.4480094 Vali Loss: 1.2741014 Test Loss: 0.4507874
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 2.4723303
	speed: 0.5151s/iter; left time: 6703.8718s
Epoch: 18 cost time: 11.377547264099121
Epoch: 18, Steps: 158 | Train Loss: 2.4478429 Vali Loss: 1.2736772 Test Loss: 0.4508174
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 2.4466298
	speed: 0.4946s/iter; left time: 6358.8252s
Epoch: 19 cost time: 15.817557334899902
Epoch: 19, Steps: 158 | Train Loss: 2.4479344 Vali Loss: 1.2744294 Test Loss: 0.4507705
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 2.4642806
	speed: 0.4985s/iter; left time: 6330.0999s
Epoch: 20 cost time: 12.713923454284668
Epoch: 20, Steps: 158 | Train Loss: 2.4479411 Vali Loss: 1.2741609 Test Loss: 0.4507940
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 2.4578695
	speed: 0.6548s/iter; left time: 8211.7314s
Epoch: 21 cost time: 15.873398065567017
Epoch: 21, Steps: 158 | Train Loss: 2.4478835 Vali Loss: 1.2735392 Test Loss: 0.4508013
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 2.3971608
	speed: 0.4873s/iter; left time: 6034.3506s
Epoch: 22 cost time: 14.182806015014648
Epoch: 22, Steps: 158 | Train Loss: 2.4478532 Vali Loss: 1.2742716 Test Loss: 0.4508505
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 2.3927002
	speed: 0.5219s/iter; left time: 6380.3713s
Epoch: 23 cost time: 12.452733039855957
Epoch: 23, Steps: 158 | Train Loss: 2.4479162 Vali Loss: 1.2742825 Test Loss: 0.4508271
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 2.4476473
	speed: 0.4856s/iter; left time: 5859.8235s
Epoch: 24 cost time: 15.763390302658081
Epoch: 24, Steps: 158 | Train Loss: 2.4479005 Vali Loss: 1.2742959 Test Loss: 0.4508206
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4508131742477417, mae:0.46908313035964966
rmse:0.6714262366294861, mape:0.7521635293960571, mspe:37199.3359375

--- [Trial 5] 参数 ---
learning_rate=0.00021298465478095555, batch_size=64, attn_dropout=0.0, n_heads=8, num_p=6, alpha=0.13853101513510982, d_ff_multiplier=4
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.3878347
	speed: 0.1421s/iter; left time: 1663.2445s
Epoch: 1 cost time: 16.825603246688843
Epoch: 1, Steps: 118 | Train Loss: 1.5533602 Vali Loss: 1.2807475 Test Loss: 0.4575928
Validation loss decreased (inf --> 1.280748).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3514010
	speed: 0.4928s/iter; left time: 5707.6087s
Epoch: 2 cost time: 12.639959335327148
Epoch: 2, Steps: 118 | Train Loss: 1.3586730 Vali Loss: 1.2679762 Test Loss: 0.4513094
Validation loss decreased (1.280748 --> 1.267976).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3352327
	speed: 0.5155s/iter; left time: 5909.9196s
Epoch: 3 cost time: 18.082863092422485
Epoch: 3, Steps: 118 | Train Loss: 1.3273786 Vali Loss: 1.2225400 Test Loss: 0.4247234
Validation loss decreased (1.267976 --> 1.222540).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2712355
	speed: 0.5904s/iter; left time: 6699.5806s
Epoch: 4 cost time: 12.665978908538818
Epoch: 4, Steps: 118 | Train Loss: 1.2878690 Vali Loss: 1.2481608 Test Loss: 0.4222215
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3093193
	speed: 0.4904s/iter; left time: 5506.8402s
Epoch: 5 cost time: 13.54210901260376
Epoch: 5, Steps: 118 | Train Loss: 1.2756833 Vali Loss: 1.2573354 Test Loss: 0.4201744
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.2133436
	speed: 0.4709s/iter; left time: 5231.9779s
Epoch: 6 cost time: 13.516603469848633
Epoch: 6, Steps: 118 | Train Loss: 1.2705115 Vali Loss: 1.2629855 Test Loss: 0.4154944
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.3090425
	speed: 0.5952s/iter; left time: 6543.1770s
Epoch: 7 cost time: 19.429449558258057
Epoch: 7, Steps: 118 | Train Loss: 1.2680104 Vali Loss: 1.2676278 Test Loss: 0.4172134
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.2933898
	speed: 0.5685s/iter; left time: 6182.5612s
Epoch: 8 cost time: 16.811293601989746
Epoch: 8, Steps: 118 | Train Loss: 1.2669503 Vali Loss: 1.2683828 Test Loss: 0.4171729
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.2491523
	speed: 0.4830s/iter; left time: 5195.8917s
Epoch: 9 cost time: 12.456389904022217
Epoch: 9, Steps: 118 | Train Loss: 1.2659593 Vali Loss: 1.2708389 Test Loss: 0.4172747
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.2480732
	speed: 0.5018s/iter; left time: 5339.1488s
Epoch: 10 cost time: 15.672261714935303
Epoch: 10, Steps: 118 | Train Loss: 1.2660076 Vali Loss: 1.2702680 Test Loss: 0.4172540
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.2503265
	speed: 0.5552s/iter; left time: 5841.3436s
Epoch: 11 cost time: 12.857656240463257
Epoch: 11, Steps: 118 | Train Loss: 1.2656301 Vali Loss: 1.2695311 Test Loss: 0.4173240
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.2496891
	speed: 0.4979s/iter; left time: 5179.9936s
Epoch: 12 cost time: 12.692115545272827
Epoch: 12, Steps: 118 | Train Loss: 1.2656167 Vali Loss: 1.2699308 Test Loss: 0.4173557
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.2676343
	speed: 0.4977s/iter; left time: 5119.0636s
Epoch: 13 cost time: 15.575156927108765
Epoch: 13, Steps: 118 | Train Loss: 1.2655549 Vali Loss: 1.2706691 Test Loss: 0.4173439
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.42471233010292053, mae:0.44295650720596313
rmse:0.6516995429992676, mape:0.712662398815155, mspe:37492.1015625

--- [Trial 6] 参数 ---
learning_rate=0.0004125551885269476, batch_size=48, attn_dropout=0.05, n_heads=64, num_p=4, alpha=0.05254525977077754, d_ff_multiplier=4
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.8893009
	speed: 0.1854s/iter; left time: 2911.4321s
Epoch: 1 cost time: 29.36676549911499
Epoch: 1, Steps: 158 | Train Loss: 0.9015169 Vali Loss: 1.2103935 Test Loss: 0.4283139
Validation loss decreased (inf --> 1.210394).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7713454
	speed: 0.7689s/iter; left time: 11951.3711s
Epoch: 2 cost time: 38.288970947265625
Epoch: 2, Steps: 158 | Train Loss: 0.7739214 Vali Loss: 1.4169637 Test Loss: 0.4312823
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7624575
	speed: 0.7425s/iter; left time: 11423.8888s
Epoch: 3 cost time: 43.76880145072937
Epoch: 3, Steps: 158 | Train Loss: 0.7366869 Vali Loss: 1.4194624 Test Loss: 0.4502699
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7378150
	speed: 0.8434s/iter; left time: 12842.4361s
Epoch: 4 cost time: 41.05836009979248
Epoch: 4, Steps: 158 | Train Loss: 0.7196216 Vali Loss: 1.4633338 Test Loss: 0.4635526
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.7222825
	speed: 0.7421s/iter; left time: 11183.1960s
Epoch: 5 cost time: 35.13275718688965
Epoch: 5, Steps: 158 | Train Loss: 0.7093937 Vali Loss: 1.4627260 Test Loss: 0.4715903
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7056592
	speed: 0.7560s/iter; left time: 11273.2994s
Epoch: 6 cost time: 30.554590940475464
Epoch: 6, Steps: 158 | Train Loss: 0.7041416 Vali Loss: 1.4669601 Test Loss: 0.4786225
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7376017
	speed: 0.7465s/iter; left time: 11013.6573s
Epoch: 7 cost time: 29.907681465148926
Epoch: 7, Steps: 158 | Train Loss: 0.7015316 Vali Loss: 1.4892397 Test Loss: 0.4844882
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.7130907
	speed: 0.7347s/iter; left time: 10722.2892s
Epoch: 8 cost time: 29.586440801620483
Epoch: 8, Steps: 158 | Train Loss: 0.7002096 Vali Loss: 1.4917556 Test Loss: 0.4857924
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7147162
	speed: 0.8466s/iter; left time: 12222.7907s
Epoch: 9 cost time: 41.65778088569641
Epoch: 9, Steps: 158 | Train Loss: 0.6994453 Vali Loss: 1.4843600 Test Loss: 0.4904136
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6897464
	speed: 0.7867s/iter; left time: 11233.7196s
Epoch: 10 cost time: 36.19705510139465
Epoch: 10, Steps: 158 | Train Loss: 0.6990420 Vali Loss: 1.4809166 Test Loss: 0.4877408
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6728780
	speed: 0.7764s/iter; left time: 10963.0828s
Epoch: 11 cost time: 41.50105810165405
Epoch: 11, Steps: 158 | Train Loss: 0.6989175 Vali Loss: 1.4835259 Test Loss: 0.4888786
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.42830100655555725, mae:0.4468722939491272
rmse:0.654447078704834, mape:0.7215539216995239, mspe:40167.515625

--- [Trial 7] 参数 ---
learning_rate=0.00043933964142475653, batch_size=32, attn_dropout=0.15000000000000002, n_heads=64, num_p=6, alpha=0.11299705006309652, d_ff_multiplier=1
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.1859134
	speed: 0.1225s/iter; left time: 2890.9920s
	iters: 200, epoch: 1 | loss: 1.1032420
	speed: 0.1201s/iter; left time: 2822.1715s
Epoch: 1 cost time: 28.930017471313477
Epoch: 1, Steps: 237 | Train Loss: 1.2178362 Vali Loss: 1.3132988 Test Loss: 0.4330733
Validation loss decreased (inf --> 1.313299).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0930701
	speed: 0.6257s/iter; left time: 14619.6109s
	iters: 200, epoch: 2 | loss: 1.0943193
	speed: 0.1185s/iter; left time: 2757.4685s
Epoch: 2 cost time: 32.01096534729004
Epoch: 2, Steps: 237 | Train Loss: 1.1092233 Vali Loss: 1.3777561 Test Loss: 0.4349593
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0729564
	speed: 0.6074s/iter; left time: 14047.8401s
	iters: 200, epoch: 3 | loss: 1.0693223
	speed: 0.1716s/iter; left time: 3951.9749s
Epoch: 3 cost time: 42.77470636367798
Epoch: 3, Steps: 237 | Train Loss: 1.0678463 Vali Loss: 1.4471093 Test Loss: 0.4330060
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9886510
	speed: 0.6869s/iter; left time: 15723.0432s
	iters: 200, epoch: 4 | loss: 1.0209966
	speed: 0.1246s/iter; left time: 2839.6446s
Epoch: 4 cost time: 30.554727792739868
Epoch: 4, Steps: 237 | Train Loss: 1.0443765 Vali Loss: 1.4543045 Test Loss: 0.4254571
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.0281221
	speed: 0.6282s/iter; left time: 14231.3945s
	iters: 200, epoch: 5 | loss: 1.0712531
	speed: 0.1208s/iter; left time: 2724.6755s
Epoch: 5 cost time: 30.778085947036743
Epoch: 5, Steps: 237 | Train Loss: 1.0331141 Vali Loss: 1.4823314 Test Loss: 0.4352728
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.0255734
	speed: 0.6374s/iter; left time: 14286.9401s
	iters: 200, epoch: 6 | loss: 1.0127015
	speed: 0.1189s/iter; left time: 2654.1912s
Epoch: 6 cost time: 31.877068042755127
Epoch: 6, Steps: 237 | Train Loss: 1.0275098 Vali Loss: 1.4911785 Test Loss: 0.4409782
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.0510257
	speed: 0.7277s/iter; left time: 16138.8862s
	iters: 200, epoch: 7 | loss: 0.9956759
	speed: 0.1227s/iter; left time: 2708.2656s
Epoch: 7 cost time: 35.234151124954224
Epoch: 7, Steps: 237 | Train Loss: 1.0246639 Vali Loss: 1.4746695 Test Loss: 0.4462159
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.9686303
	speed: 0.6382s/iter; left time: 14004.3390s
	iters: 200, epoch: 8 | loss: 1.0281436
	speed: 0.1338s/iter; left time: 2921.8915s
Epoch: 8 cost time: 38.428773641586304
Epoch: 8, Steps: 237 | Train Loss: 1.0232214 Vali Loss: 1.4762331 Test Loss: 0.4479142
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.9992878
	speed: 0.6475s/iter; left time: 14053.8832s
	iters: 200, epoch: 9 | loss: 1.0044729
	speed: 0.1384s/iter; left time: 2990.1146s
Epoch: 9 cost time: 38.51324129104614
Epoch: 9, Steps: 237 | Train Loss: 1.0224608 Vali Loss: 1.4748998 Test Loss: 0.4484686
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.0223272
	speed: 0.6845s/iter; left time: 14693.8935s
	iters: 200, epoch: 10 | loss: 0.9618950
	speed: 0.1564s/iter; left time: 3342.6635s
Epoch: 10 cost time: 42.132954359054565
Epoch: 10, Steps: 237 | Train Loss: 1.0220354 Vali Loss: 1.4743874 Test Loss: 0.4489718
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.0407329
	speed: 0.6276s/iter; left time: 13324.3001s
	iters: 200, epoch: 11 | loss: 1.0219326
	speed: 0.1793s/iter; left time: 3789.3933s
Epoch: 11 cost time: 42.6551628112793
Epoch: 11, Steps: 237 | Train Loss: 1.0217513 Vali Loss: 1.4758881 Test Loss: 0.4498060
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.43308767676353455, mae:0.44639089703559875
rmse:0.6580939888954163, mape:0.7133002877235413, mspe:32710.67578125

--- [Trial 8] 参数 ---
learning_rate=0.0001499831090737946, batch_size=48, attn_dropout=0.15000000000000002, n_heads=16, num_p=12, alpha=0.10809039945360281, d_ff_multiplier=4
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.1210722
	speed: 0.1515s/iter; left time: 2379.0767s
Epoch: 1 cost time: 23.822225332260132
Epoch: 1, Steps: 158 | Train Loss: 1.2588825 Vali Loss: 1.2890534 Test Loss: 0.4222962
Validation loss decreased (inf --> 1.289053).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0728623
	speed: 0.6507s/iter; left time: 10113.8960s
Epoch: 2 cost time: 16.06638216972351
Epoch: 2, Steps: 158 | Train Loss: 1.1056013 Vali Loss: 1.3097165 Test Loss: 0.4154232
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0448304
	speed: 0.6308s/iter; left time: 9705.4361s
Epoch: 3 cost time: 22.762271881103516
Epoch: 3, Steps: 158 | Train Loss: 1.0847724 Vali Loss: 1.3227236 Test Loss: 0.4185876
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.0636034
	speed: 0.5641s/iter; left time: 8589.9011s
Epoch: 4 cost time: 25.327385187149048
Epoch: 4, Steps: 158 | Train Loss: 1.0748691 Vali Loss: 1.3314077 Test Loss: 0.4184579
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.0734949
	speed: 0.6984s/iter; left time: 10523.5332s
Epoch: 5 cost time: 19.387370586395264
Epoch: 5, Steps: 158 | Train Loss: 1.0694019 Vali Loss: 1.3498092 Test Loss: 0.4220999
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.0617876
	speed: 0.5908s/iter; left time: 8809.2496s
Epoch: 6 cost time: 16.026411294937134
Epoch: 6, Steps: 158 | Train Loss: 1.0665006 Vali Loss: 1.3520633 Test Loss: 0.4151110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.1045556
	speed: 0.6028s/iter; left time: 8893.6695s
Epoch: 7 cost time: 17.56027626991272
Epoch: 7, Steps: 158 | Train Loss: 1.0648260 Vali Loss: 1.3488631 Test Loss: 0.4184991
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.0505248
	speed: 0.6170s/iter; left time: 9004.4662s
Epoch: 8 cost time: 24.765703201293945
Epoch: 8, Steps: 158 | Train Loss: 1.0641622 Vali Loss: 1.3528417 Test Loss: 0.4145274
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.0988404
	speed: 0.7157s/iter; left time: 10332.7459s
Epoch: 9 cost time: 28.339017629623413
Epoch: 9, Steps: 158 | Train Loss: 1.0636599 Vali Loss: 1.3537210 Test Loss: 0.4152134
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.0539494
	speed: 0.5807s/iter; left time: 8291.5619s
Epoch: 10 cost time: 16.341062545776367
Epoch: 10, Steps: 158 | Train Loss: 1.0635256 Vali Loss: 1.3543984 Test Loss: 0.4155375
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.0493243
	speed: 0.6003s/iter; left time: 8476.3848s
Epoch: 11 cost time: 15.97102975845337
Epoch: 11, Steps: 158 | Train Loss: 1.0634674 Vali Loss: 1.3539677 Test Loss: 0.4156299
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4223320484161377, mae:0.4424174427986145
rmse:0.6498708128929138, mape:0.7149348855018616, mspe:40691.20703125

--- [Trial 9] 参数 ---
learning_rate=0.000962849030890725, batch_size=16, attn_dropout=0.15000000000000002, n_heads=16, num_p=6, alpha=0.27369140997861413, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.1789815
	speed: 0.0500s/iter; left time: 2365.0439s
	iters: 200, epoch: 1 | loss: 2.1355662
	speed: 0.0418s/iter; left time: 1972.5473s
	iters: 300, epoch: 1 | loss: 2.0219688
	speed: 0.0437s/iter; left time: 2056.0458s
	iters: 400, epoch: 1 | loss: 1.9614100
	speed: 0.0412s/iter; left time: 1936.9830s
Epoch: 1 cost time: 21.47707509994507
Epoch: 1, Steps: 474 | Train Loss: 2.1137338 Vali Loss: 1.3085985 Test Loss: 0.4328257
Validation loss decreased (inf --> 1.308599).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0351527
	speed: 0.5927s/iter; left time: 27755.4942s
	iters: 200, epoch: 2 | loss: 1.9188583
	speed: 0.0600s/iter; left time: 2802.6434s
	iters: 300, epoch: 2 | loss: 1.9706211
	speed: 0.0606s/iter; left time: 2826.3173s
	iters: 400, epoch: 2 | loss: 2.0103278
	speed: 0.0672s/iter; left time: 3126.8853s
Epoch: 2 cost time: 31.639771699905396
Epoch: 2, Steps: 474 | Train Loss: 1.9619893 Vali Loss: 1.4084175 Test Loss: 0.4376000
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9162252
	speed: 0.4894s/iter; left time: 22684.5794s
	iters: 200, epoch: 3 | loss: 1.9018149
	speed: 0.0680s/iter; left time: 3145.3222s
	iters: 300, epoch: 3 | loss: 1.7903663
	speed: 0.0574s/iter; left time: 2650.2639s
	iters: 400, epoch: 3 | loss: 1.8086619
	speed: 0.0543s/iter; left time: 2498.4892s
Epoch: 3 cost time: 28.687594890594482
Epoch: 3, Steps: 474 | Train Loss: 1.8693820 Vali Loss: 1.4395928 Test Loss: 0.4893426
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.7387372
	speed: 0.5660s/iter; left time: 25965.5033s
	iters: 200, epoch: 4 | loss: 1.8395311
	speed: 0.0754s/iter; left time: 3452.7379s
	iters: 300, epoch: 4 | loss: 1.8210266
	speed: 0.0776s/iter; left time: 3546.7052s
	iters: 400, epoch: 4 | loss: 1.8174613
	speed: 0.0603s/iter; left time: 2750.5671s
Epoch: 4 cost time: 32.8824577331543
Epoch: 4, Steps: 474 | Train Loss: 1.8153491 Vali Loss: 1.4688168 Test Loss: 0.4880788
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.8091648
	speed: 0.5717s/iter; left time: 25956.0943s
	iters: 200, epoch: 5 | loss: 1.7552581
	speed: 0.0434s/iter; left time: 1967.8488s
	iters: 300, epoch: 5 | loss: 1.7545033
	speed: 0.0507s/iter; left time: 2293.3734s
	iters: 400, epoch: 5 | loss: 1.8346332
	speed: 0.0635s/iter; left time: 2864.9917s
Epoch: 5 cost time: 25.873483657836914
Epoch: 5, Steps: 474 | Train Loss: 1.7880265 Vali Loss: 1.4751428 Test Loss: 0.5107630
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.7596277
	speed: 0.5835s/iter; left time: 26217.1201s
	iters: 200, epoch: 6 | loss: 1.7543945
	speed: 0.0384s/iter; left time: 1722.3195s
	iters: 300, epoch: 6 | loss: 1.8883760
	speed: 0.0388s/iter; left time: 1734.8072s
	iters: 400, epoch: 6 | loss: 1.7940257
	speed: 0.0380s/iter; left time: 1694.4992s
Epoch: 6 cost time: 19.135430335998535
Epoch: 6, Steps: 474 | Train Loss: 1.7738966 Vali Loss: 1.4901558 Test Loss: 0.5178503
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.7120265
	speed: 0.6207s/iter; left time: 27594.7494s
	iters: 200, epoch: 7 | loss: 1.6768799
	speed: 0.0549s/iter; left time: 2434.8292s
	iters: 300, epoch: 7 | loss: 1.7171628
	speed: 0.0576s/iter; left time: 2547.2120s
	iters: 400, epoch: 7 | loss: 1.7316622
	speed: 0.0567s/iter; left time: 2503.0495s
Epoch: 7 cost time: 27.357746601104736
Epoch: 7, Steps: 474 | Train Loss: 1.7667315 Vali Loss: 1.4857901 Test Loss: 0.5171008
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.6975620
	speed: 0.5840s/iter; left time: 25685.9669s
	iters: 200, epoch: 8 | loss: 1.8420391
	speed: 0.0430s/iter; left time: 1885.6968s
	iters: 300, epoch: 8 | loss: 1.6795242
	speed: 0.0417s/iter; left time: 1825.3014s
	iters: 400, epoch: 8 | loss: 1.6750860
	speed: 0.0431s/iter; left time: 1883.5726s
Epoch: 8 cost time: 21.424409866333008
Epoch: 8, Steps: 474 | Train Loss: 1.7631473 Vali Loss: 1.4918610 Test Loss: 0.5229254
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.7275543
	speed: 0.6338s/iter; left time: 27574.2015s
	iters: 200, epoch: 9 | loss: 1.6989374
	speed: 0.0454s/iter; left time: 1972.9278s
	iters: 300, epoch: 9 | loss: 1.8114207
	speed: 0.0443s/iter; left time: 1920.6904s
	iters: 400, epoch: 9 | loss: 1.7376916
	speed: 0.0555s/iter; left time: 2396.0885s
Epoch: 9 cost time: 23.973196506500244
Epoch: 9, Steps: 474 | Train Loss: 1.7611839 Vali Loss: 1.4940428 Test Loss: 0.5214776
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.7846789
	speed: 0.5918s/iter; left time: 25469.9238s
	iters: 200, epoch: 10 | loss: 1.7374141
	speed: 0.0581s/iter; left time: 2496.2809s
	iters: 300, epoch: 10 | loss: 1.7175782
	speed: 0.0513s/iter; left time: 2199.3508s
	iters: 400, epoch: 10 | loss: 1.9016033
	speed: 0.0525s/iter; left time: 2244.1198s
Epoch: 10 cost time: 26.064812183380127
Epoch: 10, Steps: 474 | Train Loss: 1.7602380 Vali Loss: 1.4946991 Test Loss: 0.5251704
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.6303010
	speed: 0.6193s/iter; left time: 26356.7240s
	iters: 200, epoch: 11 | loss: 1.9042414
	speed: 0.0448s/iter; left time: 1903.7605s
	iters: 300, epoch: 11 | loss: 1.7275875
	speed: 0.0463s/iter; left time: 1959.5809s
	iters: 400, epoch: 11 | loss: 1.6267326
	speed: 0.0512s/iter; left time: 2163.5359s
Epoch: 11 cost time: 25.00721049308777
Epoch: 11, Steps: 474 | Train Loss: 1.7598316 Vali Loss: 1.4935713 Test Loss: 0.5242502
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4328139126300812, mae:0.452752023935318
rmse:0.6578859686851501, mape:0.732168436050415, mspe:34967.6796875

--- [Trial 10] 参数 ---
learning_rate=0.0008563441910369377, batch_size=16, attn_dropout=0.25, n_heads=32, num_p=12, alpha=0.21895719060975516, d_ff_multiplier=1
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.7824564
	speed: 0.0617s/iter; left time: 2919.9536s
	iters: 200, epoch: 1 | loss: 1.7576387
	speed: 0.0633s/iter; left time: 2986.4072s
	iters: 300, epoch: 1 | loss: 1.7554386
	speed: 0.0875s/iter; left time: 4119.0854s
	iters: 400, epoch: 1 | loss: 1.7419538
	speed: 0.0897s/iter; left time: 4213.6543s
Epoch: 1 cost time: 36.809391498565674
Epoch: 1, Steps: 474 | Train Loss: 1.7891967 Vali Loss: 1.3300916 Test Loss: 0.4134775
Validation loss decreased (inf --> 1.330092).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6069311
	speed: 0.6340s/iter; left time: 29686.5144s
	iters: 200, epoch: 2 | loss: 1.7061176
	speed: 0.0665s/iter; left time: 3106.0619s
	iters: 300, epoch: 2 | loss: 1.6155281
	speed: 0.0771s/iter; left time: 3593.8343s
	iters: 400, epoch: 2 | loss: 1.6767632
	speed: 0.0794s/iter; left time: 3692.3067s
Epoch: 2 cost time: 35.050435066223145
Epoch: 2, Steps: 474 | Train Loss: 1.6544057 Vali Loss: 1.3703761 Test Loss: 0.4318713
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6203896
	speed: 0.5539s/iter; left time: 25675.5570s
	iters: 200, epoch: 3 | loss: 1.6300089
	speed: 0.0503s/iter; left time: 2328.5470s
	iters: 300, epoch: 3 | loss: 1.5928380
	speed: 0.0569s/iter; left time: 2624.0661s
	iters: 400, epoch: 3 | loss: 1.5546457
	speed: 0.0837s/iter; left time: 3853.4828s
Epoch: 3 cost time: 30.123653650283813
Epoch: 3, Steps: 474 | Train Loss: 1.5687450 Vali Loss: 1.3899699 Test Loss: 0.4628539
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.4990849
	speed: 0.6139s/iter; left time: 28166.1605s
	iters: 200, epoch: 4 | loss: 1.5643541
	speed: 0.0520s/iter; left time: 2381.7058s
	iters: 300, epoch: 4 | loss: 1.4716347
	speed: 0.0628s/iter; left time: 2870.3851s
	iters: 400, epoch: 4 | loss: 1.4848582
	speed: 0.0487s/iter; left time: 2221.5684s
Epoch: 4 cost time: 25.79087734222412
Epoch: 4, Steps: 474 | Train Loss: 1.5246418 Vali Loss: 1.4036559 Test Loss: 0.4948516
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.5288426
	speed: 0.6217s/iter; left time: 28230.2773s
	iters: 200, epoch: 5 | loss: 1.5681183
	speed: 0.0662s/iter; left time: 3000.4858s
	iters: 300, epoch: 5 | loss: 1.4677829
	speed: 0.0653s/iter; left time: 2949.7618s
	iters: 400, epoch: 5 | loss: 1.5031199
	speed: 0.0470s/iter; left time: 2118.1329s
Epoch: 5 cost time: 29.099381923675537
Epoch: 5, Steps: 474 | Train Loss: 1.5022774 Vali Loss: 1.3923076 Test Loss: 0.5328959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.5252560
	speed: 0.5145s/iter; left time: 23118.0436s
	iters: 200, epoch: 6 | loss: 1.3612404
	speed: 0.0498s/iter; left time: 2230.9676s
	iters: 300, epoch: 6 | loss: 1.4676676
	speed: 0.0436s/iter; left time: 1949.1205s
	iters: 400, epoch: 6 | loss: 1.6154590
	speed: 0.0432s/iter; left time: 1929.2529s
Epoch: 6 cost time: 23.37739872932434
Epoch: 6, Steps: 474 | Train Loss: 1.4909270 Vali Loss: 1.4129661 Test Loss: 0.5570554
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.4701061
	speed: 0.5350s/iter; left time: 23785.3867s
	iters: 200, epoch: 7 | loss: 1.3840487
	speed: 0.0776s/iter; left time: 3444.0303s
	iters: 300, epoch: 7 | loss: 1.4735744
	speed: 0.0629s/iter; left time: 2781.6597s
	iters: 400, epoch: 7 | loss: 1.5655105
	speed: 0.0482s/iter; left time: 2127.8062s
Epoch: 7 cost time: 29.76232123374939
Epoch: 7, Steps: 474 | Train Loss: 1.4851508 Vali Loss: 1.4098281 Test Loss: 0.5629371
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.5328256
	speed: 0.5235s/iter; left time: 23025.1890s
	iters: 200, epoch: 8 | loss: 1.4505026
	speed: 0.0705s/iter; left time: 3091.9996s
	iters: 300, epoch: 8 | loss: 1.5141457
	speed: 0.0697s/iter; left time: 3051.0258s
	iters: 400, epoch: 8 | loss: 1.5764757
	speed: 0.0726s/iter; left time: 3171.1404s
Epoch: 8 cost time: 33.58616805076599
Epoch: 8, Steps: 474 | Train Loss: 1.4820244 Vali Loss: 1.4122103 Test Loss: 0.5664130
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.4192181
	speed: 0.5746s/iter; left time: 25001.0918s
	iters: 200, epoch: 9 | loss: 1.4734030
	speed: 0.0539s/iter; left time: 2340.0105s
	iters: 300, epoch: 9 | loss: 1.5068574
	speed: 0.0831s/iter; left time: 3598.4451s
	iters: 400, epoch: 9 | loss: 1.5278609
	speed: 0.0825s/iter; left time: 3564.7657s
Epoch: 9 cost time: 33.14660596847534
Epoch: 9, Steps: 474 | Train Loss: 1.4802744 Vali Loss: 1.4179401 Test Loss: 0.5721549
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.5231044
	speed: 0.5229s/iter; left time: 22503.8066s
	iters: 200, epoch: 10 | loss: 1.4371257
	speed: 0.0429s/iter; left time: 1842.4963s
	iters: 300, epoch: 10 | loss: 1.4379258
	speed: 0.0433s/iter; left time: 1856.1530s
	iters: 400, epoch: 10 | loss: 1.3775543
	speed: 0.0430s/iter; left time: 1839.0647s
Epoch: 10 cost time: 22.25273585319519
Epoch: 10, Steps: 474 | Train Loss: 1.4796780 Vali Loss: 1.4151968 Test Loss: 0.5726719
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.4935428
	speed: 0.5277s/iter; left time: 22458.1690s
	iters: 200, epoch: 11 | loss: 1.5425979
	speed: 0.0723s/iter; left time: 3069.8541s
	iters: 300, epoch: 11 | loss: 1.4827375
	speed: 0.0733s/iter; left time: 3103.1846s
	iters: 400, epoch: 11 | loss: 1.5532218
	speed: 0.0697s/iter; left time: 2944.1218s
Epoch: 11 cost time: 34.14604568481445
Epoch: 11, Steps: 474 | Train Loss: 1.4789355 Vali Loss: 1.4159055 Test Loss: 0.5751371
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41347736120224, mae:0.43574246764183044
rmse:0.6430220603942871, mape:0.7144336700439453, mspe:41645.36328125

--- [Trial 11] 参数 ---
learning_rate=0.0008844365981161712, batch_size=16, attn_dropout=0.25, n_heads=32, num_p=12, alpha=0.22093730174369172, d_ff_multiplier=1
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.7935076
	speed: 0.0571s/iter; left time: 2700.9126s
	iters: 200, epoch: 1 | loss: 1.7692406
	speed: 0.0649s/iter; left time: 3061.8323s
	iters: 300, epoch: 1 | loss: 1.7669449
	speed: 0.0768s/iter; left time: 3615.6538s
	iters: 400, epoch: 1 | loss: 1.7518198
	speed: 0.0814s/iter; left time: 3827.5438s
Epoch: 1 cost time: 32.525623083114624
Epoch: 1, Steps: 474 | Train Loss: 1.8001532 Vali Loss: 1.3251362 Test Loss: 0.4142262
Validation loss decreased (inf --> 1.325136).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6186767
	speed: 0.5423s/iter; left time: 25395.7498s
	iters: 200, epoch: 2 | loss: 1.7144574
	speed: 0.0448s/iter; left time: 2093.0694s
	iters: 300, epoch: 2 | loss: 1.6222154
	speed: 0.0466s/iter; left time: 2173.1667s
	iters: 400, epoch: 2 | loss: 1.6871945
	speed: 0.0508s/iter; left time: 2363.1101s
Epoch: 2 cost time: 22.89506721496582
Epoch: 2, Steps: 474 | Train Loss: 1.6633869 Vali Loss: 1.3732189 Test Loss: 0.4305199
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6283913
	speed: 0.5783s/iter; left time: 26807.1657s
	iters: 200, epoch: 3 | loss: 1.6354629
	speed: 0.0434s/iter; left time: 2006.4744s
	iters: 300, epoch: 3 | loss: 1.6009315
	speed: 0.0437s/iter; left time: 2015.9634s
	iters: 400, epoch: 3 | loss: 1.5650985
	speed: 0.0430s/iter; left time: 1982.4673s
Epoch: 3 cost time: 21.74525475502014
Epoch: 3, Steps: 474 | Train Loss: 1.5766049 Vali Loss: 1.3858010 Test Loss: 0.4697343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.5048962
	speed: 0.5519s/iter; left time: 25319.3317s
	iters: 200, epoch: 4 | loss: 1.5726427
	speed: 0.0813s/iter; left time: 3723.2029s
	iters: 300, epoch: 4 | loss: 1.4791119
	speed: 0.0781s/iter; left time: 3568.7881s
	iters: 400, epoch: 4 | loss: 1.4947295
	speed: 0.0480s/iter; left time: 2188.8245s
Epoch: 4 cost time: 31.596412658691406
Epoch: 4, Steps: 474 | Train Loss: 1.5324609 Vali Loss: 1.3936085 Test Loss: 0.4988593
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.5359426
	speed: 0.5552s/iter; left time: 25210.2512s
	iters: 200, epoch: 5 | loss: 1.5740614
	speed: 0.0530s/iter; left time: 2399.9175s
	iters: 300, epoch: 5 | loss: 1.4725100
	speed: 0.0437s/iter; left time: 1976.9554s
	iters: 400, epoch: 5 | loss: 1.5149083
	speed: 0.0430s/iter; left time: 1941.0377s
Epoch: 5 cost time: 22.767075300216675
Epoch: 5, Steps: 474 | Train Loss: 1.5098600 Vali Loss: 1.3943454 Test Loss: 0.5454118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.5329926
	speed: 0.5724s/iter; left time: 25718.8320s
	iters: 200, epoch: 6 | loss: 1.3702703
	speed: 0.0500s/iter; left time: 2240.0312s
	iters: 300, epoch: 6 | loss: 1.4771094
	speed: 0.0456s/iter; left time: 2041.7992s
	iters: 400, epoch: 6 | loss: 1.6227356
	speed: 0.0529s/iter; left time: 2362.8368s
Epoch: 6 cost time: 27.909076929092407
Epoch: 6, Steps: 474 | Train Loss: 1.4983728 Vali Loss: 1.4120151 Test Loss: 0.5738555
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.4820971
	speed: 0.5607s/iter; left time: 24926.5637s
	iters: 200, epoch: 7 | loss: 1.3926322
	speed: 0.0777s/iter; left time: 3445.2819s
	iters: 300, epoch: 7 | loss: 1.4805570
	speed: 0.0471s/iter; left time: 2085.7949s
	iters: 400, epoch: 7 | loss: 1.5721633
	speed: 0.0505s/iter; left time: 2231.5105s
Epoch: 7 cost time: 30.913893222808838
Epoch: 7, Steps: 474 | Train Loss: 1.4926122 Vali Loss: 1.3983910 Test Loss: 0.5738264
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.5450597
	speed: 0.5186s/iter; left time: 22809.6626s
	iters: 200, epoch: 8 | loss: 1.4620600
	speed: 0.0433s/iter; left time: 1900.7440s
	iters: 300, epoch: 8 | loss: 1.5248643
	speed: 0.0429s/iter; left time: 1879.4123s
	iters: 400, epoch: 8 | loss: 1.5842597
	speed: 0.0436s/iter; left time: 1904.7556s
Epoch: 8 cost time: 21.453322649002075
Epoch: 8, Steps: 474 | Train Loss: 1.4893832 Vali Loss: 1.4032822 Test Loss: 0.5794160
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.4223237
	speed: 0.5712s/iter; left time: 24854.4492s
	iters: 200, epoch: 9 | loss: 1.4780049
	speed: 0.0716s/iter; left time: 3106.0114s
	iters: 300, epoch: 9 | loss: 1.5145634
	speed: 0.0732s/iter; left time: 3171.4936s
	iters: 400, epoch: 9 | loss: 1.5384834
	speed: 0.0859s/iter; left time: 3711.9163s
Epoch: 9 cost time: 36.42451763153076
Epoch: 9, Steps: 474 | Train Loss: 1.4874420 Vali Loss: 1.4075370 Test Loss: 0.5871728
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.5335093
	speed: 0.5284s/iter; left time: 22739.0539s
	iters: 200, epoch: 10 | loss: 1.4459031
	speed: 0.0555s/iter; left time: 2383.6677s
	iters: 300, epoch: 10 | loss: 1.4488523
	speed: 0.0515s/iter; left time: 2208.0469s
	iters: 400, epoch: 10 | loss: 1.3824117
	speed: 0.0429s/iter; left time: 1833.7066s
Epoch: 10 cost time: 26.49518918991089
Epoch: 10, Steps: 474 | Train Loss: 1.4868753 Vali Loss: 1.4061027 Test Loss: 0.5894320
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.5000423
	speed: 0.4512s/iter; left time: 19203.0707s
	iters: 200, epoch: 11 | loss: 1.5489733
	speed: 0.0432s/iter; left time: 1833.8906s
	iters: 300, epoch: 11 | loss: 1.4885015
	speed: 0.0429s/iter; left time: 1817.2229s
	iters: 400, epoch: 11 | loss: 1.5652002
	speed: 0.0441s/iter; left time: 1862.0920s
Epoch: 11 cost time: 21.25145387649536
Epoch: 11, Steps: 474 | Train Loss: 1.4861516 Vali Loss: 1.4058590 Test Loss: 0.5912805
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41422614455223083, mae:0.43636903166770935
rmse:0.643604040145874, mape:0.7155416011810303, mspe:41962.53125

--- [Trial 12] 参数 ---
learning_rate=0.0006683837584287836, batch_size=16, attn_dropout=0.25, n_heads=32, num_p=12, alpha=0.1999862251537987, d_ff_multiplier=1
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.6741586
	speed: 0.0748s/iter; left time: 3537.9093s
	iters: 200, epoch: 1 | loss: 1.6513720
	speed: 0.0649s/iter; left time: 3063.3716s
	iters: 300, epoch: 1 | loss: 1.6482897
	speed: 0.0659s/iter; left time: 3103.3291s
	iters: 400, epoch: 1 | loss: 1.6367204
	speed: 0.0725s/iter; left time: 3408.0220s
Epoch: 1 cost time: 33.89842176437378
Epoch: 1, Steps: 474 | Train Loss: 1.6810281 Vali Loss: 1.3320398 Test Loss: 0.4133979
Validation loss decreased (inf --> 1.332040).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5224926
	speed: 0.5776s/iter; left time: 27046.5999s
	iters: 200, epoch: 2 | loss: 1.6077315
	speed: 0.0656s/iter; left time: 3063.8541s
	iters: 300, epoch: 2 | loss: 1.5231988
	speed: 0.0637s/iter; left time: 2972.1629s
	iters: 400, epoch: 2 | loss: 1.5882336
	speed: 0.0571s/iter; left time: 2654.8073s
Epoch: 2 cost time: 28.825643062591553
Epoch: 2, Steps: 474 | Train Loss: 1.5611838 Vali Loss: 1.4019262 Test Loss: 0.4304992
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5303100
	speed: 0.4868s/iter; left time: 22564.3900s
	iters: 200, epoch: 3 | loss: 1.5327017
	speed: 0.0430s/iter; left time: 1990.7870s
	iters: 300, epoch: 3 | loss: 1.5241431
	speed: 0.0431s/iter; left time: 1986.9789s
	iters: 400, epoch: 3 | loss: 1.4873006
	speed: 0.0503s/iter; left time: 2316.1510s
Epoch: 3 cost time: 22.996623992919922
Epoch: 3, Steps: 474 | Train Loss: 1.4872293 Vali Loss: 1.4034730 Test Loss: 0.4647653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.4232006
	speed: 0.5446s/iter; left time: 24987.0745s
	iters: 200, epoch: 4 | loss: 1.4649916
	speed: 0.0480s/iter; left time: 2198.5392s
	iters: 300, epoch: 4 | loss: 1.3990562
	speed: 0.0486s/iter; left time: 2219.6207s
	iters: 400, epoch: 4 | loss: 1.4054614
	speed: 0.0479s/iter; left time: 2184.9386s
Epoch: 4 cost time: 24.528664350509644
Epoch: 4, Steps: 474 | Train Loss: 1.4469893 Vali Loss: 1.3701602 Test Loss: 0.4796000
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.4499947
	speed: 0.5156s/iter; left time: 23410.2789s
	iters: 200, epoch: 5 | loss: 1.4990786
	speed: 0.0583s/iter; left time: 2639.8162s
	iters: 300, epoch: 5 | loss: 1.3926635
	speed: 0.0572s/iter; left time: 2583.6841s
	iters: 400, epoch: 5 | loss: 1.4274024
	speed: 0.0526s/iter; left time: 2374.5561s
Epoch: 5 cost time: 27.91565227508545
Epoch: 5, Steps: 474 | Train Loss: 1.4264105 Vali Loss: 1.4057536 Test Loss: 0.5080919
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.4443649
	speed: 0.4775s/iter; left time: 21454.8846s
	iters: 200, epoch: 6 | loss: 1.2902336
	speed: 0.0723s/iter; left time: 3239.1048s
	iters: 300, epoch: 6 | loss: 1.3915505
	speed: 0.0767s/iter; left time: 3430.0888s
	iters: 400, epoch: 6 | loss: 1.5450834
	speed: 0.0773s/iter; left time: 3452.1237s
Epoch: 6 cost time: 35.76179122924805
Epoch: 6, Steps: 474 | Train Loss: 1.4157151 Vali Loss: 1.4285611 Test Loss: 0.5282340
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.3946308
	speed: 0.6379s/iter; left time: 28360.1010s
	iters: 200, epoch: 7 | loss: 1.3143262
	speed: 0.0813s/iter; left time: 3604.6174s
	iters: 300, epoch: 7 | loss: 1.4153475
	speed: 0.0840s/iter; left time: 3719.0767s
	iters: 400, epoch: 7 | loss: 1.4829979
	speed: 0.0828s/iter; left time: 3657.4264s
Epoch: 7 cost time: 39.97519636154175
Epoch: 7, Steps: 474 | Train Loss: 1.4104875 Vali Loss: 1.4093744 Test Loss: 0.5340157
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.4478519
	speed: 0.6283s/iter; left time: 27632.9790s
	iters: 200, epoch: 8 | loss: 1.3740537
	speed: 0.0603s/iter; left time: 2645.5530s
	iters: 300, epoch: 8 | loss: 1.4287808
	speed: 0.0612s/iter; left time: 2681.2072s
	iters: 400, epoch: 8 | loss: 1.4989579
	speed: 0.0616s/iter; left time: 2688.9126s
Epoch: 8 cost time: 29.40672278404236
Epoch: 8, Steps: 474 | Train Loss: 1.4077746 Vali Loss: 1.4178706 Test Loss: 0.5313980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.3524324
	speed: 0.5037s/iter; left time: 21913.7173s
	iters: 200, epoch: 9 | loss: 1.3952217
	speed: 0.0560s/iter; left time: 2430.4816s
	iters: 300, epoch: 9 | loss: 1.4453570
	speed: 0.0427s/iter; left time: 1848.8041s
	iters: 400, epoch: 9 | loss: 1.4483727
	speed: 0.0523s/iter; left time: 2258.1296s
Epoch: 9 cost time: 25.096360445022583
Epoch: 9, Steps: 474 | Train Loss: 1.4058550 Vali Loss: 1.4258368 Test Loss: 0.5414677
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.4404008
	speed: 0.5300s/iter; left time: 22809.4929s
	iters: 200, epoch: 10 | loss: 1.3642125
	speed: 0.0763s/iter; left time: 3276.1789s
	iters: 300, epoch: 10 | loss: 1.3794008
	speed: 0.0778s/iter; left time: 3334.4605s
	iters: 400, epoch: 10 | loss: 1.3118300
	speed: 0.0733s/iter; left time: 3133.3620s
Epoch: 10 cost time: 35.11747336387634
Epoch: 10, Steps: 474 | Train Loss: 1.4055077 Vali Loss: 1.4258341 Test Loss: 0.5435831
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.4270613
	speed: 0.5745s/iter; left time: 24450.3359s
	iters: 200, epoch: 11 | loss: 1.4695576
	speed: 0.0632s/iter; left time: 2682.4576s
	iters: 300, epoch: 11 | loss: 1.4162190
	speed: 0.0469s/iter; left time: 1987.6983s
	iters: 400, epoch: 11 | loss: 1.4620116
	speed: 0.0424s/iter; left time: 1792.6480s
Epoch: 11 cost time: 26.212565660476685
Epoch: 11, Steps: 474 | Train Loss: 1.4052367 Vali Loss: 1.4227581 Test Loss: 0.5426583
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.413397878408432, mae:0.4345516264438629
rmse:0.642960250377655, mape:0.7108047604560852, mspe:40466.03515625

--- [Trial 13] 参数 ---
learning_rate=0.0006179035881660605, batch_size=16, attn_dropout=0.2, n_heads=32, num_p=12, alpha=0.057642347823735895, d_ff_multiplier=1
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.8252988
	speed: 0.0560s/iter; left time: 2648.4506s
	iters: 200, epoch: 1 | loss: 0.8204200
	speed: 0.0522s/iter; left time: 2464.6499s
	iters: 300, epoch: 1 | loss: 0.8012424
	speed: 0.0473s/iter; left time: 2229.9398s
	iters: 400, epoch: 1 | loss: 0.7946450
	speed: 0.0459s/iter; left time: 2158.6159s
Epoch: 1 cost time: 23.68317461013794
Epoch: 1, Steps: 474 | Train Loss: 0.8199452 Vali Loss: 1.3567430 Test Loss: 0.4168934
Validation loss decreased (inf --> 1.356743).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7230445
	speed: 0.5610s/iter; left time: 26271.2580s
	iters: 200, epoch: 2 | loss: 0.7687137
	speed: 0.0927s/iter; left time: 4332.6379s
	iters: 300, epoch: 2 | loss: 0.7178544
	speed: 0.0867s/iter; left time: 4041.5908s
	iters: 400, epoch: 2 | loss: 0.7674378
	speed: 0.0818s/iter; left time: 3806.0701s
Epoch: 2 cost time: 40.946913719177246
Epoch: 2, Steps: 474 | Train Loss: 0.7502552 Vali Loss: 1.4240353 Test Loss: 0.4198259
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7294070
	speed: 0.4953s/iter; left time: 22956.3542s
	iters: 200, epoch: 3 | loss: 0.7262511
	speed: 0.0618s/iter; left time: 2858.3268s
	iters: 300, epoch: 3 | loss: 0.7186574
	speed: 0.0419s/iter; left time: 1935.1109s
	iters: 400, epoch: 3 | loss: 0.7029487
	speed: 0.0418s/iter; left time: 1926.8781s
Epoch: 3 cost time: 23.24858045578003
Epoch: 3, Steps: 474 | Train Loss: 0.7027259 Vali Loss: 1.4343312 Test Loss: 0.4538387
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6621169
	speed: 0.5135s/iter; left time: 23558.7886s
	iters: 200, epoch: 4 | loss: 0.6782187
	speed: 0.0439s/iter; left time: 2007.8374s
	iters: 300, epoch: 4 | loss: 0.6529655
	speed: 0.0438s/iter; left time: 1998.8241s
	iters: 400, epoch: 4 | loss: 0.6600558
	speed: 0.0499s/iter; left time: 2276.1267s
Epoch: 4 cost time: 22.86767554283142
Epoch: 4, Steps: 474 | Train Loss: 0.6777707 Vali Loss: 1.4293358 Test Loss: 0.4700194
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.6746696
	speed: 0.5899s/iter; left time: 26782.7413s
	iters: 200, epoch: 5 | loss: 0.7101141
	speed: 0.0709s/iter; left time: 3210.3798s
	iters: 300, epoch: 5 | loss: 0.6435155
	speed: 0.0738s/iter; left time: 3335.7785s
	iters: 400, epoch: 5 | loss: 0.6608104
	speed: 0.0788s/iter; left time: 3553.4156s
Epoch: 5 cost time: 35.737478494644165
Epoch: 5, Steps: 474 | Train Loss: 0.6657710 Vali Loss: 1.4715419 Test Loss: 0.5076071
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6592853
	speed: 0.6495s/iter; left time: 29182.1164s
	iters: 200, epoch: 6 | loss: 0.6024114
	speed: 0.0498s/iter; left time: 2232.2909s
	iters: 300, epoch: 6 | loss: 0.6314097
	speed: 0.0505s/iter; left time: 2257.0417s
	iters: 400, epoch: 6 | loss: 0.7282930
	speed: 0.0577s/iter; left time: 2576.4926s
Epoch: 6 cost time: 25.843697547912598
Epoch: 6, Steps: 474 | Train Loss: 0.6595638 Vali Loss: 1.4642289 Test Loss: 0.5175623
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.6532793
	speed: 0.4896s/iter; left time: 21767.0503s
	iters: 200, epoch: 7 | loss: 0.6149316
	speed: 0.0737s/iter; left time: 3266.9393s
	iters: 300, epoch: 7 | loss: 0.6614527
	speed: 0.0769s/iter; left time: 3403.0516s
	iters: 400, epoch: 7 | loss: 0.6922495
	speed: 0.0725s/iter; left time: 3203.3240s
Epoch: 7 cost time: 35.10167574882507
Epoch: 7, Steps: 474 | Train Loss: 0.6564431 Vali Loss: 1.4613951 Test Loss: 0.5205102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.6690035
	speed: 0.4769s/iter; left time: 20977.4816s
	iters: 200, epoch: 8 | loss: 0.6312399
	speed: 0.0696s/iter; left time: 3052.7233s
	iters: 300, epoch: 8 | loss: 0.6739048
	speed: 0.0798s/iter; left time: 3495.3248s
	iters: 400, epoch: 8 | loss: 0.6969666
	speed: 0.1029s/iter; left time: 4495.0833s
Epoch: 8 cost time: 38.559118032455444
Epoch: 8, Steps: 474 | Train Loss: 0.6549067 Vali Loss: 1.4681286 Test Loss: 0.5241545
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.6323125
	speed: 0.6241s/iter; left time: 27154.4652s
	iters: 200, epoch: 9 | loss: 0.6500744
	speed: 0.0437s/iter; left time: 1895.9684s
	iters: 300, epoch: 9 | loss: 0.6772452
	speed: 0.0433s/iter; left time: 1876.3873s
	iters: 400, epoch: 9 | loss: 0.6718838
	speed: 0.0467s/iter; left time: 2017.5364s
Epoch: 9 cost time: 22.241565942764282
Epoch: 9, Steps: 474 | Train Loss: 0.6540285 Vali Loss: 1.4761249 Test Loss: 0.5294962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.6644804
	speed: 0.5550s/iter; left time: 23883.4781s
	iters: 200, epoch: 10 | loss: 0.6366761
	speed: 0.0511s/iter; left time: 2192.6250s
	iters: 300, epoch: 10 | loss: 0.6287800
	speed: 0.0520s/iter; left time: 2225.4129s
	iters: 400, epoch: 10 | loss: 0.6145207
	speed: 0.0622s/iter; left time: 2658.4552s
Epoch: 10 cost time: 26.01975679397583
Epoch: 10, Steps: 474 | Train Loss: 0.6537128 Vali Loss: 1.4732534 Test Loss: 0.5317250
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.6758064
	speed: 0.5391s/iter; left time: 22943.9351s
	iters: 200, epoch: 11 | loss: 0.6834131
	speed: 0.0515s/iter; left time: 2187.8416s
	iters: 300, epoch: 11 | loss: 0.6698530
	speed: 0.0539s/iter; left time: 2281.6163s
	iters: 400, epoch: 11 | loss: 0.6719332
	speed: 0.0705s/iter; left time: 2979.1901s
Epoch: 11 cost time: 28.615787982940674
Epoch: 11, Steps: 474 | Train Loss: 0.6534200 Vali Loss: 1.4709644 Test Loss: 0.5309421
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41689199209213257, mae:0.434635192155838
rmse:0.6456717252731323, mape:0.7084731459617615, mspe:38658.890625

--- [Trial 14] 参数 ---
learning_rate=0.0006096221964317141, batch_size=48, attn_dropout=0.2, n_heads=32, num_p=12, alpha=0.17442960590950446, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.5202724
	speed: 0.1350s/iter; left time: 2120.3536s
Epoch: 1 cost time: 21.236986875534058
Epoch: 1, Steps: 158 | Train Loss: 1.5700073 Vali Loss: 1.2627778 Test Loss: 0.4121448
Validation loss decreased (inf --> 1.262778).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4866143
	speed: 0.6335s/iter; left time: 9846.0829s
Epoch: 2 cost time: 20.944746017456055
Epoch: 2, Steps: 158 | Train Loss: 1.4509965 Vali Loss: 1.3134559 Test Loss: 0.4261826
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3482186
	speed: 0.7477s/iter; left time: 11502.7818s
Epoch: 3 cost time: 31.33046317100525
Epoch: 3, Steps: 158 | Train Loss: 1.4112134 Vali Loss: 1.3679054 Test Loss: 0.4278907
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.3927481
	speed: 0.7173s/iter; left time: 10922.8459s
Epoch: 4 cost time: 32.82915663719177
Epoch: 4, Steps: 158 | Train Loss: 1.3855113 Vali Loss: 1.3869838 Test Loss: 0.4484449
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.3831980
	speed: 0.6143s/iter; left time: 9256.1912s
Epoch: 5 cost time: 20.39804744720459
Epoch: 5, Steps: 158 | Train Loss: 1.3699627 Vali Loss: 1.3564312 Test Loss: 0.4507973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.3527093
	speed: 0.6594s/iter; left time: 9832.4216s
Epoch: 6 cost time: 21.16487431526184
Epoch: 6, Steps: 158 | Train Loss: 1.3620421 Vali Loss: 1.3572572 Test Loss: 0.4741133
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.3450989
	speed: 0.7393s/iter; left time: 10907.5987s
Epoch: 7 cost time: 21.544198274612427
Epoch: 7, Steps: 158 | Train Loss: 1.3578264 Vali Loss: 1.3724699 Test Loss: 0.4572123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.3988295
	speed: 0.6556s/iter; left time: 9568.2633s
Epoch: 8 cost time: 32.87944936752319
Epoch: 8, Steps: 158 | Train Loss: 1.3555555 Vali Loss: 1.3674955 Test Loss: 0.4673293
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.3657212
	speed: 0.6097s/iter; left time: 8802.9467s
Epoch: 9 cost time: 19.946187019348145
Epoch: 9, Steps: 158 | Train Loss: 1.3544981 Vali Loss: 1.3847671 Test Loss: 0.4657291
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.3668494
	speed: 0.6687s/iter; left time: 9548.2835s
Epoch: 10 cost time: 28.703802585601807
Epoch: 10, Steps: 158 | Train Loss: 1.3540109 Vali Loss: 1.3818066 Test Loss: 0.4659395
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.3084346
	speed: 0.6439s/iter; left time: 9092.2012s
Epoch: 11 cost time: 20.993494987487793
Epoch: 11, Steps: 158 | Train Loss: 1.3536242 Vali Loss: 1.3778425 Test Loss: 0.4663635
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41214102506637573, mae:0.43412667512893677
rmse:0.6419820785522461, mape:0.7083174586296082, mspe:36498.80078125

--- [Trial 15] 参数 ---
learning_rate=0.0003915908942642477, batch_size=48, attn_dropout=0.2, n_heads=32, num_p=12, alpha=0.17688084617334826, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.5366460
	speed: 0.1297s/iter; left time: 2036.3536s
Epoch: 1 cost time: 20.492520093917847
Epoch: 1, Steps: 158 | Train Loss: 1.6097126 Vali Loss: 1.2757807 Test Loss: 0.4179521
Validation loss decreased (inf --> 1.275781).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5114022
	speed: 0.7191s/iter; left time: 11177.1112s
Epoch: 2 cost time: 30.365267753601074
Epoch: 2, Steps: 158 | Train Loss: 1.4753184 Vali Loss: 1.2930048 Test Loss: 0.4148601
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3752379
	speed: 0.6142s/iter; left time: 9449.5793s
Epoch: 3 cost time: 20.875991821289062
Epoch: 3, Steps: 158 | Train Loss: 1.4433424 Vali Loss: 1.3451886 Test Loss: 0.4277766
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.4330853
	speed: 0.6117s/iter; left time: 9314.0483s
Epoch: 4 cost time: 20.572439432144165
Epoch: 4, Steps: 158 | Train Loss: 1.4260681 Vali Loss: 1.3301380 Test Loss: 0.4202155
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.4255540
	speed: 0.7021s/iter; left time: 10580.5607s
Epoch: 5 cost time: 37.02733874320984
Epoch: 5, Steps: 158 | Train Loss: 1.4155565 Vali Loss: 1.3273262 Test Loss: 0.4171770
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.3926982
	speed: 0.6600s/iter; left time: 9841.3864s
Epoch: 6 cost time: 20.256346940994263
Epoch: 6, Steps: 158 | Train Loss: 1.4094773 Vali Loss: 1.3412356 Test Loss: 0.4208501
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.3882229
	speed: 0.6336s/iter; left time: 9347.4824s
Epoch: 7 cost time: 20.11009669303894
Epoch: 7, Steps: 158 | Train Loss: 1.4061387 Vali Loss: 1.3441377 Test Loss: 0.4214993
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.4557400
	speed: 0.6328s/iter; left time: 9235.9823s
Epoch: 8 cost time: 28.346004009246826
Epoch: 8, Steps: 158 | Train Loss: 1.4043440 Vali Loss: 1.3401612 Test Loss: 0.4248528
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.4131510
	speed: 0.6807s/iter; left time: 9827.0716s
Epoch: 9 cost time: 22.840282917022705
Epoch: 9, Steps: 158 | Train Loss: 1.4035153 Vali Loss: 1.3460634 Test Loss: 0.4228906
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.4155375
	speed: 0.6405s/iter; left time: 9146.0061s
Epoch: 10 cost time: 19.892834424972534
Epoch: 10, Steps: 158 | Train Loss: 1.4031127 Vali Loss: 1.3448319 Test Loss: 0.4237675
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.3519270
	speed: 0.6332s/iter; left time: 8942.0939s
Epoch: 11 cost time: 27.19261598587036
Epoch: 11, Steps: 158 | Train Loss: 1.4028966 Vali Loss: 1.3436693 Test Loss: 0.4241456
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4179459810256958, mae:0.4379710257053375
rmse:0.6464874148368835, mape:0.710810124874115, mspe:36550.91015625

--- [Trial 16] 参数 ---
learning_rate=0.00032282516693841215, batch_size=48, attn_dropout=0.2, n_heads=32, num_p=12, alpha=0.06967271703171564, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.9033032
	speed: 0.1612s/iter; left time: 2531.6625s
Epoch: 1 cost time: 23.68783402442932
Epoch: 1, Steps: 158 | Train Loss: 0.9395218 Vali Loss: 1.2895224 Test Loss: 0.4144267
Validation loss decreased (inf --> 1.289522).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8820865
	speed: 0.6298s/iter; left time: 9789.1667s
Epoch: 2 cost time: 27.79920530319214
Epoch: 2, Steps: 158 | Train Loss: 0.8575861 Vali Loss: 1.3547530 Test Loss: 0.4285266
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.7922871
	speed: 0.6816s/iter; left time: 10486.7412s
Epoch: 3 cost time: 22.044440507888794
Epoch: 3, Steps: 158 | Train Loss: 0.8361851 Vali Loss: 1.3665178 Test Loss: 0.4301616
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8244112
	speed: 0.7947s/iter; left time: 12101.1912s
Epoch: 4 cost time: 32.38890862464905
Epoch: 4, Steps: 158 | Train Loss: 0.8249414 Vali Loss: 1.3751699 Test Loss: 0.4259265
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8205963
	speed: 0.6412s/iter; left time: 9661.5193s
Epoch: 5 cost time: 23.40375804901123
Epoch: 5, Steps: 158 | Train Loss: 0.8181152 Vali Loss: 1.3561618 Test Loss: 0.4236478
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7994878
	speed: 0.7043s/iter; left time: 10502.3645s
Epoch: 6 cost time: 32.41994094848633
Epoch: 6, Steps: 158 | Train Loss: 0.8143399 Vali Loss: 1.3849863 Test Loss: 0.4266058
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7967546
	speed: 0.7871s/iter; left time: 11611.4025s
Epoch: 7 cost time: 38.8408567905426
Epoch: 7, Steps: 158 | Train Loss: 0.8122971 Vali Loss: 1.3786831 Test Loss: 0.4293824
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.8490987
	speed: 0.8101s/iter; left time: 11823.6926s
Epoch: 8 cost time: 31.728804111480713
Epoch: 8, Steps: 158 | Train Loss: 0.8112120 Vali Loss: 1.3747051 Test Loss: 0.4329741
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.8148768
	speed: 0.7366s/iter; left time: 10633.6461s
Epoch: 9 cost time: 30.751402616500854
Epoch: 9, Steps: 158 | Train Loss: 0.8106274 Vali Loss: 1.3811071 Test Loss: 0.4305712
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.8194598
	speed: 0.7460s/iter; left time: 10652.3655s
Epoch: 10 cost time: 31.810649871826172
Epoch: 10, Steps: 158 | Train Loss: 0.8105051 Vali Loss: 1.3788534 Test Loss: 0.4314393
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.7760515
	speed: 0.8209s/iter; left time: 11592.2818s
Epoch: 11 cost time: 32.19811987876892
Epoch: 11, Steps: 158 | Train Loss: 0.8103325 Vali Loss: 1.3774484 Test Loss: 0.4316513
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4144178032875061, mae:0.4337639808654785
rmse:0.643752932548523, mape:0.7039909362792969, mspe:37923.0390625

--- [Trial 17] 参数 ---
learning_rate=0.000519998343522985, batch_size=48, attn_dropout=0.1, n_heads=32, num_p=8, alpha=0.14037678892949462, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.3739244
	speed: 0.1424s/iter; left time: 2235.9221s
Epoch: 1 cost time: 26.384928464889526
Epoch: 1, Steps: 158 | Train Loss: 1.3875788 Vali Loss: 1.2614601 Test Loss: 0.4173800
Validation loss decreased (inf --> 1.261460).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2409803
	speed: 0.7210s/iter; left time: 11206.0537s
Epoch: 2 cost time: 27.775874614715576
Epoch: 2, Steps: 158 | Train Loss: 1.2595246 Vali Loss: 1.3388492 Test Loss: 0.4189449
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2379977
	speed: 0.8388s/iter; left time: 12904.3151s
Epoch: 3 cost time: 27.842918634414673
Epoch: 3, Steps: 158 | Train Loss: 1.2259751 Vali Loss: 1.3383373 Test Loss: 0.4322732
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.1841266
	speed: 0.6991s/iter; left time: 10644.5375s
Epoch: 4 cost time: 26.42547106742859
Epoch: 4, Steps: 158 | Train Loss: 1.2065943 Vali Loss: 1.3244402 Test Loss: 0.4386396
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.2341918
	speed: 0.7292s/iter; left time: 10988.1778s
Epoch: 5 cost time: 28.297640085220337
Epoch: 5, Steps: 158 | Train Loss: 1.1944049 Vali Loss: 1.3564787 Test Loss: 0.4347363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.1535255
	speed: 0.7724s/iter; left time: 11517.0547s
Epoch: 6 cost time: 35.967546224594116
Epoch: 6, Steps: 158 | Train Loss: 1.1874433 Vali Loss: 1.3475293 Test Loss: 0.4442128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.1325989
	speed: 0.7988s/iter; left time: 11784.2899s
Epoch: 7 cost time: 29.54864192008972
Epoch: 7, Steps: 158 | Train Loss: 1.1838049 Vali Loss: 1.3633907 Test Loss: 0.4419107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.2051754
	speed: 0.7438s/iter; left time: 10856.1424s
Epoch: 8 cost time: 31.030858516693115
Epoch: 8, Steps: 158 | Train Loss: 1.1820407 Vali Loss: 1.3506671 Test Loss: 0.4453531
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.1706471
	speed: 0.7522s/iter; left time: 10859.8122s
Epoch: 9 cost time: 32.62118339538574
Epoch: 9, Steps: 158 | Train Loss: 1.1809405 Vali Loss: 1.3549010 Test Loss: 0.4490731
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.2130294
	speed: 0.8099s/iter; left time: 11564.3824s
Epoch: 10 cost time: 30.577487468719482
Epoch: 10, Steps: 158 | Train Loss: 1.1802950 Vali Loss: 1.3549227 Test Loss: 0.4472670
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.1485443
	speed: 0.7430s/iter; left time: 10492.0530s
Epoch: 11 cost time: 32.17729687690735
Epoch: 11, Steps: 158 | Train Loss: 1.1804138 Vali Loss: 1.3560641 Test Loss: 0.4473881
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41737985610961914, mae:0.4386679530143738
rmse:0.646049439907074, mape:0.7129817008972168, mspe:37087.2109375

--- [Trial 18] 参数 ---
learning_rate=0.0007711072051694662, batch_size=48, attn_dropout=0.2, n_heads=32, num_p=4, alpha=0.38387582315170665, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.8603792
	speed: 0.1751s/iter; left time: 2748.5567s
Epoch: 1 cost time: 27.944137811660767
Epoch: 1, Steps: 158 | Train Loss: 3.0032378 Vali Loss: 1.2881179 Test Loss: 0.4573522
Validation loss decreased (inf --> 1.288118).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6592054
	speed: 0.8078s/iter; left time: 12555.0486s
Epoch: 2 cost time: 21.921335697174072
Epoch: 2, Steps: 158 | Train Loss: 2.7220498 Vali Loss: 1.3452615 Test Loss: 0.4207468
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.5842524
	speed: 0.6584s/iter; left time: 10130.0215s
Epoch: 3 cost time: 26.149966955184937
Epoch: 3, Steps: 158 | Train Loss: 2.6127853 Vali Loss: 1.4342371 Test Loss: 0.4661052
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.5006938
	speed: 0.6707s/iter; left time: 10212.0438s
Epoch: 4 cost time: 23.300594806671143
Epoch: 4, Steps: 158 | Train Loss: 2.5543831 Vali Loss: 1.4423169 Test Loss: 0.4657451
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.5427194
	speed: 0.7615s/iter; left time: 11475.5549s
Epoch: 5 cost time: 26.658477544784546
Epoch: 5, Steps: 158 | Train Loss: 2.5262680 Vali Loss: 1.4724545 Test Loss: 0.4930894
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.5443475
	speed: 0.7209s/iter; left time: 10749.8586s
Epoch: 6 cost time: 22.4259614944458
Epoch: 6, Steps: 158 | Train Loss: 2.5117068 Vali Loss: 1.4388000 Test Loss: 0.4893469
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.6154885
	speed: 0.6780s/iter; left time: 10001.7998s
Epoch: 7 cost time: 27.20198893547058
Epoch: 7, Steps: 158 | Train Loss: 2.5041027 Vali Loss: 1.4736085 Test Loss: 0.4901167
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.6411433
	speed: 0.7099s/iter; left time: 10360.9607s
Epoch: 8 cost time: 30.378504276275635
Epoch: 8, Steps: 158 | Train Loss: 2.5003595 Vali Loss: 1.4652745 Test Loss: 0.4963922
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.4981728
	speed: 0.8016s/iter; left time: 11572.6407s
Epoch: 9 cost time: 22.071614265441895
Epoch: 9, Steps: 158 | Train Loss: 2.4985434 Vali Loss: 1.4589776 Test Loss: 0.4958416
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 2.5114441
	speed: 0.6813s/iter; left time: 9727.7815s
Epoch: 10 cost time: 22.600834846496582
Epoch: 10, Steps: 158 | Train Loss: 2.4975531 Vali Loss: 1.4528483 Test Loss: 0.4970231
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.4281461
	speed: 0.6907s/iter; left time: 9753.2300s
Epoch: 11 cost time: 23.881799459457397
Epoch: 11, Steps: 158 | Train Loss: 2.4971419 Vali Loss: 1.4561652 Test Loss: 0.4991068
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.45735636353492737, mae:0.4716731011867523
rmse:0.6762812733650208, mape:0.7533833980560303, mspe:46010.4296875

--- [Trial 19] 参数 ---
learning_rate=0.0003175743281263747, batch_size=48, attn_dropout=0.1, n_heads=32, num_p=12, alpha=0.15866615373484194, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.4318836
	speed: 0.1528s/iter; left time: 2398.6672s
Epoch: 1 cost time: 23.645220041275024
Epoch: 1, Steps: 158 | Train Loss: 1.5089091 Vali Loss: 1.2759067 Test Loss: 0.4199793
Validation loss decreased (inf --> 1.275907).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4095117
	speed: 0.7216s/iter; left time: 11215.6764s
Epoch: 2 cost time: 23.995980501174927
Epoch: 2, Steps: 158 | Train Loss: 1.3743889 Vali Loss: 1.2705656 Test Loss: 0.4123464
Validation loss decreased (1.275907 --> 1.270566).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2832928
	speed: 0.7174s/iter; left time: 11037.9192s
Epoch: 3 cost time: 27.348978281021118
Epoch: 3, Steps: 158 | Train Loss: 1.3465886 Vali Loss: 1.3202438 Test Loss: 0.4222140
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3377922
	speed: 0.7527s/iter; left time: 11461.6898s
Epoch: 4 cost time: 34.30015730857849
Epoch: 4, Steps: 158 | Train Loss: 1.3323218 Vali Loss: 1.3199073 Test Loss: 0.4141496
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.3324895
	speed: 0.7091s/iter; left time: 10685.3845s
Epoch: 5 cost time: 25.689979791641235
Epoch: 5, Steps: 158 | Train Loss: 1.3242484 Vali Loss: 1.3305172 Test Loss: 0.4150377
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.2999032
	speed: 0.7345s/iter; left time: 10952.0489s
Epoch: 6 cost time: 24.224472999572754
Epoch: 6, Steps: 158 | Train Loss: 1.3198415 Vali Loss: 1.3372831 Test Loss: 0.4159823
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.2983772
	speed: 0.7374s/iter; left time: 10879.3405s
Epoch: 7 cost time: 32.19771456718445
Epoch: 7, Steps: 158 | Train Loss: 1.3174090 Vali Loss: 1.3390912 Test Loss: 0.4194605
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.3671911
	speed: 0.9041s/iter; left time: 13195.5092s
Epoch: 8 cost time: 28.22271752357483
Epoch: 8, Steps: 158 | Train Loss: 1.3161599 Vali Loss: 1.3347003 Test Loss: 0.4198815
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.3226327
	speed: 0.7497s/iter; left time: 10824.0158s
Epoch: 9 cost time: 26.597719192504883
Epoch: 9, Steps: 158 | Train Loss: 1.3154408 Vali Loss: 1.3387799 Test Loss: 0.4182278
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.3284570
	speed: 0.7640s/iter; left time: 10908.9790s
Epoch: 10 cost time: 24.695751190185547
Epoch: 10, Steps: 158 | Train Loss: 1.3151268 Vali Loss: 1.3382137 Test Loss: 0.4190093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.2656021
	speed: 0.8762s/iter; left time: 12372.9024s
Epoch: 11 cost time: 26.839633464813232
Epoch: 11, Steps: 158 | Train Loss: 1.3150179 Vali Loss: 1.3370805 Test Loss: 0.4191533
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 1.3049488
	speed: 0.7655s/iter; left time: 10688.7877s
Epoch: 12 cost time: 27.423943281173706
Epoch: 12, Steps: 158 | Train Loss: 1.3148581 Vali Loss: 1.3380222 Test Loss: 0.4189258
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4123413860797882, mae:0.43145549297332764
rmse:0.6421381235122681, mape:0.7033135890960693, mspe:37195.65234375

--- [Trial 20] 参数 ---
learning_rate=0.00027036525799274653, batch_size=64, attn_dropout=0.1, n_heads=32, num_p=12, alpha=0.06812710615680591, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 0.8821192
	speed: 0.1830s/iter; left time: 2140.7875s
Epoch: 1 cost time: 22.862032175064087
Epoch: 1, Steps: 118 | Train Loss: 0.9580330 Vali Loss: 1.2811428 Test Loss: 0.4257413
Validation loss decreased (inf --> 1.281143).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8723472
	speed: 0.8356s/iter; left time: 9678.7388s
Epoch: 2 cost time: 21.919843196868896
Epoch: 2, Steps: 118 | Train Loss: 0.8580335 Vali Loss: 1.2825447 Test Loss: 0.4186249
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.8206523
	speed: 0.7406s/iter; left time: 8491.1269s
Epoch: 3 cost time: 21.64029836654663
Epoch: 3, Steps: 118 | Train Loss: 0.8394911 Vali Loss: 1.3045660 Test Loss: 0.4222850
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.8368295
	speed: 0.7266s/iter; left time: 8244.6253s
Epoch: 4 cost time: 22.280689477920532
Epoch: 4, Steps: 118 | Train Loss: 0.8308407 Vali Loss: 1.3253983 Test Loss: 0.4184489
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.8412246
	speed: 0.8348s/iter; left time: 9373.6229s
Epoch: 5 cost time: 28.207219123840332
Epoch: 5, Steps: 118 | Train Loss: 0.8263060 Vali Loss: 1.3269014 Test Loss: 0.4153894
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.8212630
	speed: 0.6768s/iter; left time: 7519.6284s
Epoch: 6 cost time: 25.522236347198486
Epoch: 6, Steps: 118 | Train Loss: 0.8233520 Vali Loss: 1.3476989 Test Loss: 0.4191352
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7697376
	speed: 0.7060s/iter; left time: 7760.8684s
Epoch: 7 cost time: 22.118715286254883
Epoch: 7, Steps: 118 | Train Loss: 0.8221780 Vali Loss: 1.3431925 Test Loss: 0.4228123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.8069942
	speed: 0.6974s/iter; left time: 7583.7146s
Epoch: 8 cost time: 24.138380527496338
Epoch: 8, Steps: 118 | Train Loss: 0.8216566 Vali Loss: 1.3436697 Test Loss: 0.4208528
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.7856503
	speed: 0.7993s/iter; left time: 8598.4549s
Epoch: 9 cost time: 33.814794301986694
Epoch: 9, Steps: 118 | Train Loss: 0.8212485 Vali Loss: 1.3469028 Test Loss: 0.4192652
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.7953153
	speed: 0.6677s/iter; left time: 7104.1730s
Epoch: 10 cost time: 21.979465007781982
Epoch: 10, Steps: 118 | Train Loss: 0.8212323 Vali Loss: 1.3442835 Test Loss: 0.4201613
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.8060162
	speed: 0.7179s/iter; left time: 7552.5073s
Epoch: 11 cost time: 20.98174548149109
Epoch: 11, Steps: 118 | Train Loss: 0.8208404 Vali Loss: 1.3433878 Test Loss: 0.4201991
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4257407486438751, mae:0.44005662202835083
rmse:0.652488112449646, mape:0.7098945379257202, mspe:38292.8671875

--- [Trial 21] 参数 ---
learning_rate=0.0002224972685542473, batch_size=48, attn_dropout=0.1, n_heads=32, num_p=12, alpha=0.16803824767933764, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.4965980
	speed: 0.1511s/iter; left time: 2372.7391s
Epoch: 1 cost time: 23.327561140060425
Epoch: 1, Steps: 158 | Train Loss: 1.6040511 Vali Loss: 1.2695707 Test Loss: 0.4229798
Validation loss decreased (inf --> 1.269571).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4724293
	speed: 0.7131s/iter; left time: 11084.1960s
Epoch: 2 cost time: 23.691468238830566
Epoch: 2, Steps: 158 | Train Loss: 1.4379226 Vali Loss: 1.2717612 Test Loss: 0.4148614
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3486512
	speed: 0.7100s/iter; left time: 10922.8028s
Epoch: 3 cost time: 35.50632905960083
Epoch: 3, Steps: 158 | Train Loss: 1.4119261 Vali Loss: 1.2800953 Test Loss: 0.4141554
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.4087421
	speed: 0.7576s/iter; left time: 11535.3591s
Epoch: 4 cost time: 29.7375271320343
Epoch: 4, Steps: 158 | Train Loss: 1.4006938 Vali Loss: 1.2905227 Test Loss: 0.4117615
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.4057453
	speed: 0.7774s/iter; left time: 11714.8759s
Epoch: 5 cost time: 24.018741130828857
Epoch: 5, Steps: 158 | Train Loss: 1.3947187 Vali Loss: 1.2951020 Test Loss: 0.4112169
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.3681976
	speed: 0.7479s/iter; left time: 11151.2042s
Epoch: 6 cost time: 27.48311758041382
Epoch: 6, Steps: 158 | Train Loss: 1.3915743 Vali Loss: 1.3050427 Test Loss: 0.4129657
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.3671967
	speed: 0.6697s/iter; left time: 9879.6530s
Epoch: 7 cost time: 34.06510925292969
Epoch: 7, Steps: 158 | Train Loss: 1.3898805 Vali Loss: 1.3034731 Test Loss: 0.4151487
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.4399111
	speed: 0.8413s/iter; left time: 12278.1271s
Epoch: 8 cost time: 22.9995014667511
Epoch: 8, Steps: 158 | Train Loss: 1.3890285 Vali Loss: 1.3009856 Test Loss: 0.4140349
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.3945237
	speed: 0.7146s/iter; left time: 10316.0407s
Epoch: 9 cost time: 23.965770959854126
Epoch: 9, Steps: 158 | Train Loss: 1.3884969 Vali Loss: 1.3017383 Test Loss: 0.4127839
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.3975618
	speed: 0.7351s/iter; left time: 10496.8664s
Epoch: 10 cost time: 34.120867013931274
Epoch: 10, Steps: 158 | Train Loss: 1.3882482 Vali Loss: 1.3025335 Test Loss: 0.4131822
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.3359329
	speed: 0.7505s/iter; left time: 10597.3847s
Epoch: 11 cost time: 24.629520416259766
Epoch: 11, Steps: 158 | Train Loss: 1.3881757 Vali Loss: 1.3015351 Test Loss: 0.4132823
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4229699671268463, mae:0.4401809573173523
rmse:0.6503614187240601, mape:0.7105032205581665, mspe:36746.83203125

--- [Trial 22] 参数 ---
learning_rate=0.0006822925466859048, batch_size=48, attn_dropout=0.05, n_heads=32, num_p=12, alpha=0.12457896249393534, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.2166044
	speed: 0.1831s/iter; left time: 2874.1225s
Epoch: 1 cost time: 28.783881902694702
Epoch: 1, Steps: 158 | Train Loss: 1.2541668 Vali Loss: 1.2843275 Test Loss: 0.4127790
Validation loss decreased (inf --> 1.284328).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1916118
	speed: 0.7148s/iter; left time: 11109.5462s
Epoch: 2 cost time: 29.427812576293945
Epoch: 2, Steps: 158 | Train Loss: 1.1599077 Vali Loss: 1.3377265 Test Loss: 0.4250430
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0734890
	speed: 0.7526s/iter; left time: 11578.2416s
Epoch: 3 cost time: 25.111677169799805
Epoch: 3, Steps: 158 | Train Loss: 1.1217007 Vali Loss: 1.3878700 Test Loss: 0.4377856
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.0978904
	speed: 0.7000s/iter; left time: 10658.3465s
Epoch: 4 cost time: 22.32742166519165
Epoch: 4, Steps: 158 | Train Loss: 1.0944874 Vali Loss: 1.4288353 Test Loss: 0.4743140
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.0843453
	speed: 0.7005s/iter; left time: 10555.3600s
Epoch: 5 cost time: 28.25014090538025
Epoch: 5, Steps: 158 | Train Loss: 1.0788202 Vali Loss: 1.4028704 Test Loss: 0.5065516
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.0624443
	speed: 0.6904s/iter; left time: 10294.7855s
Epoch: 6 cost time: 28.765429258346558
Epoch: 6, Steps: 158 | Train Loss: 1.0704303 Vali Loss: 1.4056107 Test Loss: 0.5187132
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.0587662
	speed: 0.6935s/iter; left time: 10231.0524s
Epoch: 7 cost time: 25.58626627922058
Epoch: 7, Steps: 158 | Train Loss: 1.0659888 Vali Loss: 1.4240425 Test Loss: 0.5095907
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.0937296
	speed: 0.7268s/iter; left time: 10607.9040s
Epoch: 8 cost time: 22.528130531311035
Epoch: 8, Steps: 158 | Train Loss: 1.0638696 Vali Loss: 1.4213529 Test Loss: 0.5170467
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.0692881
	speed: 0.7490s/iter; left time: 10812.9289s
Epoch: 9 cost time: 29.38534712791443
Epoch: 9, Steps: 158 | Train Loss: 1.0625814 Vali Loss: 1.4351918 Test Loss: 0.5164720
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.0745444
	speed: 0.7303s/iter; left time: 10427.8718s
Epoch: 10 cost time: 28.5627179145813
Epoch: 10, Steps: 158 | Train Loss: 1.0621400 Vali Loss: 1.4333017 Test Loss: 0.5167811
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.0266745
	speed: 0.7133s/iter; left time: 10073.1142s
Epoch: 11 cost time: 28.084646940231323
Epoch: 11, Steps: 158 | Train Loss: 1.0618555 Vali Loss: 1.4307573 Test Loss: 0.5151212
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4127759039402008, mae:0.4320094883441925
rmse:0.6424763798713684, mape:0.7045125365257263, mspe:38186.15625

--- [Trial 23] 参数 ---
learning_rate=0.0005095906118211014, batch_size=48, attn_dropout=0.05, n_heads=32, num_p=12, alpha=0.1201883184221714, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.1974957
	speed: 0.2247s/iter; left time: 3528.2606s
Epoch: 1 cost time: 35.34436273574829
Epoch: 1, Steps: 158 | Train Loss: 1.2375326 Vali Loss: 1.2717979 Test Loss: 0.4120600
Validation loss decreased (inf --> 1.271798).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1712714
	speed: 0.7913s/iter; left time: 12298.6567s
Epoch: 2 cost time: 29.681451082229614
Epoch: 2, Steps: 158 | Train Loss: 1.1406583 Vali Loss: 1.3358750 Test Loss: 0.4288430
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0555511
	speed: 0.6839s/iter; left time: 10521.8733s
Epoch: 3 cost time: 23.04275369644165
Epoch: 3, Steps: 158 | Train Loss: 1.1088525 Vali Loss: 1.3765739 Test Loss: 0.4291209
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.0910509
	speed: 0.7221s/iter; left time: 10995.3283s
Epoch: 4 cost time: 22.726794958114624
Epoch: 4, Steps: 158 | Train Loss: 1.0883430 Vali Loss: 1.3837701 Test Loss: 0.4460441
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.0833430
	speed: 0.7233s/iter; left time: 10899.5700s
Epoch: 5 cost time: 34.66632437705994
Epoch: 5, Steps: 158 | Train Loss: 1.0760125 Vali Loss: 1.3679926 Test Loss: 0.4471174
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.0600278
	speed: 0.8171s/iter; left time: 12183.4404s
Epoch: 6 cost time: 25.05940580368042
Epoch: 6, Steps: 158 | Train Loss: 1.0696417 Vali Loss: 1.3667871 Test Loss: 0.4685932
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.0546304
	speed: 0.5555s/iter; left time: 8195.1023s
Epoch: 7 cost time: 20.481281518936157
Epoch: 7, Steps: 158 | Train Loss: 1.0662485 Vali Loss: 1.3760909 Test Loss: 0.4587411
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.1028129
	speed: 0.6744s/iter; left time: 9843.4952s
Epoch: 8 cost time: 30.283250093460083
Epoch: 8, Steps: 158 | Train Loss: 1.0645815 Vali Loss: 1.3733026 Test Loss: 0.4646525
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.0713255
	speed: 0.7037s/iter; left time: 10158.8549s
Epoch: 9 cost time: 24.27174663543701
Epoch: 9, Steps: 158 | Train Loss: 1.0635553 Vali Loss: 1.3866591 Test Loss: 0.4636719
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.0749856
	speed: 0.6576s/iter; left time: 9390.2866s
Epoch: 10 cost time: 31.27597975730896
Epoch: 10, Steps: 158 | Train Loss: 1.0631470 Vali Loss: 1.3852326 Test Loss: 0.4638380
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.0252792
	speed: 0.6297s/iter; left time: 8892.1468s
Epoch: 11 cost time: 20.6318039894104
Epoch: 11, Steps: 158 | Train Loss: 1.0629239 Vali Loss: 1.3805509 Test Loss: 0.4640274
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41205549240112305, mae:0.43320921063423157
rmse:0.641915500164032, mape:0.7059195637702942, mspe:36754.3984375

--- [Trial 24] 参数 ---
learning_rate=0.0007170234712081976, batch_size=48, attn_dropout=0.0, n_heads=32, num_p=12, alpha=0.12929728525113057, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.2450035
	speed: 0.1685s/iter; left time: 2646.1608s
Epoch: 1 cost time: 24.61637020111084
Epoch: 1, Steps: 158 | Train Loss: 1.2819240 Vali Loss: 1.2870280 Test Loss: 0.4139838
Validation loss decreased (inf --> 1.287028).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2159734
	speed: 0.5668s/iter; left time: 8809.3344s
Epoch: 2 cost time: 19.794631719589233
Epoch: 2, Steps: 158 | Train Loss: 1.1856236 Vali Loss: 1.3435260 Test Loss: 0.4204621
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0925397
	speed: 0.6688s/iter; left time: 10288.9615s
Epoch: 3 cost time: 29.921124935150146
Epoch: 3, Steps: 158 | Train Loss: 1.1441067 Vali Loss: 1.3807780 Test Loss: 0.4433435
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.1189088
	speed: 0.6640s/iter; left time: 10111.0292s
Epoch: 4 cost time: 27.642411708831787
Epoch: 4, Steps: 158 | Train Loss: 1.1149060 Vali Loss: 1.4486942 Test Loss: 0.4765213
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.1060194
	speed: 0.7317s/iter; left time: 11026.4965s
Epoch: 5 cost time: 29.161131858825684
Epoch: 5, Steps: 158 | Train Loss: 1.0979508 Vali Loss: 1.4389914 Test Loss: 0.4905334
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.0783989
	speed: 0.6435s/iter; left time: 9595.0052s
Epoch: 6 cost time: 19.67438840866089
Epoch: 6, Steps: 158 | Train Loss: 1.0889130 Vali Loss: 1.4266151 Test Loss: 0.5126939
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.0769730
	speed: 0.6479s/iter; left time: 9558.1966s
Epoch: 7 cost time: 29.647696495056152
Epoch: 7, Steps: 158 | Train Loss: 1.0842603 Vali Loss: 1.4509300 Test Loss: 0.5054013
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.1073186
	speed: 0.7866s/iter; left time: 11479.7632s
Epoch: 8 cost time: 25.07296919822693
Epoch: 8, Steps: 158 | Train Loss: 1.0819444 Vali Loss: 1.4488801 Test Loss: 0.5106439
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.0901668
	speed: 0.5807s/iter; left time: 8383.5804s
Epoch: 9 cost time: 26.682737350463867
Epoch: 9, Steps: 158 | Train Loss: 1.0807189 Vali Loss: 1.4623591 Test Loss: 0.5121105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.0948081
	speed: 0.6943s/iter; left time: 9914.1172s
Epoch: 10 cost time: 24.951744556427002
Epoch: 10, Steps: 158 | Train Loss: 1.0800929 Vali Loss: 1.4610776 Test Loss: 0.5138692
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.0467608
	speed: 0.5672s/iter; left time: 8009.2296s
Epoch: 11 cost time: 24.507050275802612
Epoch: 11, Steps: 158 | Train Loss: 1.0798106 Vali Loss: 1.4582762 Test Loss: 0.5116417
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41398438811302185, mae:0.4327768087387085
rmse:0.643416166305542, mape:0.705086350440979, mspe:37929.30859375

--- [Trial 25] 参数 ---
learning_rate=0.00045848562392364367, batch_size=48, attn_dropout=0.05, n_heads=32, num_p=12, alpha=0.09936721552117604, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.0740267
	speed: 0.1317s/iter; left time: 2067.4435s
Epoch: 1 cost time: 20.53769850730896
Epoch: 1, Steps: 158 | Train Loss: 1.1113410 Vali Loss: 1.2759051 Test Loss: 0.4116400
Validation loss decreased (inf --> 1.275905).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0507528
	speed: 0.6278s/iter; left time: 9757.5105s
Epoch: 2 cost time: 29.24834418296814
Epoch: 2, Steps: 158 | Train Loss: 1.0223620 Vali Loss: 1.3483950 Test Loss: 0.4291109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9442805
	speed: 0.7702s/iter; left time: 11849.6754s
Epoch: 3 cost time: 33.06025433540344
Epoch: 3, Steps: 158 | Train Loss: 0.9942270 Vali Loss: 1.3705199 Test Loss: 0.4282936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9778082
	speed: 0.6125s/iter; left time: 9326.7689s
Epoch: 4 cost time: 21.851773977279663
Epoch: 4, Steps: 158 | Train Loss: 0.9766776 Vali Loss: 1.3919448 Test Loss: 0.4394455
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.9716308
	speed: 0.6997s/iter; left time: 10543.2110s
Epoch: 5 cost time: 29.694419622421265
Epoch: 5, Steps: 158 | Train Loss: 0.9658145 Vali Loss: 1.3641849 Test Loss: 0.4384524
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.9496788
	speed: 0.6213s/iter; left time: 9263.6795s
Epoch: 6 cost time: 21.040738105773926
Epoch: 6, Steps: 158 | Train Loss: 0.9600771 Vali Loss: 1.3684845 Test Loss: 0.4609015
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.9450747
	speed: 0.6341s/iter; left time: 9354.5460s
Epoch: 7 cost time: 27.08156156539917
Epoch: 7, Steps: 158 | Train Loss: 0.9570698 Vali Loss: 1.3761973 Test Loss: 0.4523293
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.9929013
	speed: 0.6579s/iter; left time: 9601.9289s
Epoch: 8 cost time: 20.507616996765137
Epoch: 8, Steps: 158 | Train Loss: 0.9556070 Vali Loss: 1.3732008 Test Loss: 0.4575325
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.9610347
	speed: 0.6727s/iter; left time: 9711.4627s
Epoch: 9 cost time: 20.35019016265869
Epoch: 9, Steps: 158 | Train Loss: 0.9546918 Vali Loss: 1.3839526 Test Loss: 0.4559745
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.9648081
	speed: 0.6601s/iter; left time: 9424.8722s
Epoch: 10 cost time: 24.60491704940796
Epoch: 10, Steps: 158 | Train Loss: 0.9543543 Vali Loss: 1.3817983 Test Loss: 0.4564086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.9192984
	speed: 0.7771s/iter; left time: 10973.7432s
Epoch: 11 cost time: 20.15677833557129
Epoch: 11, Steps: 158 | Train Loss: 0.9541865 Vali Loss: 1.3785053 Test Loss: 0.4567005
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.41163504123687744, mae:0.4325135350227356
rmse:0.6415879130363464, mape:0.7045672535896301, mspe:37140.83203125

--- [Trial 26] 参数 ---
learning_rate=0.00035477968344128246, batch_size=48, attn_dropout=0.05, n_heads=8, num_p=8, alpha=0.1457774124719457, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.4190700
	speed: 0.0775s/iter; left time: 1216.1760s
Epoch: 1 cost time: 12.189234018325806
Epoch: 1, Steps: 158 | Train Loss: 1.4524340 Vali Loss: 1.2606074 Test Loss: 0.4181365
Validation loss decreased (inf --> 1.260607).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2854412
	speed: 0.5757s/iter; left time: 8948.1889s
Epoch: 2 cost time: 17.044039964675903
Epoch: 2, Steps: 158 | Train Loss: 1.3011927 Vali Loss: 1.3071283 Test Loss: 0.4128769
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2864305
	speed: 0.6502s/iter; left time: 10003.0683s
Epoch: 3 cost time: 16.538641691207886
Epoch: 3, Steps: 158 | Train Loss: 1.2712185 Vali Loss: 1.3073772 Test Loss: 0.4317519
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.2341578
	speed: 0.5663s/iter; left time: 8622.6710s
Epoch: 4 cost time: 19.491953372955322
Epoch: 4, Steps: 158 | Train Loss: 1.2561533 Vali Loss: 1.2961967 Test Loss: 0.4268374
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.2823787
	speed: 0.5632s/iter; left time: 8486.6946s
Epoch: 5 cost time: 20.179234743118286
Epoch: 5, Steps: 158 | Train Loss: 1.2463787 Vali Loss: 1.3156252 Test Loss: 0.4214448
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.2109911
	speed: 0.5931s/iter; left time: 8843.8218s
Epoch: 6 cost time: 23.718541145324707
Epoch: 6, Steps: 158 | Train Loss: 1.2410354 Vali Loss: 1.3044496 Test Loss: 0.4227967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.1840819
	speed: 0.6207s/iter; left time: 9157.4758s
Epoch: 7 cost time: 15.575349569320679
Epoch: 7, Steps: 158 | Train Loss: 1.2379177 Vali Loss: 1.3223604 Test Loss: 0.4256054
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.2637833
	speed: 0.5801s/iter; left time: 8467.1474s
Epoch: 8 cost time: 11.70946741104126
Epoch: 8, Steps: 158 | Train Loss: 1.2365603 Vali Loss: 1.3101513 Test Loss: 0.4274080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.2234727
	speed: 0.5202s/iter; left time: 7510.4586s
Epoch: 9 cost time: 20.23408579826355
Epoch: 9, Steps: 158 | Train Loss: 1.2359636 Vali Loss: 1.3132825 Test Loss: 0.4310142
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.2640861
	speed: 0.5819s/iter; left time: 8309.4898s
Epoch: 10 cost time: 16.190941095352173
Epoch: 10, Steps: 158 | Train Loss: 1.2354843 Vali Loss: 1.3124998 Test Loss: 0.4292891
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.2042357
	speed: 0.7260s/iter; left time: 10252.1154s
Epoch: 11 cost time: 14.271032571792603
Epoch: 11, Steps: 158 | Train Loss: 1.2352758 Vali Loss: 1.3125472 Test Loss: 0.4297494
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4181026816368103, mae:0.43834811449050903
rmse:0.6466085910797119, mape:0.710635781288147, mspe:36413.84765625

--- [Trial 27] 参数 ---
learning_rate=0.0004691417118889418, batch_size=48, attn_dropout=0.0, n_heads=16, num_p=4, alpha=0.09836339824676099, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.1074231
	speed: 0.0881s/iter; left time: 1383.0974s
Epoch: 1 cost time: 14.118058919906616
Epoch: 1, Steps: 158 | Train Loss: 1.1824943 Vali Loss: 1.2753484 Test Loss: 0.4283004
Validation loss decreased (inf --> 1.275348).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0134437
	speed: 0.5764s/iter; left time: 8958.3397s
Epoch: 2 cost time: 22.55523157119751
Epoch: 2, Steps: 158 | Train Loss: 1.0340797 Vali Loss: 1.4022746 Test Loss: 0.4366779
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9719472
	speed: 0.6406s/iter; left time: 9855.4927s
Epoch: 3 cost time: 19.26519513130188
Epoch: 3, Steps: 158 | Train Loss: 0.9940881 Vali Loss: 1.4369463 Test Loss: 0.4590019
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9651868
	speed: 0.6631s/iter; left time: 10096.7055s
Epoch: 4 cost time: 13.900808811187744
Epoch: 4, Steps: 158 | Train Loss: 0.9714761 Vali Loss: 1.4308194 Test Loss: 0.4527960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.9637821
	speed: 0.5963s/iter; left time: 8985.4725s
Epoch: 5 cost time: 21.796937942504883
Epoch: 5, Steps: 158 | Train Loss: 0.9601506 Vali Loss: 1.4667025 Test Loss: 0.4629832
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.9551744
	speed: 0.5481s/iter; left time: 8173.4301s
Epoch: 6 cost time: 13.831255674362183
Epoch: 6, Steps: 158 | Train Loss: 0.9550540 Vali Loss: 1.4820635 Test Loss: 0.4571160
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.0094259
	speed: 0.7219s/iter; left time: 10650.6634s
Epoch: 7 cost time: 19.29702353477478
Epoch: 7, Steps: 158 | Train Loss: 0.9524978 Vali Loss: 1.4781336 Test Loss: 0.4581650
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.0076587
	speed: 0.5900s/iter; left time: 8610.5317s
Epoch: 8 cost time: 22.648953437805176
Epoch: 8, Steps: 158 | Train Loss: 0.9511352 Vali Loss: 1.4717267 Test Loss: 0.4630150
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.9443672
	speed: 0.5951s/iter; left time: 8591.0557s
Epoch: 9 cost time: 14.068028688430786
Epoch: 9, Steps: 158 | Train Loss: 0.9504679 Vali Loss: 1.4610512 Test Loss: 0.4661881
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.9522488
	speed: 0.6203s/iter; left time: 8857.6885s
Epoch: 10 cost time: 13.900067329406738
Epoch: 10, Steps: 158 | Train Loss: 0.9501265 Vali Loss: 1.4590931 Test Loss: 0.4649187
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.9198909
	speed: 0.6543s/iter; left time: 9238.9252s
Epoch: 11 cost time: 28.192253589630127
Epoch: 11, Steps: 158 | Train Loss: 0.9499694 Vali Loss: 1.4611617 Test Loss: 0.4658138
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.4282822906970978, mae:0.44477227330207825
rmse:0.6544327735900879, mape:0.7147937417030334, mspe:41389.19140625

--- [Trial 28] 参数 ---
learning_rate=0.00025615009445265925, batch_size=32, attn_dropout=0.1, n_heads=64, num_p=6, alpha=0.16031816635892868, d_ff_multiplier=4
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 1.5650580
	speed: 0.1982s/iter; left time: 4677.9115s
	iters: 200, epoch: 1 | loss: 1.5486814
	speed: 0.1305s/iter; left time: 3066.6117s
Epoch: 1 cost time: 37.881925106048584
Epoch: 1, Steps: 237 | Train Loss: 1.5932691 Vali Loss: 1.2786263 Test Loss: 0.4453339
Validation loss decreased (inf --> 1.278626).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4525561
	speed: 0.5717s/iter; left time: 13356.0973s
	iters: 200, epoch: 2 | loss: 1.3778062
	speed: 0.1334s/iter; left time: 3103.4842s
Epoch: 2 cost time: 33.61003494262695
Epoch: 2, Steps: 237 | Train Loss: 1.4370548 Vali Loss: 1.2787986 Test Loss: 0.4214992
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3196552
	speed: 0.7001s/iter; left time: 16191.7592s
	iters: 200, epoch: 3 | loss: 1.4045109
	speed: 0.1299s/iter; left time: 2992.2151s
Epoch: 3 cost time: 31.27496910095215
Epoch: 3, Steps: 237 | Train Loss: 1.3685518 Vali Loss: 1.3857809 Test Loss: 0.4259558
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.3104053
	speed: 0.6005s/iter; left time: 13744.8460s
	iters: 200, epoch: 4 | loss: 1.2873745
	speed: 0.1294s/iter; left time: 2948.3924s
Epoch: 4 cost time: 31.438916206359863
Epoch: 4, Steps: 237 | Train Loss: 1.3466212 Vali Loss: 1.4003445 Test Loss: 0.4364095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.3611166
	speed: 0.6010s/iter; left time: 13613.4847s
	iters: 200, epoch: 5 | loss: 1.3705149
	speed: 0.1266s/iter; left time: 2855.3047s
Epoch: 5 cost time: 30.86074995994568
Epoch: 5, Steps: 237 | Train Loss: 1.3347315 Vali Loss: 1.4213353 Test Loss: 0.4511706
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.3342094
	speed: 0.6809s/iter; left time: 15263.0362s
	iters: 200, epoch: 6 | loss: 1.2834752
	speed: 0.1259s/iter; left time: 2810.1841s
Epoch: 6 cost time: 32.997095346450806
Epoch: 6, Steps: 237 | Train Loss: 1.3287499 Vali Loss: 1.4492739 Test Loss: 0.4394940
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.3477538
	speed: 0.6057s/iter; left time: 13434.1864s
	iters: 200, epoch: 7 | loss: 1.3413595
	speed: 0.1299s/iter; left time: 2868.6056s
Epoch: 7 cost time: 31.78702473640442
Epoch: 7, Steps: 237 | Train Loss: 1.3257655 Vali Loss: 1.4391210 Test Loss: 0.4564025
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.2970423
	speed: 0.6018s/iter; left time: 13203.6958s
	iters: 200, epoch: 8 | loss: 1.3284303
	speed: 0.1304s/iter; left time: 2847.5107s
Epoch: 8 cost time: 32.262404680252075
Epoch: 8, Steps: 237 | Train Loss: 1.3242079 Vali Loss: 1.4459368 Test Loss: 0.4511976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.2888200
	speed: 0.7094s/iter; left time: 15398.5474s
	iters: 200, epoch: 9 | loss: 1.3082536
	speed: 0.1330s/iter; left time: 2872.4869s
Epoch: 9 cost time: 36.862586975097656
Epoch: 9, Steps: 237 | Train Loss: 1.3233227 Vali Loss: 1.4440161 Test Loss: 0.4501823
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.2845534
	speed: 0.5948s/iter; left time: 12770.0453s
	iters: 200, epoch: 10 | loss: 1.2946991
	speed: 0.1245s/iter; left time: 2661.2641s
Epoch: 10 cost time: 32.839773178100586
Epoch: 10, Steps: 237 | Train Loss: 1.3228854 Vali Loss: 1.4446592 Test Loss: 0.4521263
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.3441975
	speed: 0.6197s/iter; left time: 13157.0938s
	iters: 200, epoch: 11 | loss: 1.3238016
	speed: 0.1290s/iter; left time: 2725.3048s
Epoch: 11 cost time: 36.095714807510376
Epoch: 11, Steps: 237 | Train Loss: 1.3228116 Vali Loss: 1.4455888 Test Loss: 0.4525996
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.44536247849464417, mae:0.4638269245624542
rmse:0.6673548221588135, mape:0.7465977072715759, mspe:40310.78125

--- [Trial 29] 参数 ---
learning_rate=0.00034284027091408166, batch_size=64, attn_dropout=0.05, n_heads=16, num_p=8, alpha=0.2673532182189694, d_ff_multiplier=2
Use GPU: cuda:0
train 7585
val 2545
test 2545
	iters: 100, epoch: 1 | loss: 2.0811467
	speed: 0.1237s/iter; left time: 1447.4461s
Epoch: 1 cost time: 14.74349594116211
Epoch: 1, Steps: 118 | Train Loss: 2.3037426 Vali Loss: 1.2657984 Test Loss: 0.4359800
Validation loss decreased (inf --> 1.265798).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0006013
	speed: 0.5425s/iter; left time: 6284.3328s
Epoch: 2 cost time: 14.262827157974243
Epoch: 2, Steps: 118 | Train Loss: 2.0282124 Vali Loss: 1.2680215 Test Loss: 0.4204706
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9603779
	speed: 0.5527s/iter; left time: 6336.8090s
Epoch: 3 cost time: 21.08845543861389
Epoch: 3, Steps: 118 | Train Loss: 1.9834110 Vali Loss: 1.2836514 Test Loss: 0.4173940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.9975913
	speed: 0.5568s/iter; left time: 6318.3754s
Epoch: 4 cost time: 19.16454553604126
Epoch: 4, Steps: 118 | Train Loss: 1.9656980 Vali Loss: 1.2888359 Test Loss: 0.4131295
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.0457530
	speed: 0.5419s/iter; left time: 6085.3956s
Epoch: 5 cost time: 13.975595712661743
Epoch: 5, Steps: 118 | Train Loss: 1.9571135 Vali Loss: 1.2879204 Test Loss: 0.4144465
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.9141986
	speed: 0.5535s/iter; left time: 6149.6080s
Epoch: 6 cost time: 14.634927988052368
Epoch: 6, Steps: 118 | Train Loss: 1.9527108 Vali Loss: 1.2936147 Test Loss: 0.4154693
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.9436495
	speed: 0.5382s/iter; left time: 5916.1322s
Epoch: 7 cost time: 14.09366774559021
Epoch: 7, Steps: 118 | Train Loss: 1.9503340 Vali Loss: 1.3046845 Test Loss: 0.4133457
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 1.9622040
	speed: 0.6305s/iter; left time: 6856.9765s
Epoch: 8 cost time: 23.26879906654358
Epoch: 8, Steps: 118 | Train Loss: 1.9489242 Vali Loss: 1.3042380 Test Loss: 0.4139675
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 1.9400134
	speed: 0.6044s/iter; left time: 6501.7253s
Epoch: 9 cost time: 21.747382640838623
Epoch: 9, Steps: 118 | Train Loss: 1.9483948 Vali Loss: 1.3009263 Test Loss: 0.4142183
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 1.9794343
	speed: 0.5596s/iter; left time: 5953.4720s
Epoch: 10 cost time: 18.3659610748291
Epoch: 10, Steps: 118 | Train Loss: 1.9479943 Vali Loss: 1.3011848 Test Loss: 0.4141748
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 1.9572624
	speed: 0.5475s/iter; left time: 5760.2796s
Epoch: 11 cost time: 13.823913335800171
Epoch: 11, Steps: 118 | Train Loss: 1.9479024 Vali Loss: 1.2999449 Test Loss: 0.4142295
EarlyStopping counter: 10 out of 10
Early stopping
test 2545
test shape: (2545, 1, 336, 7) (2545, 1, 336, 7)
test shape: (2545, 336, 7) (2545, 336, 7)
mse:0.43598613142967224, mae:0.4531421959400177
rmse:0.6602924466133118, mape:0.7283524870872498, mspe:38156.390625


--- 优化完成 ---
完成的试验次数:  30
最佳试验:
  > 最佳测试损失 (MAE+MSE): 0.8437968
  > 对应的测试 MAE: 0.4314555
  > 对应的测试 MSE: 0.4123414
  > 最佳超参数 (Params): 
    - learning_rate: 0.0003175743281263747
    - batch_size: 48
    - attn_dropout: 0.1
    - n_heads: 32
    - num_p: 12
    - alpha: 0.15866615373484194
    - d_ff_multiplier: 2

准备将最佳结果写入到: optuna/ETTh1_seqlen_720_predlen_336_results.txt
最佳结果已成功写入！

最佳结果已成功写入到: optuna/ETTh1_seqlen_720_predlen_336_results.txt
总耗时：24901.78s
